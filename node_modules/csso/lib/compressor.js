function TRBL(a,b){this.name=TRBL.extractMain(a);this.sides={top:null,right:null,bottom:null,left:null};this.imp=b?4:0}TRBL.props={margin:1,"margin-top":1,"margin-right":1,"margin-bottom":1,"margin-left":1,padding:1,"padding-top":1,"padding-right":1,"padding-bottom":1,"padding-left":1};TRBL.extractMain=function(a){var b=a.indexOf("-");return b===-1?a:a.substr(0,b)};TRBL.prototype.impSum=function(){var b=0,c=0;for(var a in this.sides){if(this.sides[a]){c++;if(this.sides[a].imp){b++}}}return b===c?b:0};TRBL.prototype.add=function(c,m,d,b){var n=this.sides,f,e,k,g,j=[],l,b=b?1:0,h=false;if((e=c.lastIndexOf("-"))!==-1){g=c.substr(e+1);if(g in n){if(!(f=n[g])||(b&&!f.imp)){n[g]={s:b?m.substring(0,m.length-10):m,t:[d[0]],imp:b};if(d[0][1]==="unary"){n[g].t.push(d[1])}}return true}}else{if(c===this.name){for(e=0;e<d.length;e++){k=d[e];l=j[j.length-1];switch(k[1]){case"unary":j.push({s:k[2],t:[k],imp:b});h=true;break;case"number":case"ident":if(h){l.t.push(k);l.s+=k[2]}else{j.push({s:k[2],t:[k],imp:b})}h=false;break;case"percentage":if(h){l.t.push(k);l.s+=k[2][2]+"%"}else{j.push({s:k[2][2]+"%",t:[k],imp:b})}h=false;break;case"dimension":if(h){l.t.push(k);l.s+=k[2][2]+k[3][2]}else{j.push({s:k[2][2]+k[3][2],t:[k],imp:b})}h=false;break;case"s":case"comment":case"important":break;default:return false}}if(j.length>4){return false}if(!j[1]){j[1]=j[0]}if(!j[2]){j[2]=j[0]}if(!j[3]){j[3]=j[1]}if(!n.top){n.top=j[0]}if(!n.right){n.right=j[1]}if(!n.bottom){n.bottom=j[2]}if(!n.left){n.left=j[3]}return true}}};TRBL.prototype.isOkToMinimize=function(){var b=this.sides,a;if(!!(b.top&&b.right&&b.bottom&&b.left)){a=b.top.imp+b.right.imp+b.bottom.imp+b.left.imp;return(a===0||a===4||a===this.imp)}return false};TRBL.prototype.getValue=function(){var d=this.sides,b=[d.top,d.right,d.bottom,d.left],e=[{},"value"];if(d.left.s===d.right.s){b.length--;if(d.bottom.s===d.top.s){b.length--;if(d.right.s===d.top.s){b.length--}}}for(var c=0;c<b.length-1;c++){e=e.concat(b[c].t);e.push([{s:" "},"s"," "])}e=e.concat(b[c].t);if(this.impSum()){e.push([{s:"!important"},"important"])}return e};TRBL.prototype.getProperty=function(){return[{s:this.name},"property",[{s:this.name},"ident",this.name]]};TRBL.prototype.getString=function(){var d=this.getProperty(),a=this.getValue().slice(2),c=d[0].s+":";for(var b=0;b<a.length;b++){c+=a[b][0].s}return c};function CSSOCompressor(){}CSSOCompressor.prototype.init=function(){this.props={};this.shorts={};this.shorts2={};this.ccrules={};this.crules={};this.prules={};this.frrules={};this.msrules={};this.csrules={};this.rbrules={};this.rjrules={};this.rrrules={};this.frules={};this.initRules(this.crules,this.defCCfg);this.initRules(this.ccrules,this.cleanCfg);this.initRules(this.frrules,this.frCfg);this.initRules(this.prules,this.preCfg);this.initRules(this.msrules,this.msCfg);this.initRules(this.csrules,this.csCfg);this.initRules(this.rbrules,this.defRBCfg);this.initRules(this.rjrules,this.defRJCfg);this.initRules(this.rrrules,this.defRRCfg);this.initRules(this.frules,this.defFCfg);this.shortGroupID=0;this.lastShortGroupID=0;this.lastShortSelector=0};CSSOCompressor.prototype.initRules=function(f,b){var h=this.order,g=this.profile,a,e,c,d=[];for(e=0;e<h.length;e++){if(h[e] in b){d.push(h[e])}}if(!d.length){d=h}for(e=0;e<d.length;e++){a=g[d[e]];for(c in a){f[c]?f[c].push(d[e]):f[c]=[d[e]]}}};CSSOCompressor.prototype.cleanCfg={cleanComment:1};CSSOCompressor.prototype.defCCfg={cleanCharset:1,cleanImport:1,cleanWhitespace:1,cleanDecldelim:1,compressNumber:1,cleanUnary:1,compressColor:1,compressDimension:1,compressString:1,compressFontWeight:1,compressFont:1,compressBackground:1,cleanEmpty:1};CSSOCompressor.prototype.defRBCfg={restructureBlock:1};CSSOCompressor.prototype.defRJCfg={rejoinRuleset:1,cleanEmpty:1};CSSOCompressor.prototype.defRRCfg={restructureRuleset:1,cleanEmpty:1};CSSOCompressor.prototype.defFCfg={cleanEmpty:1,delimSelectors:1,delimBlocks:1};CSSOCompressor.prototype.preCfg={destroyDelims:1,preTranslate:1};CSSOCompressor.prototype.msCfg={markShorthands:1};CSSOCompressor.prototype.frCfg={freezeRulesets:1};CSSOCompressor.prototype.csCfg={cleanShorthands:1,cleanEmpty:1};CSSOCompressor.prototype.order=["cleanCharset","cleanImport","cleanComment","cleanWhitespace","compressNumber","cleanUnary","compressColor","compressDimension","compressString","compressFontWeight","compressFont","compressBackground","freezeRulesets","destroyDelims","preTranslate","markShorthands","cleanShorthands","restructureBlock","rejoinRuleset","restructureRuleset","cleanEmpty","delimSelectors","delimBlocks"];CSSOCompressor.prototype.profile={cleanCharset:{atrules:1},cleanImport:{atrules:1},cleanWhitespace:{s:1},compressNumber:{number:1},cleanUnary:{unary:1},compressColor:{vhash:1,funktion:1,ident:1},compressDimension:{dimension:1},compressString:{string:1},compressFontWeight:{declaration:1},compressFont:{declaration:1},compressBackground:{declaration:1},cleanComment:{comment:1},cleanDecldelim:{block:1},cleanEmpty:{ruleset:1,atruleb:1,atruler:1},destroyDelims:{decldelim:1,delim:1},preTranslate:{declaration:1,property:1,simpleselector:1,filter:1,value:1,number:1,percentage:1,dimension:1,ident:1},restructureBlock:{block:1},rejoinRuleset:{ruleset:1},restructureRuleset:{ruleset:1},delimSelectors:{selector:1},delimBlocks:{block:1},markShorthands:{block:1},cleanShorthands:{declaration:1},freezeRulesets:{ruleset:1}};CSSOCompressor.prototype.isContainer=function(b){if(Array.isArray(b)){for(var a=0;a<b.length;a++){if(Array.isArray(b[a])){return true}}}};CSSOCompressor.prototype.process=function(l,f,c,h,m){var j=f[1];if(j&&l[j]){var a=l[j],d=f,b,e=this.order,g;for(var g=0;g<a.length;g++){b=this[a[g]](d,j,c,h,m);if(b===null){return null}else{if(b!==undefined){d=b}}}}return d};CSSOCompressor.prototype.compress=function(j,g){j=j||["stylesheet"];this.init();this.info=true;var h=(typeof j[0]!=="string")?j:this.injectInfo([j])[0],e,d=100000000000,f,b,a,c,i=this.findProtectedComment(j);h=this.walk(this.ccrules,h,"/0");h=this.walk(this.crules,h,"/0");h=this.walk(this.prules,h,"/0");h=this.walk(this.frrules,h,"/0");f=translator.translate(cleanInfo(h)).length;if(!g){c=this.copyArray(h);h=this.walk(this.rjrules,h,"/0");this.disjoin(h);h=this.walk(this.msrules,h,"/0");h=this.walk(this.csrules,h,"/0");h=this.walk(this.rbrules,h,"/0");do{e=d;b=this.copyArray(h);h=this.walk(this.rjrules,h,"/0");h=this.walk(this.rrrules,h,"/0");d=translator.translate(cleanInfo(h)).length;a=this.copyArray(h)}while(e>d);if(f<e&&f<d){h=c}else{if(e<d){h=b}}}h=this.walk(this.frules,h,"/0");if(i){h.splice(2,0,i)}return h};CSSOCompressor.prototype.findProtectedComment=function(a){var c;for(var b=2;b<a.length;b++){c=a[b];if(c[1]==="comment"&&c[2].length>0&&c[2].charAt(0)==="!"){return c}if(c[1]!=="s"){return}}};CSSOCompressor.prototype.injectInfo=function(c){var b;for(var a=c.length-1;a>-1;a--){b=c[a];if(b&&Array.isArray(b)){if(this.isContainer(b)){b=this.injectInfo(b)}b.splice(0,0,{})}}return c};CSSOCompressor.prototype.disjoin=function(a){var d,f,g,e;for(var c=a.length-1;c>-1;c--){d=a[c];if(d&&Array.isArray(d)){if(d[1]==="ruleset"){d[0].shortGroupID=this.shortGroupID++;f=d[2];if(f.length>3){e=f.slice(0,2);for(var b=f.length-1;b>1;b--){g=this.copyArray(d);g[2]=e.concat([f[b]]);g[2][0].s=f[b][0].s;a.splice(c+1,0,g)}a.splice(c,1)}}}if(this.isContainer(d)){this.disjoin(d)}}};CSSOCompressor.prototype.walk=function(f,b,e){var d,a;for(var c=b.length-1;c>-1;c--){d=b[c];if(d&&Array.isArray(d)){d[0].parent=b;if(this.isContainer(d)){d=this.walk(f,d,e+"/"+c)}if(d===null){b.splice(c,1)}else{if(a=this.process(f,d,b,c,e)){b[c]=a}else{if(a===null){b.splice(c,1)}}}}}return b.length?b:null};CSSOCompressor.prototype.freezeRulesets=function(d,f,b,c){var e=d[0],a=d[2];e.freeze=this.freezeNeeded(a);e.freezeID=this.selectorSignature(a);e.pseudoID=this.composePseudoID(a);e.pseudoSignature=this.pseudoSelectorSignature(a,this.allowedPClasses,true);this.markSimplePseudo(a);return d};CSSOCompressor.prototype.markSimplePseudo=function(a){var c,d={};for(var b=2;b<a.length;b++){c=a[b];c[0].pseudo=this.containsPseudo(c);c[0].sg=d;d[c[0].s]=1}};CSSOCompressor.prototype.composePseudoID=function(b){var c=[],e;for(var d=2;d<b.length;d++){e=b[d];if(this.containsPseudo(e)){c.push(e[0].s)}}c.sort();return c.join(",")};CSSOCompressor.prototype.containsPseudo=function(b){for(var a=2;a<b.length;a++){switch(b[a][1]){case"pseudoc":case"pseudoe":case"nthselector":if(!(b[a][2][2] in this.notFPClasses)){return true}}}};CSSOCompressor.prototype.selectorSignature=function(b){var c=[];for(var d=2;d<b.length;d++){c.push(translator.translate(cleanInfo(b[d])))}c.sort();return c.join(",")};CSSOCompressor.prototype.pseudoSelectorSignature=function(e,c,d){var m=[],l={},o,n=false;c=c||{};for(var h=2;h<e.length;h++){o=e[h];for(var g=2;g<o.length;g++){switch(o[g][1]){case"pseudoc":case"pseudoe":case"nthselector":if(!(o[g][2][2] in c)){l[o[g][2][2]]=1}else{n=true}break}}}for(var f in l){m.push(f)}m.sort();return m.join(",")+(d?"":n)};CSSOCompressor.prototype.notFPClasses={link:1,visited:1,hover:1,active:1,"first-letter":1,"first-line":1};CSSOCompressor.prototype.notFPElements={"first-letter":1,"first-line":1};CSSOCompressor.prototype.freezeNeeded=function(a){var d;for(var c=2;c<a.length;c++){d=a[c];for(var b=2;b<d.length;b++){switch(d[b][1]){case"pseudoc":if(!(d[b][2][2] in this.notFPClasses)){return true}break;case"pseudoe":if(!(d[b][2][2] in this.notFPElements)){return true}break;case"nthselector":return true;break}}}return false};CSSOCompressor.prototype.cleanCharset=function(c,d,a,b){if(c[2][2][2]==="charset"){for(b=b-1;b>1;b--){if(a[b][1]!=="s"&&a[b][1]!=="comment"){return null}}}};CSSOCompressor.prototype.cleanImport=function(d,e,b,c){var a;for(c=c-1;c>1;c--){a=b[c][1];if(a!=="s"&&a!=="comment"){if(a==="atrules"){a=b[c][2][2][2];if(a!=="import"&&a!=="charset"){return null}}else{return null}}}};CSSOCompressor.prototype.cleanComment=function(c,e,a,b){var f=((a[1]==="braces"&&b===4)||(a[1]!=="braces"&&b===2))?null:a[b-1][1],d=b===a.length-1?null:a[b+1][1];if(d!==null&&f!==null){if(this._cleanComment(d)||this._cleanComment(f)){return null}}else{return null}};CSSOCompressor.prototype._cleanComment=function(a){switch(a){case"s":case"operator":case"attrselector":case"block":case"decldelim":case"ruleset":case"declaration":case"atruleb":case"atrules":case"atruler":case"important":case"nth":case"combinator":return true}};CSSOCompressor.prototype.nextToken=function(a,d,c,f){var b,e;for(;c<a.length;c++){b=a[c];if(Array.isArray(b)){e=b[1];if(e===d){return b}else{if(f&&e!=="s"){return}}}}};CSSOCompressor.prototype.cleanWhitespace=function(c,e,a,b){var f=((a[1]==="braces"&&b===4)||(a[1]!=="braces"&&b===2))?null:a[b-1][1],d=b===a.length-1?null:a[b+1][1];if(d==="unknown"){c[2]="\n"}else{if(!(a[1]==="atrulerq"&&!f)&&!this.issue16(a,b)&&!this.issue165(a,f,d)){if(d!==null&&f!==null){if(this._cleanWhitespace(d,false)||this._cleanWhitespace(f,true)){return null}}else{return null}}c[2]=" "}return c};CSSOCompressor.prototype.issue16=function(a,b){return(b!==2&&b!==a.length-1&&a[b-1][1]==="uri")};CSSOCompressor.prototype.issue165=function(a,c,b){return a[1]==="atrulerq"&&c==="braces"&&b==="ident"};CSSOCompressor.prototype._cleanWhitespace=function(a,b){switch(a){case"s":case"operator":case"attrselector":case"block":case"decldelim":case"ruleset":case"declaration":case"atruleb":case"atrules":case"atruler":case"important":case"nth":case"combinator":return true}if(b){switch(a){case"funktion":case"braces":case"uri":return true}}};CSSOCompressor.prototype.cleanDecldelim=function(b){for(var a=b.length-1;a>1;a--){if(b[a][1]==="decldelim"&&b[a+1][1]!=="declaration"){b.splice(a,1)}}if(b[2][1]==="decldelim"){b.splice(2,1)}return b};CSSOCompressor.prototype.compressNumber=function(d,e,b,c){var a=d[2];if(/^0*/.test(a)){a=a.replace(/^0+/,"")}if(/\.0*$/.test(a)){a=a.replace(/\.0*$/,"")}if(/\..*[1-9]+0+$/.test(a)){a=a.replace(/0+$/,"")}if(a==="."||a===""){a="0"}d[2]=a;d[0].s=a;return d};CSSOCompressor.prototype.findDeclaration=function(a){var b=a;while((b=b[0].parent)&&b[1]!=="declaration"){}return b};CSSOCompressor.prototype.cleanUnary=function(c,e,a,b){var d=a[b+1];if(d&&d[1]==="number"&&d[2]==="0"){return null}return c};CSSOCompressor.prototype.compressColor=function(c,d,a,b){switch(d){case"vhash":return this.compressHashColor(c);case"funktion":return this.compressFunctionColor(c);case"ident":return this.compressIdentColor(c,d,a,b)}};CSSOCompressor.prototype.compressIdentColor=function(c,f,a){var e={yellow:"ff0",fuchsia:"f0f",white:"fff",black:"000",blue:"00f",aqua:"0ff"},d={value:1,functionBody:1},b=c[2].toLowerCase();if(a[1] in d&&b in e){return[{},"vhash",e[b]]}};CSSOCompressor.prototype.compressHashColor=function(a){return this._compressHashColor(a[2],a[0])};CSSOCompressor.prototype._compressHashColor=function(a,d){var c={f00:"red",c0c0c0:"silver","808080":"gray","800000":"maroon","800080":"purple","008000":"green","808000":"olive","000080":"navy","008080":"teal"},b=a;a=a.toLowerCase();if(a.length===6&&a.charAt(0)===a.charAt(1)&&a.charAt(2)===a.charAt(3)&&a.charAt(4)===a.charAt(5)){a=a.charAt(0)+a.charAt(2)+a.charAt(4)}return c[a]?[d,"string",c[a]]:[d,"vhash",(a.length<b.length?a:b)]};CSSOCompressor.prototype.compressFunctionColor=function(c){var d,k=[],l,e="",f;if(c[2][2]==="rgb"){f=c[3];for(d=2;d<f.length;d++){l=f[d][1];if(l==="number"){k.push(f[d])}else{if(l!=="operator"){k=[];break}}}var j=c[0].parent;var g=j.indexOf(c);var b=j[g+1]&&j[g+1][1]!="s";if(k.length===3){e+=(l=Number(k[0][2]).toString(16)).length===1?"0"+l:l;e+=(l=Number(k[1][2]).toString(16)).length===1?"0"+l:l;e+=(l=Number(k[2][2]).toString(16)).length===1?"0"+l:l;if(e.length===6){var a=this._compressHashColor(e,{});if(b){a[2]+=" "}return a}}}};CSSOCompressor.prototype.compressDimension=function(a){var c;if(a[2][2]==="0"){if((a[3][2]==="s"||a[3][2]==="ms")&&(c=this.findDeclaration(a))){var b=c[2][2][2];if(b==="-moz-transition"||b==="transition"){return}if(b==="-moz-animation"||b==="animation"){return}}return a[2]}};CSSOCompressor.prototype.compressString=function(d,g,a){var e=d[2],f="",h;for(var b=0;b<e.length;b++){h=e.charAt(b);if(h==="\\"&&e.charAt(b+1)==="\n"){b++}else{f+=h}}if(e.length!==f.length){return[{},"string",f]}};CSSOCompressor.prototype.compressFontWeight=function(b){var c=b[2],a=b[3];if(c[2][2].indexOf("font-weight")!==-1&&a[2][1]==="ident"){if(a[2][2]==="normal"){a[2]=[{},"number","400"]}else{if(a[2][2]==="bold"){a[2]=[{},"number","700"]}}return b}};CSSOCompressor.prototype.compressFont=function(e){var f=e[2],b=e[3],d,a,c;if(/font$/.test(f[2][2])&&b.length){b.splice(2,0,[{},"s",""]);for(d=b.length-1;d>2;d--){a=b[d];if(a[1]==="ident"){a=a[2];if(a==="bold"){b[d]=[{},"number","700"]}else{if(a==="normal"){c=b[d-1];if(c[1]==="operator"&&c[2]==="/"){b.splice(--d,2)}else{b.splice(d,1)}if(b[d-1][1]==="s"){b.splice(--d,1)}}else{if(a==="medium"&&b[d+1]&&b[d+1][2]!=="/"){b.splice(d,1);if(b[d-1][1]==="s"){b.splice(--d,1)}}}}}}if(b.length>2&&b[2][1]==="s"){b.splice(2,1)}if(b.length===2){b.push([{},"ident","normal"])}return e}};CSSOCompressor.prototype.compressBackground=function(e){var f=e[2],b=e[3],d,a,c,g=b[b.length-1][1]==="important"?3:2;if(/background$/.test(f[2][2])&&b.length){b.splice(2,0,[{},"s",""]);for(d=b.length-1;d>g;d--){a=b[d];if(a[1]==="ident"){a=a[2];if(a==="transparent"||a==="none"||a==="repeat"||a==="scroll"){b.splice(d,1);if(b[d-1][1]==="s"){b.splice(--d,1)}}}}if(b.length>2&&b[2][1]==="s"){b.splice(2,1)}if(b.length===2){b.splice(2,0,[{},"number","0"],[{},"s"," "],[{},"number","0"])}return e}};CSSOCompressor.prototype.cleanEmpty=function(a,b){switch(b){case"ruleset":if(a[3].length===2){return null}break;case"atruleb":if(a[a.length-1].length<3){return null}break;case"atruler":if(a[4].length<3){return null}break}};CSSOCompressor.prototype.destroyDelims=function(){return null};CSSOCompressor.prototype.preTranslate=function(a){a[0].s=translator.translate(cleanInfo(a));return a};CSSOCompressor.prototype.markShorthands=function(d,c,h,r,m){if(h[1]==="ruleset"){var t=h[2][2][0].s,b=h[0].freeze,q=h[0].freezeID}else{var t="",b=false,q="fake"}var e,o,g,w,k,A,z,n=this.pathUp(m)+"/"+(b?"&"+q+"&":"")+t+"/",f,a,l=h[0].shortGroupID;for(var u=d.length-1;u>-1;u--){f=true;e=d[u];if(e[1]==="declaration"){g=e[3];w=g[g.length-1][1]==="important";o=e[2][0].s;e[0].id=m+"/"+u;if(o in TRBL.props){A=n+TRBL.extractMain(o);var y=this.shorts2[A]||[];a=y.length===0?0:y.length-1;if(!this.lastShortSelector||t===this.lastShortSelector||l===this.lastShortGroupID){if(y.length){z=y[a];f=false}}if(f){e[0].replaceByShort=true;e[0].shorthandKey={key:A,i:a};z=new TRBL(o,w);y.push(z)}if(!z.invalid){e[0].removeByShort=true;e[0].shorthandKey={key:A,i:a};z.add(o,g[0].s,g.slice(2),w)}this.shorts2[A]=y;this.lastShortSelector=t;this.lastShortGroupID=l}}}return d};CSSOCompressor.prototype.cleanShorthands=function(b){if(b[0].removeByShort||b[0].replaceByShort){var c,a,d=b[0].shorthandKey;c=this.shorts2[d.key][d.i];if(!c.invalid&&c.isOkToMinimize()){if(b[0].replaceByShort){a=[{},"declaration",c.getProperty(),c.getValue()];a[0].s=translator.translate(cleanInfo(a));return a}else{return null}}}};CSSOCompressor.prototype.dontRestructure={src:1,clip:1,display:1};CSSOCompressor.prototype.restructureBlock=function(e,d,h,r,m){if(h[1]==="ruleset"){var b=this.props,n=h[2][2][0].pseudo,s=h[2][2][0].s,a=h[0].freeze,q=h[0].freezeID,w=h[0].pseudoID,z=h[2][2][0].sg}else{var b={},n=false,s="",a=false,q="fake",w="fake",z={}}var f,o,g,y,k,l=this.pathUp(m)+"/"+s+"/",c;for(var u=e.length-1;u>-1;u--){f=e[u];if(f[1]==="declaration"){g=f[3];y=g[g.length-1][1]==="important";o=f[2][0].s;c=this.buildPPre(l,o,g,f,a);f[0].id=m+"/"+u;if(!this.dontRestructure[o]&&(k=b[c])){if((n&&q===k.freezeID)||(!n&&w===k.pseudoID)||(n&&w===k.pseudoID&&this.hashInHash(z,k.sg))){if(y&&!k.imp){b[c]={block:e,imp:y,id:f[0].id,sg:z,freeze:a,path:m,freezeID:q,pseudoID:w};this.deleteProperty(k.block,k.id)}else{e.splice(u,1)}}}else{if(this.needless(o,b,l,y,g,f,a)){e.splice(u,1)}else{b[c]={block:e,imp:y,id:f[0].id,sg:z,freeze:a,path:m,freezeID:q,pseudoID:w}}}}}return e};CSSOCompressor.prototype.buildPPre=function(f,a,l,h,b){var j=b?"ft:":"ff:";if(a.indexOf("background")!==-1){return j+f+h[0].s}var k=l.slice(2),c=[0,0,0,0],e="";for(var g=0;g<k.length;g++){if(!e){e=this.getVendorIDFromToken(k[g])}switch(k[g][1]){case"vhash":case"ident":c[0]=1;break;case"funktion":switch(k[g][2][2]){case"rgb":c[0]=1;break;case"hsl":c[1]=1;break;case"hsla":c[2]=1;break;case"rgba":c[3]=1;break}break}}return j+f+a+c.join("")+(e?e:"")};CSSOCompressor.prototype.vendorID={"-o-":"o","-moz-":"m","-webkit-":"w","-ms-":"i","-epub-":"e","-apple-":"a","-xv-":"x","-wap-":"p"};CSSOCompressor.prototype.getVendorIDFromToken=function(b){var a;switch(b[1]){case"ident":if(a=this.getVendorFromString(b[2])){return this.vendorID[a]}break;case"funktion":if(a=this.getVendorFromString(b[2][2])){return this.vendorID[a]}break}};CSSOCompressor.prototype.getVendorFromString=function(a){var c=a.charAt(0),b;if(c==="-"){if((b=a.indexOf("-",2))!==-1){return a.substr(0,b+1)}}return""};CSSOCompressor.prototype.deleteProperty=function(c,e){var b;for(var a=c.length-1;a>1;a--){b=c[a];if(Array.isArray(b)&&b[1]==="declaration"&&b[0].id===e){c.splice(a,1);return}}};CSSOCompressor.prototype.nlTable={"border-width":["border"],"border-style":["border"],"border-color":["border"],"border-top":["border"],"border-right":["border"],"border-bottom":["border"],"border-left":["border"],"border-top-width":["border-top","border-width","border"],"border-right-width":["border-right","border-width","border"],"border-bottom-width":["border-bottom","border-width","border"],"border-left-width":["border-left","border-width","border"],"border-top-style":["border-top","border-style","border"],"border-right-style":["border-right","border-style","border"],"border-bottom-style":["border-bottom","border-style","border"],"border-left-style":["border-left","border-style","border"],"border-top-color":["border-top","border-color","border"],"border-right-color":["border-right","border-color","border"],"border-bottom-color":["border-bottom","border-color","border"],"border-left-color":["border-left","border-color","border"],"margin-top":["margin"],"margin-right":["margin"],"margin-bottom":["margin"],"margin-left":["margin"],"padding-top":["padding"],"padding-right":["padding"],"padding-bottom":["padding"],"padding-left":["padding"],"font-style":["font"],"font-variant":["font"],"font-weight":["font"],"font-size":["font"],"font-family":["font"],"list-style-type":["list-style"],"list-style-position":["list-style"],"list-style-image":["list-style"]};CSSOCompressor.prototype.needless=function(e,k,g,a,o,j,f){var n=e.charAt(0);if(n==="*"||n==="_"||n==="$"){e=e.substr(1)}else{if(n==="/"&&e.charAt(1)==="/"){n="//";e=e.substr(2)}else{n=""}}var m=this.getVendorFromString(e),c=e.substr(m.length),l,p,b;if(c in this.nlTable){l=this.nlTable[c];for(var h=0;h<l.length;h++){b=this.buildPPre(g,n+m+l[h],o,j,f);if(p=k[b]){return(!a||p.imp)}}}};CSSOCompressor.prototype.rejoinRuleset=function(f,l,c,h){var e=(h===2||c[h-1][1]==="unknown")?null:c[h-1],b=e?e[2].slice(2):[],m=e?e[3].slice(2):[],k=f[2].slice(2),g=f[3].slice(2),j,d,a;if(!g.length){return null}if(b.length&&m.length&&f[0].pseudoSignature==e[0].pseudoSignature){if(f[1]!==e[1]){return}j=this.getHash(b);d=this.getHash(k);if(this.equalHash(d,j)){e[3]=e[3].concat(f[3].splice(2));return null}if(this.okToJoinByProperties(f,e)){a=this.analyze(f,e);if(!a.ne1.length&&!a.ne2.length){e[2]=this.cleanSelector(e[2].concat(f[2].splice(2)));e[2][0].s=translator.translate(cleanInfo(e[2]));return null}}}};CSSOCompressor.prototype.okToJoinByProperties=function(b,a){var d=b[0],c=a[0];if(d.freezeID===c.freezeID){return true}if(d.pseudoID===c.pseudoID){return true}if(d.freeze&&c.freeze){return this.pseudoSelectorSignature(b[2],this.allowedPClasses)===this.pseudoSelectorSignature(a[2],this.allowedPClasses)}return !(d.freeze||c.freeze)};CSSOCompressor.prototype.allowedPClasses={after:1,before:1};CSSOCompressor.prototype.containsOnlyAllowedPClasses=function(a){var d;for(var c=2;c<a.length;c++){d=a[c];for(var b=2;b<d.length;b++){if(d[b][1]=="pseudoc"||d[b][1]=="pseudoe"){if(!(d[b][2][2] in this.allowedPClasses)){return false}}}}return true};CSSOCompressor.prototype.restructureRuleset=function(g,m,c,j){var d=(j===2||c[j-1][1]==="unknown")?null:c[j-1],b=d?d[2].slice(2):[],o=d?d[3].slice(2):[],h=g[3].slice(2),a,n;if(!h.length){return null}if(b.length&&o.length&&g[0].pseudoSignature==d[0].pseudoSignature){if(g[1]!==d[1]){return}a=this.analyze(g,d);if(a.eq.length&&(a.ne1.length||a.ne2.length)){if(a.ne1.length&&!a.ne2.length){var l=g[2].slice(2),q=translator.translate(cleanInfo(g[2])),f=q.length+l.length-1,e=this.calcLength(a.eq)+a.eq.length-1;if(f<e){d[2]=this.cleanSelector(d[2].concat(g[2].slice(2)));g[3].splice(2);g[3]=g[3].concat(a.ne1);return g}}else{if(a.ne2.length&&!a.ne1.length){var l=d[2].slice(2),q=translator.translate(cleanInfo(d[2])),f=q.length+l.length-1,e=this.calcLength(a.eq)+a.eq.length-1;if(f<e){g[2]=this.cleanSelector(d[2].concat(g[2].slice(2)));d[3].splice(2);d[3]=d[3].concat(a.ne2);return g}}else{var l=this.cleanSelector(d[2].concat(g[2].slice(2))),q=translator.translate(cleanInfo(l)),k=q.length+l.length-1+2,e=this.calcLength(a.eq)+a.eq.length-1;if(e>=k){l[0].s=q;n=[{f:0,l:0},"ruleset",l,[{f:0,l:0},"block"].concat(a.eq)];g[3].splice(2);g[3]=g[3].concat(a.ne1);d[3].splice(2);d[3]=d[3].concat(a.ne2);c.splice(j,0,n);return n}}}}}};CSSOCompressor.prototype.calcLength=function(c){var b=0;for(var a=0;a<c.length;a++){b+=c[a][0].s.length}return b};CSSOCompressor.prototype.cleanSelector=function(b){if(b.length===2){return null}var d={},c;for(var a=2;a<b.length;a++){c=b[a][0].s;if(c in d){b.splice(a,1),a--}else{d[c]=1}}return b};CSSOCompressor.prototype.analyze=function(e,d){var a={eq:[],ne1:[],ne2:[]};if(e[1]!==d[1]){return a}var l=e[3],j=d[3],c=l.slice(2),b=j.slice(2),h,g,f,k;h=this.getHash(c);g=this.getHash(b);for(f=0;f<c.length;f++){k=c[f];if(k[0].s in g){a.eq.push(k)}else{a.ne1.push(k)}}for(f=0;f<b.length;f++){k=b[f];if(!(k[0].s in h)){a.ne2.push(k)}}return a};CSSOCompressor.prototype.equalHash=function(c,b){var a;for(a in c){if(!(a in b)){return false}}for(a in b){if(!(a in c)){return false}}return true};CSSOCompressor.prototype.getHash=function(c){var b={};for(var a=0;a<c.length;a++){b[c[a][0].s]=1}return b};CSSOCompressor.prototype.hashInHash=function(c,b){for(var a in c){if(!(a in b)){return false}}return true};CSSOCompressor.prototype.delimSelectors=function(b){for(var a=b.length-1;a>2;a--){b.splice(a,0,[{},"delim"])}};CSSOCompressor.prototype.delimBlocks=function(b){for(var a=b.length-1;a>2;a--){b.splice(a,0,[{},"decldelim"])}};CSSOCompressor.prototype.copyArray=function(b){var e=[],d;for(var c=0;c<b.length;c++){d=b[c];if(Array.isArray(d)){e.push(this.copyArray(d))}else{if(typeof d==="object"){e.push(this.copyObject(d))}else{e.push(d)}}}return e};CSSOCompressor.prototype.copyObject=function(c){var b={};for(var a in c){b[a]=c[a]}return b};CSSOCompressor.prototype.pathUp=function(a){return a.substr(0,a.lastIndexOf("/"))};var translator=require("./translator.js").translator(),cleanInfo=require("./util.js").cleanInfo;exports.compress=function(a,b){return new CSSOCompressor().compress(a,b)};