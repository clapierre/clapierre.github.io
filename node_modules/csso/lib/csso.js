var fs=require("fs"),print=require("util").print,csso=require("./cssoapi.js"),src,x;var args=process.argv.slice(2),opts=args.length?getOpts(args,["-v","--version","-h","--help","-dp","--parser","-off","--restructure-off"],["-r","--rule","-i","--input","-o","--output"]):null,single=opts&&opts.single,pairs=opts&&opts.pairs,other=opts&&opts.other,ro=single&&single.contains(["-off","--restructure-off"]),inFile=(pairs&&(pairs["-i"]||pairs["--input"]))||(other&&other[0]),outFile=(pairs&&(pairs["-o"]||pairs["--output"]))||(other&&other[1]),rule=pairs&&(pairs["-r"]||pairs["--rule"])||"stylesheet";if(single&&single.contains(["-v","--version"])){printFile("VERSION")}else{if(!inFile||!opts||(single&&single.contains(["-h","--help"]))||other.length>2){printFile("USAGE")}else{src=fs.readFileSync(inFile).toString().trim();if(single.contains(["-dp","--parser"])){csso.printTree(csso.cleanInfo(csso.parse(src,rule,true)))}else{if(!outFile){print(csso.justDoIt(src,ro,true))}else{fs.writeFileSync(outFile,csso.justDoIt(src,ro,true))}}}}function getOpts(b,d,f){var e={single:[],pairs:{},other:[]},a,c=0;for(;c<b.length;){a=b[c];if(d&&d.indexOf(a)!==-1&&(!f||f.indexOf(a)===-1)){e.single.push(a)}else{if(f&&f.indexOf(a)!==-1&&(!d||d.indexOf(a)===-1)){e.pairs[a]=b[++c]}else{e.other.push(a)}}c++}e.single.contains=function(h){if(typeof h==="string"){return this.indexOf(h)!==-1}else{for(var g=0;g<h.length;g++){if(this.indexOf(h[g])!==-1){return true}}}return false};return e}function printFile(a){print(fs.readFileSync(__dirname.slice(0,__dirname.lastIndexOf("/"))+"/"+a).toString())};