var path=require("path"),util=require("util"),mkdirp=require("mkdirp"),Report=require("./index"),LcovOnlyReport=require("./lcovonly"),HtmlReport=require("./html");function LcovReport(c){Report.call(this);c=c||{};var b=path.resolve(c.dir||process.cwd()),a=path.resolve(b,"lcov-report");mkdirp.sync(b);this.lcov=new LcovOnlyReport({dir:b,watermarks:c.watermarks});this.html=new HtmlReport({dir:a,watermarks:c.watermarks,sourceStore:c.sourceStore})}LcovReport.TYPE="lcov";util.inherits(LcovReport,Report);Report.mix(LcovReport,{synopsis:function(){return"combined lcovonly and html report that generates an lcov.info file as well as HTML"},writeReport:function(c,b){var a=this.handleDone.bind(this);this.inProgress=2;this.lcov.on("done",a);this.html.on("done",a);this.lcov.writeReport(c,b);this.html.writeReport(c,b)},handleDone:function(){this.inProgress-=1;if(this.inProgress===0){this.emit("done")}}});module.exports=LcovReport;