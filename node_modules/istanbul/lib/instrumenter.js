(function(p){var g,f,r=p?require("esprima"):esprima,a=p?require("escodegen"):escodegen,n=p?require("crypto"):null,d="(function () { ",m="\n}());",i=/^\s*istanbul\s+ignore\s+(if|else|next)(?=\W|$)/,c,q,k,l=Array.isArray;if(!l){l=function(s){return s&&Object.prototype.toString.call(s)==="[object Array]"}}if(!p){q={"Could not find esprima":r,"Could not find escodegen":a,"JSON object not in scope":JSON,"Array does not implement push":[].push,"Array does not implement unshift":[].unshift};for(k in q){if(q.hasOwnProperty(k)){if(!q[k]){throw new Error(k)}}}}function j(s,t){var v,u;if(n!==null){v=n.createHash("md5");v.update(s);u=v.digest("base64");u=u.replace(new RegExp("=","g"),"").replace(new RegExp("\\+","g"),"_").replace(new RegExp("/","g"),"$")}else{window.__cov_seq=window.__cov_seq||0;window.__cov_seq+=1;u=window.__cov_seq}return"__cov_"+(t?"":u)}function b(t,s){if(!l(s)){s=[s]}Array.prototype.push.apply(t,s)}g={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],Program:["body"],Property:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],SuperExpression:["super"],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]};for(f in g){if(g.hasOwnProperty(f)){g[f]={name:f,children:g[f]}}}c={variable:function(s){return{type:g.Identifier.name,name:s}},stringLiteral:function(s){return{type:g.Literal.name,value:String(s)}},numericLiteral:function(s){return{type:g.Literal.name,value:Number(s)}},statement:function(s){return{type:g.ExpressionStatement.name,expression:s}},dot:function(t,s){return{type:g.MemberExpression.name,computed:false,object:t,property:s}},subscript:function(t,s){return{type:g.MemberExpression.name,computed:true,object:t,property:s}},postIncrement:function(s){return{type:g.UpdateExpression.name,operator:"++",prefix:false,argument:s}},sequence:function(t,s){return{type:g.SequenceExpression.name,expressions:[t,s]}},returnStatement:function(s){return{type:g.ReturnStatement.name,argument:s}}};function o(s,u,v,t){this.walkMap=s;this.preprocessor=u;this.scope=v;this.debug=t;if(this.debug){this.level=0;this.seq=true}}function h(E,F){var v=E.type,s,t,x=g[v],w=!!E.loc||E.type===g.Program.name,K=w?F.walkMap[v]:null,H,G,y,D,u,J,I,C,B,A,z;if(!g[v]){console.error(E);console.error("Unsupported node type:"+v);return}x=g[v].children;if(E.walking){throw new Error("Infinite regress: Custom walkers may NOT call walker.apply(node)")}E.walking=true;J=F.apply(E,F.preprocessor);s=J.preprocessor;if(s){delete J.preprocessor;J=F.apply(E,s)}if(l(K)){for(y=0;y<K.length;y+=1){z=y===K.length-1;J=F.apply(J,K[y]);if(J.type!==v&&!z){throw new Error("Only the last walker is allowed to change the node type: [type was: "+v+" ]")}}}else{if(K){J=F.apply(E,K)}}for(H=0;H<x.length;H+=1){D=x[H];u=E[D];if(u&&!u.skipWalk){B={node:E,property:D};if(l(u)){I=[];for(G=0;G<u.length;G+=1){C=u[G];B.index=G;if(C){A=F.apply(C,null,B);if(l(A.prepend)){b(I,A.prepend);delete A.prepend}}b(I,A)}E[D]=I}else{A=F.apply(u,null,B);if(l(A.prepend)){throw new Error("Internal error: attempt to prepend statements in disallowed (non-array) context")}else{E[D]=A}}}}t=J.postprocessor;if(t){delete J.postprocessor;J=F.apply(J,t)}delete E.walking;return J}o.prototype={startWalk:function(s){this.path=[];this.apply(s)},apply:function(x,w,v){var t,u,s,y;w=w||h;if(this.debug){this.seq+=1;this.level+=1;s=this.seq;y="";for(u=0;u<this.level;u+=1){y+="    "}console.log(y+"Enter ("+s+"):"+x.type)}if(v){this.path.push(v)}t=w.call(this.scope,x,this);if(v){this.path.pop()}if(this.debug){this.level-=1;console.log(y+"Return ("+s+"):"+x.type)}return t||x},startLineForNode:function(s){return s&&s.loc&&s.loc.start?s.loc.start.line:null},ancestor:function(s){return this.path.length>s-1?this.path[this.path.length-s]:null},parent:function(){return this.ancestor(1)},isLabeled:function(){var s=this.parent();return s&&s.node.type===g.LabeledStatement.name}};function e(s){this.opts=s||{debug:false,walkDebug:false,coverageVariable:"__coverage__",codeGenerationOptions:undefined,noAutoWrap:false,noCompact:false,embedSource:false,preserveComments:false};this.walker=new o({ArrowFunctionExpression:[this.arrowBlockConverter],ExpressionStatement:this.coverStatement,BreakStatement:this.coverStatement,ContinueStatement:this.coverStatement,DebuggerStatement:this.coverStatement,ReturnStatement:this.coverStatement,ThrowStatement:this.coverStatement,TryStatement:[this.paranoidHandlerCheck,this.coverStatement],VariableDeclaration:this.coverStatement,IfStatement:[this.ifBlockConverter,this.coverStatement,this.ifBranchInjector],ForStatement:[this.skipInit,this.loopBlockConverter,this.coverStatement],ForInStatement:[this.skipLeft,this.loopBlockConverter,this.coverStatement],ForOfStatement:[this.skipLeft,this.loopBlockConverter,this.coverStatement],WhileStatement:[this.loopBlockConverter,this.coverStatement],DoWhileStatement:[this.loopBlockConverter,this.coverStatement],SwitchStatement:[this.coverStatement,this.switchBranchInjector],SwitchCase:[this.switchCaseInjector],WithStatement:[this.withBlockConverter,this.coverStatement],FunctionDeclaration:[this.coverFunction,this.coverStatement],FunctionExpression:this.coverFunction,LabeledStatement:this.coverStatement,ConditionalExpression:this.conditionalBranchInjector,LogicalExpression:this.logicalExpressionBranchInjector,ObjectExpression:this.maybeAddType},this.extractCurrentHint,this,this.opts.walkDebug);if(this.opts.backdoor&&this.opts.backdoor.omitTrackerSuffix){this.omitTrackerSuffix=true}}e.prototype={instrumentSync:function(u,t){var s;if(typeof u!=="string"){throw new Error("Code must be string")}if(u.charAt(0)==="#"){u="//"+u}if(!this.opts.noAutoWrap){u=d+u+m}s=r.parse(u,{loc:true,range:true,tokens:this.opts.preserveComments,comment:true});if(this.opts.preserveComments){s=a.attachComments(s,s.comments,s.tokens)}if(!this.opts.noAutoWrap){s={type:g.Program.name,body:s.body[0].expression.callee.body.body,comments:s.comments}}return this.instrumentASTSync(s,t,u)},filterHints:function(v){var t=[],u,w,s;if(!(v&&l(v))){return t}for(u=0;u<v.length;u+=1){w=v[u];if(w&&w.value&&w.range&&l(w.range)){s=String(w.value).match(i);if(s){t.push({type:s[1],start:w.range[0],end:w.range[1]})}}}return t},extractCurrentHint:function(u){if(!u.range){return}var s=this.currentState.lastHintPosition+1,v=this.currentState.hints,t=u.range[0],w;this.currentState.currentHint=null;while(s<v.length){w=v[s];if(w.end<t){this.currentState.currentHint=w;this.currentState.lastHintPosition=s;s+=1}else{break}}},instrumentASTSync:function(w,s,y){var u=false,x,z,t,A,v;s=s||String(new Date().getTime())+".js";this.sourceMap=null;this.coverState={path:s,s:{},b:{},f:{},fnMap:{},statementMap:{},branchMap:{}};this.currentState={trackerVar:j(s,this.omitTrackerSuffix),func:0,branch:0,variable:0,statement:0,hints:this.filterHints(w.comments),currentHint:null,lastHintPosition:-1,ignoring:0};if(w.body&&w.body.length>0&&this.isUseStrictExpression(w.body[0])){w.body.shift();u=true}this.walker.startWalk(w);x=this.opts.codeGenerationOptions||{format:{compact:!this.opts.noCompact}};x.comment=this.opts.preserveComments;z=a.generate(w,x);t=this.getPreamble(y||"",u);if(z.map&&z.code){A=t.split(/\r\n|\r|\n/).length;for(v=0;v<z.map._mappings._array.length;v+=1){z.map._mappings._array[v].generatedLine+=A}this.sourceMap=z.map;z=z.code}return t+"\n"+z+"\n"},instrument:function(u,s,v){if(!v&&typeof s==="function"){v=s;s=null}try{v(null,this.instrumentSync(u,s))}catch(t){v(t)}},lastFileCoverage:function(){return this.coverState},lastSourceMap:function(){return this.sourceMap},fixColumnPositions:function(w){var y=d.length,u=function(z){if(z.start.line===1){z.start.column-=y}if(z.end.line===1){z.end.column-=y}},t,x,v,s;x=w.statementMap;for(t in x){if(x.hasOwnProperty(t)){u(x[t])}}x=w.fnMap;for(t in x){if(x.hasOwnProperty(t)){u(x[t].loc)}}x=w.branchMap;for(t in x){if(x.hasOwnProperty(t)){s=x[t].locations;for(v=0;v<s.length;v+=1){u(s[v])}}}},getPreamble:function(v,t){var y=this.opts.coverageVariable||"__coverage__",w=this.coverState.path.replace(/\\/g,"\\\\"),A=this.currentState.trackerVar,u,z=t?'"use strict";':"",x=function(B){return function(){return B}},s;if(!this.opts.noAutoWrap){this.fixColumnPositions(this.coverState)}if(this.opts.embedSource){this.coverState.code=v.split(/(?:\r?\n)|\r/)}u=this.opts.debug?JSON.stringify(this.coverState,undefined,4):JSON.stringify(this.coverState);s=["%STRICT%","var %VAR% = (Function('return this'))();","if (!%VAR%.%GLOBAL%) { %VAR%.%GLOBAL% = {}; }","%VAR% = %VAR%.%GLOBAL%;","if (!(%VAR%['%FILE%'])) {","   %VAR%['%FILE%'] = %OBJECT%;","}","%VAR% = %VAR%['%FILE%'];"].join("\n").replace(/%STRICT%/g,x(z)).replace(/%VAR%/g,x(A)).replace(/%GLOBAL%/g,x(y)).replace(/%FILE%/g,x(w)).replace(/%OBJECT%/g,x(u));return s},startIgnore:function(){this.currentState.ignoring+=1},endIgnore:function(){this.currentState.ignoring-=1},convertToBlock:function(s){if(!s){return{type:"BlockStatement",body:[]}}else{if(s.type==="BlockStatement"){return s}else{return{type:"BlockStatement",body:[s]}}}},arrowBlockConverter:function(t){var s;if(t.expression){s=c.returnStatement(t.body);s.loc=t.body.loc;t.body=this.convertToBlock(s);t.expression=false}},paranoidHandlerCheck:function(s){if(!s.handler&&s.handlers){s.handler=s.handlers[0]}},ifBlockConverter:function(s){s.consequent=this.convertToBlock(s.consequent);s.alternate=this.convertToBlock(s.alternate)},loopBlockConverter:function(s){s.body=this.convertToBlock(s.body)},withBlockConverter:function(s){s.body=this.convertToBlock(s.body)},statementName:function(s,t){var u,v=!!this.currentState.ignoring;s.skip=v||undefined;t=t||0;this.currentState.statement+=1;u=this.currentState.statement;this.coverState.statementMap[u]=s;this.coverState.s[u]=t;return u},skipInit:function(s){if(s.init){s.init.skipWalk=true}},skipLeft:function(s){s.left.skipWalk=true},isUseStrictExpression:function(s){return s&&s.type===g.ExpressionStatement.name&&s.expression&&s.expression.type===g.Literal.name&&s.expression.value==="use strict"},maybeSkipNode:function(u,t){var s=!!this.currentState.ignoring,v=this.currentState.currentHint,w=!s&&v&&v.type===t;if(w){this.startIgnore();u.postprocessor=this.endIgnore;return true}return false},coverStatement:function(t,w){var u,s,v;this.maybeSkipNode(t,"next");if(this.isUseStrictExpression(t)){v=w.ancestor(2);if(v){if((v.node.type===g.FunctionExpression.name||v.node.type===g.FunctionDeclaration.name)&&w.parent().node.body[0]===t){return}}}if(t.type===g.FunctionDeclaration.name){u=this.statementName(t.loc,1)}else{u=this.statementName(t.loc);s=c.statement(c.postIncrement(c.subscript(c.dot(c.variable(this.currentState.trackerVar),c.variable("s")),c.stringLiteral(u))));this.splice(s,t,w)}},splice:function(s,t,v){var u=v.isLabeled()?v.parent().node:t;u.prepend=u.prepend||[];b(u.prepend,s)},functionName:function(v,t,s){this.currentState.func+=1;var y=this.currentState.func,x=!!this.currentState.ignoring,u=v.id?v.id.name:"(anonymous_"+y+")",w=function(z){var A=s[z]||{};return{line:A.line,column:A.column}};this.coverState.fnMap[y]={name:u,line:t,loc:{start:w("start"),end:w("end")},skip:x||undefined};this.coverState.f[y]=0;return y},coverFunction:function(v,w){var x,t=v.body,s=t.body,u;this.maybeSkipNode(v,"next");x=this.functionName(v,w.startLineForNode(v),{start:v.loc.start,end:{line:v.body.loc.start.line,column:v.body.loc.start.column}});if(s.length>0&&this.isUseStrictExpression(s[0])){u=s.shift()}s.unshift(c.statement(c.postIncrement(c.subscript(c.dot(c.variable(this.currentState.trackerVar),c.variable("f")),c.stringLiteral(x)))));if(u){s.unshift(u)}},branchName:function(v,y,w){var u,x=[],s=[],t,z=!!this.currentState.ignoring;this.currentState.branch+=1;u=this.currentState.branch;for(t=0;t<w.length;t+=1){w[t].skip=w[t].skip||z||undefined;s.push(w[t]);x.push(0)}this.coverState.b[u]=x;this.coverState.branchMap[u]={line:y,type:v,locations:s};return u},branchIncrementExprAst:function(v,t,u){var s=c.postIncrement(c.subscript(c.subscript(c.dot(c.variable(this.currentState.trackerVar),c.variable("b")),c.stringLiteral(v)),c.numericLiteral(t)),u);return s},locationsForNodes:function(s){var t=[],u;for(u=0;u<s.length;u+=1){t.push(s[u].loc)}return t},ifBranchInjector:function(w,s){var z=!!this.currentState.ignoring,x=this.currentState.currentHint,u=!z&&x&&x.type==="if",y=!z&&x&&x.type==="else",E=w.loc.start.line,v=w.loc.start.column,B=function(){return{line:E,column:v}},D=this.branchName("if",s.startLineForNode(w),[{start:B(),end:B(),skip:u||undefined},{start:B(),end:B(),skip:y||undefined}]),A=w.consequent.body,C=w.alternate.body,t;A.unshift(c.statement(this.branchIncrementExprAst(D,0)));C.unshift(c.statement(this.branchIncrementExprAst(D,1)));if(u){t=w.consequent;t.preprocessor=this.startIgnore;t.postprocessor=this.endIgnore}if(y){t=w.alternate;t.preprocessor=this.startIgnore;t.postprocessor=this.endIgnore}},branchLocationFor:function(t,s){return this.coverState.branchMap[t].locations[s]},switchBranchInjector:function(v,w){var u=v.cases,t,s;if(!(u&&u.length>0)){return}t=this.branchName("switch",w.startLineForNode(v),this.locationsForNodes(u));for(s=0;s<u.length;s+=1){u[s].branchLocation=this.branchLocationFor(t,s);u[s].consequent.unshift(c.statement(this.branchIncrementExprAst(t,s)))}},switchCaseInjector:function(t){var s=t.branchLocation;delete t.branchLocation;if(this.maybeSkipNode(t,"next")){s.skip=true}},conditionalBranchInjector:function(v,w){var u=this.branchName("cond-expr",w.startLineForNode(v),this.locationsForNodes([v.consequent,v.alternate])),t=this.branchIncrementExprAst(u,0),s=this.branchIncrementExprAst(u,1);v.consequent.preprocessor=this.maybeAddSkip(this.branchLocationFor(u,0));v.alternate.preprocessor=this.maybeAddSkip(this.branchLocationFor(u,1));v.consequent=c.sequence(t,v.consequent);v.alternate=c.sequence(s,v.alternate)},maybeAddSkip:function(s){return function(u){var t=!!this.currentState.ignoring,v=this.currentState.currentHint,w=!t&&v&&v.type==="next";if(w){this.startIgnore();u.postprocessor=this.endIgnore}if(w||t){s.skip=true}}},logicalExpressionBranchInjector:function(w,x){var v=x.parent(),y=[],u,s,t;this.maybeSkipNode(w,"next");if(v&&v.node.type===g.LogicalExpression.name){return}this.findLeaves(w,y);u=this.branchName("binary-expr",x.startLineForNode(w),this.locationsForNodes(y.map(function(z){return z.node})));for(t=0;t<y.length;t+=1){s=y[t];s.parent[s.property]=c.sequence(this.branchIncrementExprAst(u,t),s.node);s.node.preprocessor=this.maybeAddSkip(this.branchLocationFor(u,t))}},findLeaves:function(u,s,t,v){if(u.type===g.LogicalExpression.name){this.findLeaves(u.left,s,u,"left");this.findLeaves(u.right,s,u,"right")}else{s.push({node:u,parent:t,property:v})}},maybeAddType:function(u){var t=u.properties,s,v;for(s=0;s<t.length;s+=1){v=t[s];if(!v.type){v.type=g.Property.name}}}};if(p){module.exports=e}else{window.Instrumenter=e}}(typeof module!=="undefined"&&typeof module.exports!=="undefined"&&typeof exports!=="undefined"));