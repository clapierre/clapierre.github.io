var exec=require("child_process").exec,fs=require("fs"),path=require("path"),exists=fs.existsSync||path.existsSync,os=require("os"),quote=JSON.stringify,cmd;function which(b){var e=process.env.PATH.split(":");var d;for(var c=0,a=e.length;c<a;++c){d=path.join(e[c],b);if(exists(d)){return d}}}switch(os.type()){case"Darwin":if(which("terminal-notifier")){cmd={type:"Darwin-NotificationCenter",pkg:"terminal-notifier",msg:"-message",title:"-title",subtitle:"-subtitle",priority:{cmd:"-execute",range:[]}}}else{cmd={type:"Darwin-Growl",pkg:"growlnotify",msg:"-m",sticky:"--sticky",priority:{cmd:"--priority",range:[-2,-1,0,1,2,"Very Low","Moderate","Normal","High","Emergency"]}}}break;case"Linux":cmd={type:"Linux",pkg:"notify-send",msg:"",sticky:"-t 0",icon:"-i",priority:{cmd:"-u",range:["low","normal","critical"]}};break;case"Windows_NT":cmd={type:"Windows",pkg:"growlnotify",msg:"",sticky:"/s:true",title:"/t:",icon:"/i:",priority:{cmd:"/p:",range:[-2,-1,0,1,2]}};break}exports=module.exports=growl;exports.version="1.4.1";function growl(b,i,g){var c,e,i=i||{},g=g||function(){};if(!cmd){return g(new Error("growl not supported on this platform"))}e=[cmd.pkg];if(c=i.image){switch(cmd.type){case"Darwin-Growl":var f,a=path.extname(c).substr(1);f=f||a=="icns"&&"iconpath";f=f||/^[A-Z]/.test(c)&&"appIcon";f=f||/^png|gif|jpe?g$/.test(a)&&"image";f=f||a&&(c=a)&&"icon";f=f||"icon";e.push("--"+f,quote(c));break;case"Linux":e.push(cmd.icon,quote(c));if(!i.sticky){e.push("--hint=int:transient:1")}break;case"Windows":e.push(cmd.icon+quote(c));break}}if(i.sticky){e.push(cmd.sticky)}if(i.priority){var h=i.priority+"";var d=cmd.priority.range.indexOf(h);if(~cmd.priority.range.indexOf(h)){e.push(cmd.priority,i.priority)}}if(i.name&&cmd.type==="Darwin-Growl"){e.push("--name",i.name)}switch(cmd.type){case"Darwin-Growl":e.push(cmd.msg);e.push(quote(b));if(i.title){e.push(quote(i.title))}break;case"Darwin-NotificationCenter":e.push(cmd.msg);e.push(quote(b));if(i.title){e.push(cmd.title);e.push(quote(i.title))}if(i.subtitle){e.push(cmd.subtitle);e.push(quote(i.subtitle))}break;case"Darwin-Growl":e.push(cmd.msg);e.push(quote(b));if(i.title){e.push(quote(i.title))}break;case"Linux":if(i.title){e.push(quote(i.title));e.push(cmd.msg);e.push(quote(b))}else{e.push(quote(b))}break;case"Windows":e.push(quote(b));if(i.title){e.push(cmd.title+quote(i.title))}break}exec(e.join(" "),g)};