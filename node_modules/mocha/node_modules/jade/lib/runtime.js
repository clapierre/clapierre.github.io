/*!
 * Jade - runtime
 * Copyright(c) 2010 TJ Holowaychuk <tj@vision-media.ca>
 * MIT Licensed
 */
if(!Array.isArray){Array.isArray=function(a){return"[object Array]"==Object.prototype.toString.call(a)}}if(!Object.keys){Object.keys=function(c){var a=[];for(var b in c){if(c.hasOwnProperty(b)){a.push(b)}}return a}}exports.merge=function merge(d,c){var f=d["class"];var g=c["class"];if(f||g){f=f||[];g=g||[];if(!Array.isArray(f)){f=[f]}if(!Array.isArray(g)){g=[g]}f=f.filter(nulls);g=g.filter(nulls);d["class"]=f.concat(g).join(" ")}for(var e in c){if(e!="class"){d[e]=c[e]}}return d};function nulls(a){return a!=null}exports.attrs=function attrs(d,a){var b=[],h=d.terse;delete d.terse;var j=Object.keys(d),f=j.length;if(f){b.push("");for(var e=0;e<f;++e){var g=j[e],c=d[g];if("boolean"==typeof c||null==c){if(c){h?b.push(g):b.push(g+'="'+g+'"')}}else{if(0==g.indexOf("data")&&"string"!=typeof c){b.push(g+"='"+JSON.stringify(c)+"'")}else{if("class"==g&&Array.isArray(c)){b.push(g+'="'+exports.escape(c.join(" "))+'"')}else{if(a&&a[g]){b.push(g+'="'+exports.escape(c)+'"')}else{b.push(g+'="'+c+'"')}}}}}}return b.join(" ")};exports.escape=function escape(a){return String(a).replace(/&(?!(\w+|\#\d+);)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};exports.rethrow=function rethrow(e,c,f){if(!c){throw e}var d=3,g=require("fs").readFileSync(c,"utf8"),b=g.split("\n"),h=Math.max(f-d,0),a=Math.min(b.length,f+d);var d=b.slice(h,a).map(function(j,k){var l=k+h+1;return(l==f?"  > ":"    ")+l+"| "+j}).join("\n");e.path=c;e.message=(c||"Jade")+":"+f+"\n"+d+"\n\n"+e.message;throw e};