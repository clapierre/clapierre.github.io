var Base=require("./base"),utils=require("../utils");var SUITE_PREFIX="$";exports=module.exports=Markdown;function Markdown(i){Base.call(this,i);var j=this,e=this.stats,b=0,c="";function h(k){return Array(b).join("#")+" "+k}function d(){return Array(b).join("  ")}function g(m,n){var k=n,l=SUITE_PREFIX+m.title;n=n[l]=n[l]||{suite:m};m.suites.forEach(function(o){g(o,n)});return k}function f(n,o){++o;var k="";var m;for(var l in n){if("suite"==l){continue}if(l!==SUITE_PREFIX){m=" - ["+l.substring(1)+"]";m+="(#"+utils.slug(n[l].suite.fullTitle())+")\n";k+=Array(o).join("  ")+m}k+=f(n[l],o)}return k}function a(k){var l=g(k,{});return f(l,0)}a(i.suite);i.on("suite",function(l){++b;var k=utils.slug(l.fullTitle());c+='<a name="'+k+'"></a>\n';c+=h(l.title)+"\n"});i.on("suite end",function(k){--b});i.on("pass",function(l){var k=utils.clean(l.fn.toString());c+=l.title+".\n";c+="\n```js\n";c+=k+"\n";c+="```\n\n"});i.on("end",function(){process.stdout.write("# TOC\n");process.stdout.write(a(i.suite));process.stdout.write(c)})};