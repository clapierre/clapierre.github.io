function Runnable(t,e){this.title=t,this.fn=e,this.async=e&&e.length,this.sync=!this.async,this._timeout=2e3,this._slow=75,this.timedOut=!1}var EventEmitter=require("events").EventEmitter,debug=require("debug")("mocha:runnable"),milliseconds=require("./ms"),Date=global.Date,setTimeout=global.setTimeout,setInterval=global.setInterval,clearTimeout=global.clearTimeout,clearInterval=global.clearInterval,toString=Object.prototype.toString;module.exports=Runnable,Runnable.prototype.__proto__=EventEmitter.prototype,Runnable.prototype.timeout=function(t){return 0==arguments.length?this._timeout:("string"==typeof t&&(t=milliseconds(t)),debug("timeout %d",t),this._timeout=t,this.timer&&this.resetTimeout(),this)},Runnable.prototype.slow=function(t){return 0===arguments.length?this._slow:("string"==typeof t&&(t=milliseconds(t)),debug("timeout %d",t),this._slow=t,this)},Runnable.prototype.fullTitle=function(){return this.parent.fullTitle()+" "+this.title},Runnable.prototype.clearTimeout=function(){clearTimeout(this.timer)},Runnable.prototype.inspect=function(){return JSON.stringify(this,function(t,e){return"_"!=t[0]?"parent"==t?"#<Suite>":"ctx"==t?"#<Context>":e:void 0},2)},Runnable.prototype.resetTimeout=function(){var t=this,e=this.timeout()||1e9;this.clearTimeout(),this.timer=setTimeout(function(){t.callback(new Error("timeout of "+e+"ms exceeded")),t.timedOut=!0},e)},Runnable.prototype.globals=function(t){this._allowedGlobals=t},Runnable.prototype.run=function(t){function e(t){r||(r=!0,l.emit("error",t||new Error("done() called multiple times")))}function n(n){if(!l.timedOut){if(o)return e(n);l.clearTimeout(),l.duration=new Date-u,o=!0,t(n)}}function i(t){var e=t.call(s);e&&"function"==typeof e.then?(l.resetTimeout(),e.then(function(){n()},n)):n()}var o,r,l=this,u=(this.timeout(),new Date),s=this.ctx;if(s&&s.runnable(this),this.callback=n,this.async){this.resetTimeout();try{this.fn.call(s,function(t){return t instanceof Error||"[object Error]"===toString.call(t)?n(t):null!=t?n(new Error("done() invoked with non-Error: "+t)):void n()})}catch(a){n(a)}}else{if(this.asyncOnly)return n(new Error("--async-only option in use without declaring `done()`"));try{this.pending?n():i(this.fn)}catch(a){n(a)}}};