var path=require("path");var fs=require("graceful-fs");var mkdir=require("../mkdirs");function createLink(b,c,d){function a(e,f){fs.link(e,f,function(g){if(g){return d(g)}d(null)})}fs.exists(c,function(e){if(e){return d(null)}fs.lstat(b,function(h,g){if(h){h.message=h.message.replace("lstat","ensureLink");return d(h)}var f=path.dirname(c);fs.exists(f,function(i){if(i){return a(b,c)}mkdir.mkdirs(f,function(j){if(j){return d(j)}a(b,c)})})})})}function createLinkSync(a,c,g){var e=fs.existsSync(c);if(e){return undefined}try{fs.lstatSync(a)}catch(d){d.message=d.message.replace("lstat","ensureLink");throw d}var b=path.dirname(c);var f=fs.existsSync(b);if(f){return fs.linkSync(a,c)}mkdir.mkdirsSync(b);return fs.linkSync(a,c)}module.exports={createLink:createLink,createLinkSync:createLinkSync,ensureLink:createLink,ensureLinkSync:createLinkSync};