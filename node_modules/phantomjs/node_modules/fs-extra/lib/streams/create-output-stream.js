var path=require("path");var fs=require("fs");var mkdir=require("../mkdirs");var WriteStream=fs.WriteStream;function createOutputStream(d,c){var f=false;var b=path.dirname(d);c=c||{};if(c.fd){return fs.createWriteStream(d,c)}else{c.fd=-1}var a=new WriteStream(d,c);var e=a.open;a.open=function(){a.fd=null;if(f){return e.call(a)}mkdir.mkdirs(b,function(g){if(g){a.destroy();a.emit("error",g);return}f=true;e.call(a)})};a.open();return a}module.exports=createOutputStream;