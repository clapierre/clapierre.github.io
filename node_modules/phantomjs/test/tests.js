var childProcess=require("child_process");var fs=require("fs");var path=require("path");var phantomjs=require("../lib/phantomjs");exports.testDownload=function(a){a.expect(1);a.ok(fs.existsSync(phantomjs.path),"Binary file should have been downloaded");a.done()};exports.testPhantomExecutesTestScript=function(b){b.expect(1);var a=[path.join(__dirname,"loadspeed.js"),"http://www.google.com/"];childProcess.execFile(phantomjs.path,a,function(e,c,d){var f=(c.indexOf("msec")!==-1);b.ok(f,"Test script should have executed and returned run time");b.done()})};exports.testPhantomExitCode=function(a){a.expect(1);childProcess.execFile(phantomjs.path,[path.join(__dirname,"exit.js")],function(d,b,c){a.equals(d.code,123,"Exit code should be returned from phantom script");a.done()})};exports.testBinFile=function(b){b.expect(1);var a=process.platform==="win32"?path.join(__dirname,"..","lib","phantom","phantomjs.exe"):path.join(__dirname,"..","bin","phantomjs");childProcess.execFile(a,["--version"],function(e,c,d){b.equal(phantomjs.version,c.trim(),"Version should be match");b.done()})};exports.testCleanPath=function(a){a.expect(5);a.equal("/Users/dan/bin",phantomjs.cleanPath("/Users/dan/bin:./bin"));a.equal("/Users/dan/bin:/usr/bin",phantomjs.cleanPath("/Users/dan/bin:./bin:/usr/bin"));a.equal("/usr/bin",phantomjs.cleanPath("./bin:/usr/bin"));a.equal("",phantomjs.cleanPath("./bin"));a.equal("/Work/bin:/usr/bin",phantomjs.cleanPath("/Work/bin:/Work/phantomjs/node_modules/.bin:/usr/bin"));a.done()};