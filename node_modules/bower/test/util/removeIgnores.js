var expect=require("expect.js");var helpers=require("../helpers");var glob=require("glob");var Q=require("q");var removeIgnores=require("../../lib/util/removeIgnores");describe("removeIgnores",function(){var a=new helpers.TempDir({"bower.json":{},"index.js":"Not to ignore","node_modules/underscore/index.js":"Should be ignored"});var b=function(d,f,e){a.prepare();var c=Q.defer();removeIgnores(d,f).then(function(){glob("**/*.*",{cwd:d},function(g,h){expect(h).to.eql(e);c.resolve()})});return c.promise};it("removes all files in directory",function(){return b(a.path,{ignore:["node_modules/**/*"]},["bower.json","index.js"])});it("removes whole directory",function(){return b(a.path,{ignore:["node_modules/"]},["bower.json","index.js"])});it("removes whole directory (no ending slash)",function(){return b(a.path,{ignore:["node_modules"]},["bower.json","index.js"])});it("removes all but one file",function(){return b(a.path,{ignore:["**/*","!bower.json"]},["bower.json"])});it("refuses to ignore bower.json",function(){return b(a.path,{ignore:["**/*","!index.js"]},["bower.json","index.js"])});it("removes all but one file deep down the tree",function(){return b(a.path,{ignore:["**/*","!node_modules/underscore/index.js"]},["bower.json","node_modules/underscore/index.js"])})});