function ensureInsight(){if(!insight){var t=require("insight"),n=require("../../package.json");insight=new t({trackingCode:"UA-43531210-1",packageName:n.name,packageVersion:n.version})}}var Q=require("q"),mout=require("mout"),analytics=module.exports,insight,enableAnalytics=!1;analytics.setup=function(t){var n=Q.defer();return void 0===t.analytics?(ensureInsight(),t.interactive?void 0!==insight.optOut?n.resolve(!insight.optOut):insight.askPermission(null,function(t,i){n.resolve(i)}):n.resolve(!1)):n.resolve(t.analytics),n.promise.then(function(t){return enableAnalytics=t,t})};var Tracker=analytics.Tracker=function(t){function n(){return t&&void 0!==t.analytics?t.analytics:enableAnalytics}n()?ensureInsight():(this.track=function(){},this.trackDecomposedEndpoints=function(){},this.trackPackages=function(){},this.trackNames=function(){})};Tracker.prototype.track=function(){insight.track.apply(insight,arguments)},Tracker.prototype.trackDecomposedEndpoints=function(t,n){n.forEach(function(n){this.track(t,n.source,n.target)}.bind(this))},Tracker.prototype.trackPackages=function(t,n){mout.object.forOwn(n,function(n){var i=n.pkgMeta;this.track(t,i.name,i.version)}.bind(this))},Tracker.prototype.trackNames=function(t,n){n.forEach(function(n){this.track(t,n)}.bind(this))};
