var path=require("path");var rimraf=require("rimraf");var fstreamIgnore=require("fstream-ignore");var mout=require("mout");var Q=require("q");function removeIgnores(e,g){var a;var d;var c=Q.defer();var b=[];var f=["bower.json"];f=f.concat(g.main||[]);f=f.map(function(h){return path.join(e,h)});a=fstreamIgnore({path:e,type:"Directory"});a.addIgnoreRules(g.ignore||[]);d=a.applyIgnores;a.applyIgnores=function(i){var h=d.apply(this,arguments);if(!h){b.push(path.join(e,i))}return h};a.on("child",function(h){f.push(h.path)}).on("error",c.reject).on("end",function(){var h;b=mout.array.unique(b);b=b.filter(function(i){return f.indexOf(i)===-1});h=b.map(function(i){return Q.nfcall(rimraf,i)});return Q.all(h).then(c.resolve,c.reject)});return c.promise}module.exports=removeIgnores;