function register(r,e,t,i){var a,n,o,c;return i=defaultConfig(i),c=i.force,o=new Tracker(i),i.offline=!1,i.force=!0,e=e.trim(),Q["try"](function(){if(!e)throw createError("Please type a name","EINVNAME");if(i.registry.register===Config.DEFAULT_REGISTRY&&(t=convertUrl(t,r),!mout.string.startsWith(t,"git://")))throw createError("The registry only accepts URLs starting with git://","EINVFORMAT");return o.track("register"),a=new PackageRepository(i,r),a.fetch({name:e,source:t,target:"*"})}).spread(function(e,t){if(t["private"])throw createError("The package you are trying to register is marked as private","EPRIV");return!i.interactive||c?!0:Q.nfcall(r.prompt.bind(r),{type:"confirm",message:"Registering a package will make it installable via the registry ("+chalk.cyan.underline(i.registry.register)+"), continue?","default":!0})}).then(function(i){return i?(n=a.getRegistryClient(),r.action("register",t,{name:e,url:t}),Q.nfcall(n.register.bind(n),e,t)):void 0})}function convertUrl(r,e){var t,i;return mout.string.startsWith(r,"git://")||(t=GitHubResolver.getOrgRepoPair(r),t&&(i="git://github.com/"+t.org+"/"+t.repo+".git",e.warn("convert","Converted "+r+" to "+i))),i||r}var mout=require("mout"),Q=require("q"),chalk=require("chalk"),PackageRepository=require("../core/PackageRepository"),Config=require("bower-config"),Tracker=require("../util/analytics").Tracker,cli=require("../util/cli"),createError=require("../util/createError"),defaultConfig=require("../config"),GitHubResolver=require("../core/resolvers/GitHubResolver");register.line=function(r,e){var t=cli.readOptions(e),i=t.argv.remain[1],a=t.argv.remain[2];return i&&a?register(r,i,a):new Q},register.completion=function(){},module.exports=register;
