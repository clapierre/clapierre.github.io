"use strict";var fs=require("fs"),path=require("path"),utl=require("../utl"),highlighter=require(".."),colorize=require("../colorize"),diffFile=path.join(__dirname,"fixtures","git-diff.txt"),diff=fs.readFileSync(diffFile,"utf-8");var diffRegex=/^@@[^@]+@@$/m;var diffIndRegex=/^(@@[^@]+@@)(.*)$/;var addRemRegex=/^[+\-]/;var lines=diff.split("\n");function isDiff(a){return !!a.filter(function(b){return diffRegex.test(b)}).length}var diff=isDiff(lines);function tryHighlight(a){function f(j,l){try{return highlighter.highlight(a+j)}catch(k){return l(a)}}function i(l){var k;try{k=highlighter.highlight(a.replace(/^( +),(.+)$/,"$1 $2"));return k}catch(j){return l(a)}}function e(){try{return highlighter.highlight(a)}catch(j){return d()}}function d(){return f("}",h)}function h(){return f("\\)",c)}function c(){return f("})",g)}function g(){return i(b)}function b(){return a}return e()}function highlightDiffInd(a,d){var c=colorize.brightBlue(d[1]),b=d[2];return b?c+tryHighlight(b):c}function colorizeAddRemove(a){return addRemRegex.test(a)?colorize.yellow(a):a}function highlightDiff(a){var b=diffIndRegex.exec(a);return b?highlightDiffInd(a,b):colorizeAddRemove(a[0])+tryHighlight(a.slice(1))}var highlightFn=diff?highlightDiff:tryHighlight;var highlightedLines=lines.map(highlightFn);console.log(highlightedLines.join("\n"));