var path=require("path");var fs=require("graceful-fs");var optimist=require("optimist");var osenv=require("osenv");var object=require("mout/object");var string=require("mout/string");var paths=require("./paths");var win=process.platform==="win32";var home=osenv.home();function rc(c,e,d,b){var a;e=e||{};d=d||process.cwd();b=b||optimist.argv;a=object.map(b.config||{},function(f){return f==="false"?false:f});return object.deepMixIn.apply(null,[{},e,{cwd:d},win?{}:json(path.join("/etc",c+"rc")),!home?{}:json(path.join(home,"."+c+"rc")),json(path.join(paths.config,c+"rc")),json(find("."+c+"rc",d)),env(c+"_"),a])}function parse(c,b){var a;if(!c.trim().length){return{}}try{return JSON.parse(c)}catch(d){if(b){a=new Error("Unable to parse "+b+": "+d.message)}else{a=new Error("Unable to parse rc config: "+d.message)}a.details=c;a.code="EMALFORMED";throw a}return null}function json(a){var c;try{c=fs.readFileSync(a).toString()}catch(b){return null}return parse(c,a)}function env(b){var c={};var a=b.length;b=b.toLowerCase();object.forOwn(process.env,function(f,d){d=d.toLowerCase();if(string.startsWith(d,b)){var e=d.substr(a).replace(/__/g,".").replace(/_/g,"-");object.set(c,e,f)}});return c}function find(b,c){var a=function(d,e){var f=path.join(e,d);var g=path.dirname(e);try{fs.statSync(f);return f}catch(h){if(g===e){return null}return a(d,g)}};c=c||process.cwd();return a(b,c)}module.exports=rc;