var _=require("lodash");var chalk=require("chalk");var Separator=require("./separator");var Choice=require("./choice");module.exports=Choices;function Choices(b,a){this.choices=_.map(b,function(c){if(c.type==="separator"){return c}return new Choice(c,a)});this.realChoices=this.choices.filter(Separator.exclude).filter(function(c){return !c.disabled});Object.defineProperty(this,"length",{get:function(){return this.choices.length},set:function(c){this.choices.length=c}});Object.defineProperty(this,"realLength",{get:function(){return this.realChoices.length},set:function(){throw new Error("Cannot set `realLength` of a Choices collection")}});this.pointer=0;this.lastIndex=0}Choices.prototype.getChoice=function(a){if(_.isNumber(a)){return this.realChoices[a]}return undefined};Choices.prototype.get=function(a){if(_.isNumber(a)){return this.choices[a]}return undefined};Choices.prototype.where=function(a){return _.where(this.realChoices,a)};Choices.prototype.pluck=function(a){return _.pluck(this.realChoices,a)};Choices.prototype.forEach=function(){return this.choices.forEach.apply(this.choices,arguments)};Choices.prototype.filter=function(){return this.choices.filter.apply(this.choices,arguments)};Choices.prototype.push=function(){var a=_.map(arguments,function(b){return new Choice(b)});this.choices.push.apply(this.choices,a);this.realChoices=this.choices.filter(Separator.exclude);return this.choices};Choices.prototype.render=function(){return this.renderingMethod.apply(this,arguments)};Choices.prototype.setRender=function(a){this.renderingMethod=(this.choices.length>9)?this.paginateOutput(a):a};Choices.prototype.paginateOutput=function(b){var a=7;return function(h){var d=b.apply(this,arguments);var c=d.split("\n");if(c.length<=a){return d}if(this.pointer<3&&this.lastIndex<h&&h-this.lastIndex<9){this.pointer=Math.min(3,this.pointer+h-this.lastIndex)}this.lastIndex=h;var f=_.flatten([c,c,c]);var e=Math.max(0,h+c.length-this.pointer);var g=f.splice(e,a).join("\n");return g+"\n"+chalk.dim("(Move up and down to reveal more choices)")}.bind(this)};