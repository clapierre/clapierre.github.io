var fs=require("graceful-fs");var path=require("path");var deepExtend=require("deep-extend");var isComponent=require("./util/isComponent");var createError=require("./util/createError");var possibleJsons=["bower.json","component.json",".bower.json"];function read(b,a,c){if(typeof a==="function"){c=a;a={}}fs.stat(b,function(e,d){if(e){return c(e)}if(d.isDirectory()){return find(b,function(g,f){if(g){return c(g)}read(f,a,c)})}fs.readFile(b,function(h,g){var f;if(h){return c(h)}try{f=JSON.parse(g.toString())}catch(h){h.file=path.resolve(b);h.code="EMALFORMED";return c(h)}try{f=parse(f,a)}catch(h){h.file=path.resolve(b);return c(h)}c(null,f,b)})})}function parse(b,a){a=deepExtend({normalize:false,validate:true,clone:false},a||{});if(a.clone){b=deepExtend({},b)}if(a.validate){validate(b)}if(a.normalize){normalize(b)}return b}function validate(a){if(!a.name){throw createError("No name property set","EINVALID")}return a}function normalize(a){if(typeof a.main==="string"){a.main=a.main.split(",")}return a}function find(d,c,e){var b;var a;if(typeof c==="function"){e=c;c=possibleJsons}if(!c.length){b=createError("None of "+possibleJsons.join(", ")+" were found in "+d,"ENOENT");return e(b)}a=path.resolve(path.join(d,c[0]));fs.exists(a,function(f){if(!f){return find(d,c.slice(1),e)}if(c[0]!=="component.json"){return e(null,a)}isComponent(a,function(g){if(g){return find(d,c.slice(1),e)}e(null,a)})})}module.exports=read;module.exports.read=read;module.exports.parse=parse;module.exports.validate=validate;module.exports.normalize=normalize;module.exports.find=find;