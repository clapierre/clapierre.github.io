"use strict";var throttle=require("throttleit");function requestProgress(e,j){var c;var f;var b;var d;var i;var h;var g=0;var a={};j=j||{};j.throttle=j.throttle==null?1000:j.throttle;j.delay=j.delay||0;c=throttle(function(){if(h===g){return}h=g;a.received=g;a.percent=i?Math.round(g/i*100):null;e.emit("progress",a)},j.throttle);f=function(k){i=Number(k.headers["content-length"]);g=0;a.totalSize=i||null;d=false;b=setTimeout(function(){d=true;b=null},j.delay)};e.on("request",function(){g=0}).on("response",f).on("data",function(k){g+=k.length;if(d){c()}}).on("end",function(){if(b){clearTimeout(b);b=null}});if(e.response){f(e.response)}return e}module.exports=requestProgress;