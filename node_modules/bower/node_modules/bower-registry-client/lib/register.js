var parseUrl=require("url").parse;var request=require("request");var createError=require("./util/createError");function register(c,b,g){var a=this._config;var d=a.registry.register+"/packages";var e=parseUrl(d);var f={};if(a.userAgent){f["User-Agent"]=a.userAgent}if(a.accessToken){d+="?access_token="+a.accessToken}request.post({url:d,proxy:e.protocol==="https:"?a.httpsProxy:a.proxy,headers:f,ca:a.ca.register,strictSSL:a.strictSsl,timeout:a.timeout,json:true,form:{name:c,url:b}},function(i,h){if(i){return g(createError("Request to "+d+" failed: "+i.message,i.code))}if(h.statusCode===403){return g(createError("Duplicate package","EDUPLICATE"))}if(h.statusCode===400){return g(createError("Invalid URL format","EINVFORMAT"))}if(h.statusCode!==201){return g(createError("Unknown error: "+h.statusCode+" - "+h.body,"EUNKNOWN"))}g(null,{name:c,url:b})})}module.exports=register;