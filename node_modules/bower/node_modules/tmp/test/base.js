var assert=require("assert"),path=require("path"),exec=require("child_process").exec;function _spawnTestWithError(b,c,a){_spawnTest(true,b,c,a)}function _spawnTestWithoutError(b,c,a){_spawnTest(false,b,c,a)}function _spawnTest(h,b,g,a){var d,e=process.argv[0],f=[e,path.join(__dirname,b)].concat(g).join(" ");exec(f,function c(k,i,j){if(h){if(k){return a(k)}else{if(j.length>0){return a(j.toString())}}}return a(null,i.toString())})}function _testStat(a,b){assert.equal(a.uid,process.getuid(),"should have the same UID");assert.equal(a.gid,process.getgid(),"should have the same GUID");assert.equal(a.mode,b)}function _testPrefix(b){return function a(e,c,d){assert.equal(path.basename(c).slice(0,b.length),b,"should have the provided prefix")}}function _testPostfix(b){return function a(e,c,d){assert.equal(c.slice(c.length-b.length,c.length),b,"should have the provided postfix")}}function _testKeep(c,b,a){_spawnTestWithError("keep.js",[c,b],a)}function _testGraceful(b,c,a){_spawnTestWithoutError("graceful.js",[b,c],a)}function _assertName(b,a){assert.isString(a);assert.isNotZero(a.length)}function _testUnsafeCleanup(b,a){_spawnTestWithoutError("unsafe.js",["dir",b],a)}module.exports.testStat=_testStat;module.exports.testPrefix=_testPrefix;module.exports.testPostfix=_testPostfix;module.exports.testKeep=_testKeep;module.exports.testGraceful=_testGraceful;module.exports.assertName=_assertName;module.exports.testUnsafeCleanup=_testUnsafeCleanup;