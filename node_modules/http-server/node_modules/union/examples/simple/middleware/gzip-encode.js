var spawn=require("child_process").spawn,util=require("util"),ResponseStream=require("../../lib").ResponseStream;var GzipEncode=module.exports=function GzipEncode(a){ResponseStream.call(this,a);if(compression){process.assert(compression>=1&&compression<=9);this.compression=compression}this.on("pipe",this.encode)};util.inherits(GzipEncode,ResponseStream);GzipEncode.prototype.encode=function(a){this.source=a};GzipEncode.prototype.pipe=function(a){if(!this.source){throw new Error("GzipEncode is only pipeable once it has been piped to")}this.encoder=spawn("gzip",["-"+this.compression]);this.encoder.stdout.pipe(a);this.encoder.stdin.pipe(this.source)};inherits(GzipEncoderStack,StreamStack);exports.GzipEncoderStack=GzipEncoderStack;GzipEncoderStack.prototype.compression=6;