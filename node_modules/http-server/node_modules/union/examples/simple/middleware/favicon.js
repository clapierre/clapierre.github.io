/*!
 * Connect - favicon
 * Copyright(c) 2010 Sencha Inc.
 * Copyright(c) 2011 TJ Holowaychuk
 * MIT Licensed
 */
var crypto=require("crypto"),fs=require("fs");var icon;exports.md5=function(b,a){return crypto.createHash("md5").update(b).digest(a||"hex")};module.exports=function favicon(d,b){var b=b||{},d=d||__dirname+"/../public/favicon.ico",a=b.maxAge||86400000;return function c(g,e,f){if("/favicon.ico"==g.url){if(icon){e.writeHead(200,icon.headers);e.end(icon.body)}else{fs.readFile(d,function(i,h){if(i){return f(i)}icon={headers:{"Content-Type":"image/x-icon","Content-Length":h.length,ETag:'"'+exports.md5(h)+'"',"Cache-Control":"public, max-age="+(a/1000)},body:h};e.writeHead(200,icon.headers);e.end(icon.body)})}}else{f()}}};