define(["./core","./var/rnotwhite","./ajax/var/nonce","./ajax/var/rquery","./core/init","./ajax/parseJSON","./ajax/parseXML","./deferred"],function(n,q,r,h){var i,v,k=/#.*$/,c=/([?&])_=[^&]*/,a=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,d=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,g=/^(?:GET|HEAD)$/,j=/^\/\//,f=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,w={},u={},l="*/".concat("*");try{v=location.href}catch(s){v=document.createElement("a");v.href="";v=v.href}i=f.exec(v.toLowerCase())||[];function m(e){return function(A,B){if(typeof A!=="string"){B=A;A="*"}var x,y=0,z=A.toLowerCase().match(q)||[];if(n.isFunction(B)){while((x=z[y++])){if(x.charAt(0)==="+"){x=x.slice(1)||"*";(e[x]=e[x]||[]).unshift(B)}else{(e[x]=e[x]||[]).push(B)}}}}}function p(e,y,C,z){var x={},A=(e===u);function B(D){var E;x[D]=true;n.each(e[D]||[],function(G,F){var H=F(y,C,z);if(typeof H==="string"&&!A&&!x[H]){y.dataTypes.unshift(H);B(H);return false}else{if(A){return !(E=H)}}});return E}return B(y.dataTypes[0])||!x["*"]&&B("*")}function o(y,z){var e,x,A=n.ajaxSettings.flatOptions||{};for(x in z){if(z[x]!==undefined){(A[x]?y:(e||(e={})))[x]=z[x]}}if(e){n.extend(true,y,e)}return y}function t(E,D,A){var e,z,y,B,x=E.contents,C=E.dataTypes;while(C[0]==="*"){C.shift();if(z===undefined){z=E.mimeType||D.getResponseHeader("Content-Type")}}if(z){for(B in x){if(x[B]&&x[B].test(z)){C.unshift(B);break}}}if(C[0] in A){y=C[0]}else{for(B in A){if(!C[0]||E.converters[B+" "+C[0]]){y=B;break}if(!e){e=B}}y=y||e}if(y){if(y!==C[0]){C.unshift(y)}return A[y]}}function b(I,A,F,y){var x,D,G,B,z,H={},E=I.dataTypes.slice();if(E[1]){for(G in I.converters){H[G.toLowerCase()]=I.converters[G]}}D=E.shift();while(D){if(I.responseFields[D]){F[I.responseFields[D]]=A}if(!z&&y&&I.dataFilter){A=I.dataFilter(A,I.dataType)}z=D;D=E.shift();if(D){if(D==="*"){D=z}else{if(z!=="*"&&z!==D){G=H[z+" "+D]||H["* "+D];if(!G){for(x in H){B=x.split(" ");if(B[1]===D){G=H[z+" "+B[0]]||H["* "+B[0]];if(G){if(G===true){G=H[x]}else{if(H[x]!==true){D=B[0];E.unshift(B[1])}}break}}}}if(G!==true){if(G&&I["throws"]){A=G(A)}else{try{A=G(A)}catch(C){return{state:"parsererror",error:G?C:"No conversion from "+z+" to "+D}}}}}}}}return{state:"success",data:A}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:v,type:"GET",isLocal:d.test(i[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":l,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(x,e){return e?o(o(x,n.ajaxSettings),e):o(n.ajaxSettings,x)},ajaxPrefilter:m(w),ajaxTransport:m(u),ajax:function(B,y){if(typeof B==="object"){y=B;B=undefined}y=y||{};var K,M,C,R,G,x,N,z,F=n.ajaxSetup({},y),T=F.context||F,I=F.context&&(T.nodeType||T.jquery)?n(T):n.event,S=n.Deferred(),P=n.Callbacks("once memory"),D=F.statusCode||{},J={},Q={},A=0,E="canceled",L={readyState:0,getResponseHeader:function(U){var e;if(A===2){if(!z){z={};while((e=a.exec(R))){z[e[1].toLowerCase()]=e[2]}}e=z[U.toLowerCase()]}return e==null?null:e},getAllResponseHeaders:function(){return A===2?R:null},setRequestHeader:function(U,V){var e=U.toLowerCase();if(!A){U=Q[e]=Q[e]||U;J[U]=V}return this},overrideMimeType:function(e){if(!A){F.mimeType=e}return this},statusCode:function(U){var e;if(U){if(A<2){for(e in U){D[e]=[D[e],U[e]]}}else{L.always(U[L.status])}}return this},abort:function(U){var e=U||E;if(N){N.abort(e)}H(0,e);return this}};S.promise(L).complete=P.add;L.success=L.done;L.error=L.fail;F.url=((B||F.url||v)+"").replace(k,"").replace(j,i[1]+"//");F.type=y.method||y.type||F.method||F.type;F.dataTypes=n.trim(F.dataType||"*").toLowerCase().match(q)||[""];if(F.crossDomain==null){K=f.exec(F.url.toLowerCase());F.crossDomain=!!(K&&(K[1]!==i[1]||K[2]!==i[2]||(K[3]||(K[1]==="http:"?"80":"443"))!==(i[3]||(i[1]==="http:"?"80":"443"))))}if(F.data&&F.processData&&typeof F.data!=="string"){F.data=n.param(F.data,F.traditional)}p(w,F,y,L);if(A===2){return L}x=n.event&&F.global;if(x&&n.active++===0){n.event.trigger("ajaxStart")}F.type=F.type.toUpperCase();F.hasContent=!g.test(F.type);C=F.url;if(!F.hasContent){if(F.data){C=(F.url+=(h.test(C)?"&":"?")+F.data);delete F.data}if(F.cache===false){F.url=c.test(C)?C.replace(c,"$1_="+r++):C+(h.test(C)?"&":"?")+"_="+r++}}if(F.ifModified){if(n.lastModified[C]){L.setRequestHeader("If-Modified-Since",n.lastModified[C])}if(n.etag[C]){L.setRequestHeader("If-None-Match",n.etag[C])}}if(F.data&&F.hasContent&&F.contentType!==false||y.contentType){L.setRequestHeader("Content-Type",F.contentType)}L.setRequestHeader("Accept",F.dataTypes[0]&&F.accepts[F.dataTypes[0]]?F.accepts[F.dataTypes[0]]+(F.dataTypes[0]!=="*"?", "+l+"; q=0.01":""):F.accepts["*"]);for(M in F.headers){L.setRequestHeader(M,F.headers[M])}if(F.beforeSend&&(F.beforeSend.call(T,L,F)===false||A===2)){return L.abort()}E="abort";for(M in {success:1,error:1,complete:1}){L[M](F[M])}N=p(u,F,y,L);if(!N){H(-1,"No Transport")}else{L.readyState=1;if(x){I.trigger("ajaxSend",[L,F])}if(F.async&&F.timeout>0){G=setTimeout(function(){L.abort("timeout")},F.timeout)}try{A=1;N.send(J,H)}catch(O){if(A<2){H(-1,O)}else{throw O}}}function H(Y,U,Z,W){var e,ac,aa,X,ab,V=U;if(A===2){return}A=2;if(G){clearTimeout(G)}N=undefined;R=W||"";L.readyState=Y>0?4:0;e=Y>=200&&Y<300||Y===304;if(Z){X=t(F,L,Z)}X=b(F,X,L,e);if(e){if(F.ifModified){ab=L.getResponseHeader("Last-Modified");if(ab){n.lastModified[C]=ab}ab=L.getResponseHeader("etag");if(ab){n.etag[C]=ab}}if(Y===204||F.type==="HEAD"){V="nocontent"}else{if(Y===304){V="notmodified"}else{V=X.state;ac=X.data;aa=X.error;e=!aa}}}else{aa=V;if(Y||!V){V="error";if(Y<0){Y=0}}}L.status=Y;L.statusText=(U||V)+"";if(e){S.resolveWith(T,[ac,V,L])}else{S.rejectWith(T,[L,V,aa])}L.statusCode(D);D=undefined;if(x){I.trigger(e?"ajaxSuccess":"ajaxError",[L,F,e?ac:aa])}P.fireWith(T,[L,V]);if(x){I.trigger("ajaxComplete",[L,F]);if(!(--n.active)){n.event.trigger("ajaxStop")}}}return L},getJSON:function(e,x,y){return n.get(e,x,y,"json")},getScript:function(e,x){return n.get(e,undefined,x,"script")}});n.each(["get","post"],function(e,x){n[x]=function(y,A,B,z){if(n.isFunction(A)){z=z||B;B=A;A=undefined}return n.ajax({url:y,type:x,dataType:z,data:A,success:B})}});return n});