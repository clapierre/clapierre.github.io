function XMLWriter(b,a){if(b){this.encoding=b}if(a){this.version=a}}(function(){XMLWriter.prototype={encoding:"ISO-8859-1",version:"1.0",formatting:"indented",indentChar:"\t",indentation:1,newLine:"\n",writeStartDocument:function(f){this.close();this.stack=[];this.standalone=f},writeEndDocument:function(){this.active=this.root;this.stack=[]},writeDocType:function(f){this.doctype=f},writeStartElement:function(f,g){if(g){f=g+":"+f}var h={n:f,a:{},c:[]};if(this.active){this.active.c.push(h);this.stack.push(this.active)}else{this.root=h}this.active=h},deleteEndElement:function(){this.stack.pop();this.active.c.pop()},writeEndElement:function(){this.active=this.stack.pop()||this.root},writeAttributeString:function(f,g){if(this.active){this.active.a[f]=a(g)}},writeRawAttributeString:function(f,g){if(this.active){this.active.a[f]=g}},writeString:function(f){if(this.active){this.active.c.push(c(f))}},writeXML:function(f){if(this.active){this.active.c.push(f)}},writeElementString:function(f,h,g){this.writeStartElement(f,g);this.writeString(h);this.writeEndElement()},writeCDATA:function(f){f=f.replace(/>>]/g,"]]><![CDATA[>");this.writeString("<![CDATA["+f+"]]>")},writeComment:function(f){this.writeString("<!-- "+f+" -->")},flush:function(){if(this.stack&&this.stack[0]){this.writeEndDocument()}var j="",f="",i=this.indentation,h=this.formatting.toLowerCase()=="indented",g='<?xml version="'+this.version+'" encoding="'+this.encoding+'"';if(this.standalone!==undefined){g+=' standalone="'+(this.standalone?"yes":"no")+'" '}g+=" ?>";g=[g];if(this.doctype&&this.root){g.push("<!DOCTYPE "+this.root.n+" "+this.doctype+">")}if(h){while(i--){j+=this.indentChar}}if(this.root){d(this.root,f,j,g)}return g.join(h?this.newLine:"")},close:function(){if(this.root){b(this.root)}this.active=this.root=this.stack=null},getDocument:window.ActiveXObject?function(){var f=new ActiveXObject("Microsoft.XMLDOM");f.async=false;f.loadXML(this.flush());return f}:function(){return(new DOMParser()).parseFromString(this.flush(),"text/xml")}};var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","\t":"&#9;","\n":"&#10;","\r":"&#13;"};function c(f){return f.replace(/[&<>"]/g,function(g){return e[g]})}function a(f){return String(f).replace(/[&<>"\n\r\t]/g,function(g){return e[g]})}function b(g){var f=g.c.length;while(f--){if(typeof g.c[f]=="object"){b(g.c[f])}}g.n=g.a=g.c=null}function d(h,g,j,k){var n=g+"<"+h.n,m=h.c.length,o,f,l=0;for(o in h.a){n+=" "+o+'="'+h.a[o]+'"'}n+=m?">":" />";k.push(n);if(m){do{f=h.c[l++];if(typeof f=="string"){if(m==1){return k.push(k.pop()+f+"</"+h.n+">")}else{k.push(g+j+f)}}else{if(typeof f=="object"){d(f,g+j,j,k)}}}while(l<m);k.push(g+"</"+h.n+">")}}})();