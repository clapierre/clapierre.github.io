/*!
 * jsTree {{VERSION}}
 * http://jstree.com/
 *
 * Copyright (c) 2014 Ivan Bozhanov (http://vakata.com)
 *
 * Licensed same as jquery - under the terms of the MIT License
 *   http://www.opensource.org/licenses/mit-license.php
 */
/*!
 * if using jslint please allow for the jQuery global and use following options:
 * jslint: browser: true, ass: true, bitwise: true, continue: true, nomen: true, plusplus: true, regexp: true, unparam: true, todo: true, white: true
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){a(require("jquery"))}else{a(jQuery)}}}(function(g,d){if(g.jstree){return}var b=0,c=false,i=false,h=false,j=[],a=g("script:last").attr("src"),k=window.document,l=k.createElement("LI"),f,e;l.setAttribute("role","treeitem");f=k.createElement("I");f.className="jstree-icon jstree-ocl";f.setAttribute("role","presentation");l.appendChild(f);f=k.createElement("A");f.className="jstree-anchor";f.setAttribute("href","#");f.setAttribute("tabindex","-1");e=k.createElement("I");e.className="jstree-icon jstree-themeicon";e.setAttribute("role","presentation");f.appendChild(e);l.appendChild(f);f=e=null;g.jstree={version:"{{VERSION}}",defaults:{plugins:[]},plugins:{},path:a&&a.indexOf("/")!==-1?a.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g};g.jstree.create=function(p,m){var o=new g.jstree.core(++b),n=m;m=g.extend(true,{},g.jstree.defaults,m);if(n&&n.plugins){m.plugins=n.plugins}g.each(m.plugins,function(r,q){if(r!=="core"){o=o.plugin(q,m[q])}});g(p).data("jstree",o);o.init(p,m);return o};g.jstree.destroy=function(){g(".jstree:jstree").jstree("destroy");g(k).off(".jstree")};g.jstree.core=function(m){this._id=m;this._cnt=0;this._wrk=null;this._data={core:{themes:{name:false,dots:false,icons:false},selected:[],last_error:{},working:false,worker_queue:[],focused:null}}};g.jstree.reference=function(o){var m=null,n=null;if(o&&o.id&&(!o.tagName||!o.nodeType)){o=o.id}if(!n||!n.length){try{n=g(o)}catch(p){}}if(!n||!n.length){try{n=g("#"+o.replace(g.jstree.idregex,"\\$&"))}catch(p){}}if(n&&n.length&&(n=n.closest(".jstree")).length&&(n=n.data("jstree"))){m=n}else{g(".jstree").each(function(){var q=g(this).data("jstree");if(q&&q._model.data[o]){m=q;return false}})}return m};g.fn.jstree=function(n){var p=(typeof n==="string"),o=Array.prototype.slice.call(arguments,1),m=null;if(n===true&&!this.length){return false}this.each(function(){var q=g.jstree.reference(this),r=p&&q?q[n]:null;m=p&&r?r.apply(q,o):null;if(!q&&!p&&(n===d||g.isPlainObject(n))){g.jstree.create(this,n)}if((q&&!p)||n===true){m=q||false}if(m!==null&&m!==d){return false}});return m!==null&&m!==d?m:this};g.expr[":"].jstree=g.expr.createPseudo(function(m){return function(n){return g(n).hasClass("jstree")&&g(n).data("jstree")!==d}});g.jstree.defaults.core={data:false,strings:false,check_callback:false,error:g.noop,animation:200,multiple:true,themes:{name:false,url:false,dir:false,dots:true,icons:true,stripes:false,variant:false,responsive:false},expand_selected_onload:true,worker:true,force_text:false,dblclick_toggle:true};g.jstree.core.prototype={plugin:function(o,n){var m=g.jstree.plugins[o];if(m){this._data[o]={};m.prototype=this;return new m(n,this)}return this},init:function(n,m){this._model={data:{"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:false}}},changed:[],force_full_redraw:false,redraw_timeout:false,default_state:{loaded:true,opened:false,selected:false,disabled:false}};this.element=g(n).addClass("jstree jstree-"+this._id);this.settings=m;this._data.core.ready=false;this._data.core.loaded=false;this._data.core.rtl=(this.element.css("direction")==="rtl");this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl");this.element.attr("role","tree");if(this.settings.core.multiple){this.element.attr("aria-multiselectable",true)}if(!this.element.attr("tabindex")){this.element.attr("tabindex","0")}this.bind();this.trigger("init");this._data.core.original_container_html=this.element.find(" > ul > li").clone(true);this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return this.nodeType===3&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove();this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading");this._data.core.li_height=this.get_container_ul().children("li").first().height()||24;this.trigger("loading");this.load_node("#")},destroy:function(m){if(this._wrk){try{window.URL.revokeObjectURL(this._wrk);this._wrk=null}catch(n){}}if(!m){this.element.empty()}this.teardown()},teardown:function(){this.unbind();this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});this.element=null},bind:function(){var n="",m=null,o=0;this.element.on("dblclick.jstree",function(){if(k.selection&&k.selection.empty){k.selection.empty()}else{if(window.getSelection){var p=window.getSelection();try{p.removeAllRanges();p.collapse()}catch(q){}}}}).on("mousedown.jstree",g.proxy(function(p){if(p.target===this.element[0]){p.preventDefault();o=+(new Date())}},this)).on("mousedown.jstree",".jstree-ocl",function(p){p.preventDefault()}).on("click.jstree",".jstree-ocl",g.proxy(function(p){this.toggle_node(p.target)},this)).on("dblclick.jstree",".jstree-anchor",g.proxy(function(p){if(this.settings.core.dblclick_toggle){this.toggle_node(p.target)}},this)).on("click.jstree",".jstree-anchor",g.proxy(function(p){p.preventDefault();if(p.currentTarget!==k.activeElement){g(p.currentTarget).focus()}this.activate_node(p.currentTarget,p)},this)).on("keydown.jstree",".jstree-anchor",g.proxy(function(p){if(p.target.tagName==="INPUT"){return true}if(p.which!==32&&p.which!==13&&(p.shiftKey||p.ctrlKey||p.altKey||p.metaKey)){return true}var q=null;if(this._data.core.rtl){if(p.which===37){p.which=39}else{if(p.which===39){p.which=37}}}switch(p.which){case 32:if(p.ctrlKey){p.type="click";g(p.currentTarget).trigger(p)}break;case 13:p.type="click";g(p.currentTarget).trigger(p);break;case 37:p.preventDefault();if(this.is_open(p.currentTarget)){this.close_node(p.currentTarget)}else{q=this.get_parent(p.currentTarget);if(q&&q.id!=="#"){this.get_node(q,true).children(".jstree-anchor").focus()}}break;case 38:p.preventDefault();q=this.get_prev_dom(p.currentTarget);if(q&&q.length){q.children(".jstree-anchor").focus()}break;case 39:p.preventDefault();if(this.is_closed(p.currentTarget)){this.open_node(p.currentTarget,function(r){this.get_node(r,true).children(".jstree-anchor").focus()})}else{if(this.is_open(p.currentTarget)){q=this.get_node(p.currentTarget,true).children(".jstree-children")[0];if(q){g(this._firstChild(q)).children(".jstree-anchor").focus()}}}break;case 40:p.preventDefault();q=this.get_next_dom(p.currentTarget);if(q&&q.length){q.children(".jstree-anchor").focus()}break;case 106:this.open_all();break;case 36:p.preventDefault();q=this._firstChild(this.get_container_ul()[0]);if(q){g(q).children(".jstree-anchor").filter(":visible").focus()}break;case 35:p.preventDefault();this.element.find(".jstree-anchor").filter(":visible").last().focus();break}},this)).on("load_node.jstree",g.proxy(function(q,p){if(p.status){if(p.node.id==="#"&&!this._data.core.loaded){this._data.core.loaded=true;if(this._firstChild(this.get_container_ul()[0])){this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id)}this.trigger("loaded")}if(!this._data.core.ready){setTimeout(g.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){this._data.core.ready=true;if(this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var t=[],s,r;for(s=0,r=this._data.core.selected.length;s<r;s++){t=t.concat(this._model.data[this._data.core.selected[s]].parents)}t=g.vakata.array_unique(t);for(s=0,r=t.length;s<r;s++){this.open_node(t[s],false,0)}}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0)}}},this)).on("keypress.jstree",g.proxy(function(t){if(t.target.tagName==="INPUT"){return true}if(m){clearTimeout(m)}m=setTimeout(function(){n=""},500);var r=String.fromCharCode(t.which).toLowerCase(),q=this.element.find(".jstree-anchor").filter(":visible"),s=q.index(k.activeElement)||0,p=false;n+=r;if(n.length>1){q.slice(s).each(g.proxy(function(w,u){if(g(u).text().toLowerCase().indexOf(n)===0){g(u).focus();p=true;return false}},this));if(p){return}q.slice(0,s).each(g.proxy(function(w,u){if(g(u).text().toLowerCase().indexOf(n)===0){g(u).focus();p=true;return false}},this));if(p){return}}if(new RegExp("^"+r+"+$").test(n)){q.slice(s+1).each(g.proxy(function(w,u){if(g(u).text().toLowerCase().charAt(0)===r){g(u).focus();p=true;return false}},this));if(p){return}q.slice(0,s+1).each(g.proxy(function(w,u){if(g(u).text().toLowerCase().charAt(0)===r){g(u).focus();p=true;return false}},this));if(p){return}}},this)).on("init.jstree",g.proxy(function(){var p=this.settings.core.themes;this._data.core.themes.dots=p.dots;this._data.core.themes.stripes=p.stripes;this._data.core.themes.icons=p.icons;this.set_theme(p.name||"default",p.url);this.set_theme_variant(p.variant)},this)).on("loading.jstree",g.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"]();this[this._data.core.themes.icons?"show_icons":"hide_icons"]();this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",g.proxy(function(p){this._data.core.focused=null;g(p.currentTarget).filter(".jstree-hovered").mouseleave();this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",g.proxy(function(q){var p=this.get_node(q.currentTarget);if(p&&p.id){this._data.core.focused=p.id}this.element.find(".jstree-hovered").not(q.currentTarget).mouseleave();g(q.currentTarget).mouseenter();this.element.attr("tabindex","-1")},this)).on("focus.jstree",g.proxy(function(){if(+(new Date())-o>500&&!this._data.core.focused){o=0;var p=this.get_node(this.element.attr("aria-activedescendant"),true);if(p){p.find("> .jstree-anchor").focus()}}},this)).on("mouseenter.jstree",".jstree-anchor",g.proxy(function(p){this.hover_node(p.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",g.proxy(function(p){this.dehover_node(p.currentTarget)},this))},unbind:function(){this.element.off(".jstree");g(k).off(".jstree-"+this._id)},trigger:function(m,n){if(!n){n={}}n.instance=this;this.element.triggerHandler(m.replace(".jstree","")+".jstree",n)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(n){var m=this.settings.core.strings;if(g.isFunction(m)){return m.call(this,n)}if(m&&m[n]){return m[n]}return n},_firstChild:function(m){m=m?m.firstChild:null;while(m!==null&&m.nodeType!==1){m=m.nextSibling}return m},_nextSibling:function(m){m=m?m.nextSibling:null;while(m!==null&&m.nodeType!==1){m=m.nextSibling}return m},_previousSibling:function(m){m=m?m.previousSibling:null;while(m!==null&&m.nodeType!==1){m=m.previousSibling}return m},get_node:function(o,m){if(o&&o.id){o=o.id}var p;try{if(this._model.data[o]){o=this._model.data[o]}else{if(typeof o==="string"&&this._model.data[o.replace(/^#/,"")]){o=this._model.data[o.replace(/^#/,"")]}else{if(typeof o==="string"&&(p=g("#"+o.replace(g.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[p.closest(".jstree-node").attr("id")]){o=this._model.data[p.closest(".jstree-node").attr("id")]}else{if((p=g(o,this.element)).length&&this._model.data[p.closest(".jstree-node").attr("id")]){o=this._model.data[p.closest(".jstree-node").attr("id")]}else{if((p=g(o,this.element)).length&&p.hasClass("jstree")){o=this._model.data["#"]}else{return false}}}}}if(m){o=o.id==="#"?this.element:g("#"+o.id.replace(g.jstree.idregex,"\\$&"),this.element)}return o}catch(n){return false}},get_path:function(s,q,o){s=s.parents?s:this.get_node(s);if(!s||s.id==="#"||!s.parents){return false}var n,m,r=[];r.push(o?s.id:s.text);for(n=0,m=s.parents.length;n<m;n++){r.push(o?s.parents[n]:this.get_text(s.parents[n]))}r=r.reverse().slice(1);return q?r.join(q):r},get_next_dom:function(o,m){var n;o=this.get_node(o,true);if(o[0]===this.element[0]){n=this._firstChild(this.get_container_ul()[0]);while(n&&n.offsetHeight===0){n=this._nextSibling(n)}return n?g(n):false}if(!o||!o.length){return false}if(m){n=o[0];do{n=this._nextSibling(n)}while(n&&n.offsetHeight===0);return n?g(n):false}if(o.hasClass("jstree-open")){n=this._firstChild(o.children(".jstree-children")[0]);while(n&&n.offsetHeight===0){n=this._nextSibling(n)}if(n!==null){return g(n)}}n=o[0];do{n=this._nextSibling(n)}while(n&&n.offsetHeight===0);if(n!==null){return g(n)}return o.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(o,m){var n;o=this.get_node(o,true);if(o[0]===this.element[0]){n=this.get_container_ul()[0].lastChild;while(n&&n.offsetHeight===0){n=this._previousSibling(n)}return n?g(n):false}if(!o||!o.length){return false}if(m){n=o[0];do{n=this._previousSibling(n)}while(n&&n.offsetHeight===0);return n?g(n):false}n=o[0];do{n=this._previousSibling(n)}while(n&&n.offsetHeight===0);if(n!==null){o=g(n);while(o.hasClass("jstree-open")){o=o.children(".jstree-children").first().children(".jstree-node:visible:last")}return o}n=o[0].parentNode.parentNode;return n&&n.className&&n.className.indexOf("jstree-node")!==-1?g(n):false},get_parent:function(m){m=this.get_node(m);if(!m||m.id==="#"){return false}return m.parent},get_children_dom:function(m){m=this.get_node(m,true);if(m[0]===this.element[0]){return this.get_container_ul().children(".jstree-node")}if(!m||!m.length){return false}return m.children(".jstree-children").children(".jstree-node")},is_parent:function(m){m=this.get_node(m);return m&&(m.state.loaded===false||m.children.length>0)},is_loaded:function(m){m=this.get_node(m);return m&&m.state.loaded},is_loading:function(m){m=this.get_node(m);return m&&m.state&&m.state.loading},is_open:function(m){m=this.get_node(m);return m&&m.state.opened},is_closed:function(m){m=this.get_node(m);return m&&this.is_parent(m)&&!m.state.opened},is_leaf:function(m){return !this.is_parent(m)},load_node:function(q,s){var n,m,p,o,r;if(g.isArray(q)){this._load_nodes(q.slice(),s);return true}q=this.get_node(q);if(!q){if(s){s.call(this,q,false)}return false}if(q.state.loaded){q.state.loaded=false;for(n=0,m=q.children_d.length;n<m;n++){for(p=0,o=q.parents.length;p<o;p++){this._model.data[q.parents[p]].children_d=g.vakata.array_remove_item(this._model.data[q.parents[p]].children_d,q.children_d[n])}if(this._model.data[q.children_d[n]].state.selected){r=true;this._data.core.selected=g.vakata.array_remove_item(this._data.core.selected,q.children_d[n])}delete this._model.data[q.children_d[n]]}q.children=[];q.children_d=[];if(r){this.trigger("changed",{action:"load_node",node:q,selected:this._data.core.selected})}}q.state.failed=false;q.state.loading=true;this.get_node(q,true).addClass("jstree-loading").attr("aria-busy",true);this._load_node(q,g.proxy(function(t){q=this._model.data[q.id];q.state.loading=false;q.state.loaded=t;q.state.failed=!q.state.loaded;var u=this.get_node(q,true);if(q.state.loaded&&!q.children.length&&u&&u.length&&!u.hasClass("jstree-leaf")){u.removeClass("jstree-closed jstree-open").addClass("jstree-leaf")}u.removeClass("jstree-loading").attr("aria-busy",false);this.trigger("load_node",{node:q,status:t});if(s){s.call(this,q,t)}},this));return true},_load_nodes:function(o,w,v){var n=true,u=function(){this._load_nodes(o,w,true)},p=this._model.data,t,q,s=[];for(t=0,q=o.length;t<q;t++){if(p[o[t]]&&((!p[o[t]].state.loaded&&!p[o[t]].state.failed)||!v)){if(!this.is_loading(o[t])){this.load_node(o[t],u)}n=false}}if(n){for(t=0,q=o.length;t<q;t++){if(p[o[t]]&&p[o[t]].state.loaded){s.push(o[t])}}if(w&&!w.done){w.call(this,s);w.done=true}}},load_all:function(r,t){if(!r){r="#"}r=this.get_node(r);if(!r){return false}var q=[],n=this._model.data,s=n[r.id].children_d,p,o;if(r.state&&!r.state.loaded){q.push(r.id)}for(p=0,o=s.length;p<o;p++){if(n[s[p]]&&n[s[p]].state&&!n[s[p]].state.loaded){q.push(s[p])}}if(q.length){this._load_nodes(q,function(){this.load_all(r,t)})}else{if(t){t.call(this,r)}this.trigger("load_all",{node:r})}},_load_node:function(o,p){var n=this.settings.core.data,m;if(!n){if(o.id==="#"){return this._append_html_data(o,this._data.core.original_container_html.clone(true),function(q){p.call(this,q)})}else{return p.call(this,false)}}if(g.isFunction(n)){return n.call(this,o,g.proxy(function(q){if(q===false){p.call(this,false)}this[typeof q==="string"?"_append_html_data":"_append_json_data"](o,typeof q==="string"?g(g.parseHTML(q)).filter(function(){return this.nodeType!==3}):q,function(r){p.call(this,r)})},this))}if(typeof n==="object"){if(n.url){n=g.extend(true,{},n);if(g.isFunction(n.url)){n.url=n.url.call(this,o)}if(g.isFunction(n.data)){n.data=n.data.call(this,o)}return g.ajax(n).done(g.proxy(function(u,r,q){var s=q.getResponseHeader("Content-Type");if((s&&s.indexOf("json")!==-1)||typeof u==="object"){return this._append_json_data(o,u,function(t){p.call(this,t)})}if((s&&s.indexOf("html")!==-1)||typeof u==="string"){return this._append_html_data(o,g(g.parseHTML(u)).filter(function(){return this.nodeType!==3}),function(t){p.call(this,t)})}this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:o.id,xhr:q})};this.settings.core.error.call(this,this._data.core.last_error);return p.call(this,false)},this)).fail(g.proxy(function(q){p.call(this,false);this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:o.id,xhr:q})};this.settings.core.error.call(this,this._data.core.last_error)},this))}m=(g.isArray(n)||g.isPlainObject(n))?JSON.parse(JSON.stringify(n)):n;if(o.id==="#"){return this._append_json_data(o,m,function(q){p.call(this,q)})}else{this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:o.id})};this.settings.core.error.call(this,this._data.core.last_error);return p.call(this,false)}}if(typeof n==="string"){if(o.id==="#"){return this._append_html_data(o,g(g.parseHTML(n)).filter(function(){return this.nodeType!==3}),function(q){p.call(this,q)})}else{this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:o.id})};this.settings.core.error.call(this,this._data.core.last_error);return p.call(this,false)}}return p.call(this,false)},_node_changed:function(m){m=this.get_node(m);if(m){this._model.changed.push(m.id)}},_append_html_data:function(t,w,q){t=this.get_node(t);t.children=[];t.children_d=[];var z=w.is("ul")?w.children():w,y=t.id,B=[],x=[],o=this._model.data,n=o[y],A=this._data.core.selected.length,v,u,r;z.each(g.proxy(function(p,m){v=this._parse_model_from_html(g(m),y,n.parents.concat());if(v){B.push(v);x.push(v);if(o[v].children_d.length){x=x.concat(o[v].children_d)}}},this));n.children=B;n.children_d=x;for(u=0,r=n.parents.length;u<r;u++){o[n.parents[u]].children_d=o[n.parents[u]].children_d.concat(x)}this.trigger("model",{nodes:x,parent:y});if(y!=="#"){this._node_changed(y);this.redraw()}else{this.get_container_ul().children(".jstree-initial-node").remove();this.redraw(true)}if(this._data.core.selected.length!==A){this.trigger("changed",{action:"model",selected:this._data.core.selected})}q.call(this,true)},_append_json_data:function(o,p,n,q){if(this.element===null){return}o=this.get_node(o);o.children=[];o.children_d=[];if(p.d){p=p.d;if(typeof p==="string"){p=JSON.parse(p)}}if(!g.isArray(p)){p=[p]}var u=null,s={df:this._model.default_state,dat:p,par:o.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},m=function(N,w){if(N.data){N=N.data}var I=N.dat,B=N.par,v=[],x=[],C=[],J=N.df,z=N.t_id,A=N.t_cnt,E=N.m,D=E[B],F=N.sel,L,H,G,K,M=function(V,P,O){if(!O){O=[]}else{O=O.concat()}if(P){O.unshift(P)}var Q=V.id.toString(),T,R,W,U,S={id:Q,text:V.text||"",icon:V.icon!==w?V.icon:true,parent:P,parents:O,children:V.children||[],children_d:V.children_d||[],data:V.data,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(T in J){if(J.hasOwnProperty(T)){S.state[T]=J[T]}}if(V&&V.data&&V.data.jstree&&V.data.jstree.icon){S.icon=V.data.jstree.icon}if(S.icon===w||S.icon===null||S.icon===""){S.icon=true}if(V&&V.data){S.data=V.data;if(V.data.jstree){for(T in V.data.jstree){if(V.data.jstree.hasOwnProperty(T)){S.state[T]=V.data.jstree[T]}}}}if(V&&typeof V.state==="object"){for(T in V.state){if(V.state.hasOwnProperty(T)){S.state[T]=V.state[T]}}}if(V&&typeof V.li_attr==="object"){for(T in V.li_attr){if(V.li_attr.hasOwnProperty(T)){S.li_attr[T]=V.li_attr[T]}}}if(!S.li_attr.id){S.li_attr.id=Q}if(V&&typeof V.a_attr==="object"){for(T in V.a_attr){if(V.a_attr.hasOwnProperty(T)){S.a_attr[T]=V.a_attr[T]}}}if(V&&V.children&&V.children===true){S.state.loaded=false;S.children=[];S.children_d=[]}E[S.id]=S;for(T=0,R=S.children.length;T<R;T++){W=M(E[S.children[T]],S.id,O);U=E[W];S.children_d.push(W);if(U.children_d.length){S.children_d=S.children_d.concat(U.children_d)}}delete V.data;delete V.children;E[S.id].original=V;if(S.state.selected){C.push(S.id)}return S.id},y=function(V,P,O){if(!O){O=[]}else{O=O.concat()}if(P){O.unshift(P)}var Q=false,T,R,W,U,S;do{Q="j"+z+"_"+(++A)}while(E[Q]);S={id:false,text:typeof V==="string"?V:"",icon:typeof V==="object"&&V.icon!==w?V.icon:true,parent:P,parents:O,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(T in J){if(J.hasOwnProperty(T)){S.state[T]=J[T]}}if(V&&V.id){S.id=V.id.toString()}if(V&&V.text){S.text=V.text}if(V&&V.data&&V.data.jstree&&V.data.jstree.icon){S.icon=V.data.jstree.icon}if(S.icon===w||S.icon===null||S.icon===""){S.icon=true}if(V&&V.data){S.data=V.data;if(V.data.jstree){for(T in V.data.jstree){if(V.data.jstree.hasOwnProperty(T)){S.state[T]=V.data.jstree[T]}}}}if(V&&typeof V.state==="object"){for(T in V.state){if(V.state.hasOwnProperty(T)){S.state[T]=V.state[T]}}}if(V&&typeof V.li_attr==="object"){for(T in V.li_attr){if(V.li_attr.hasOwnProperty(T)){S.li_attr[T]=V.li_attr[T]}}}if(S.li_attr.id&&!S.id){S.id=S.li_attr.id.toString()}if(!S.id){S.id=Q}if(!S.li_attr.id){S.li_attr.id=S.id}if(V&&typeof V.a_attr==="object"){for(T in V.a_attr){if(V.a_attr.hasOwnProperty(T)){S.a_attr[T]=V.a_attr[T]}}}if(V&&V.children&&V.children.length){for(T=0,R=V.children.length;T<R;T++){W=y(V.children[T],S.id,O);U=E[W];S.children.push(W);if(U.children_d.length){S.children_d=S.children_d.concat(U.children_d)}}S.children_d=S.children_d.concat(S.children)}if(V&&V.children&&V.children===true){S.state.loaded=false;S.children=[];S.children_d=[]}delete V.data;delete V.children;S.original=V;E[S.id]=S;if(S.state.selected){C.push(S.id)}return S.id};if(I.length&&I[0].id!==w&&I[0].parent!==w){for(H=0,G=I.length;H<G;H++){if(!I[H].children){I[H].children=[]}E[I[H].id.toString()]=I[H]}for(H=0,G=I.length;H<G;H++){E[I[H].parent.toString()].children.push(I[H].id.toString());D.children_d.push(I[H].id.toString())}for(H=0,G=D.children.length;H<G;H++){L=M(E[D.children[H]],B,D.parents.concat());x.push(L);if(E[L].children_d.length){x=x.concat(E[L].children_d)}}for(H=0,G=D.parents.length;H<G;H++){E[D.parents[H]].children_d=E[D.parents[H]].children_d.concat(x)}K={cnt:A,mod:E,sel:F,par:B,dpc:x,add:C}}else{for(H=0,G=I.length;H<G;H++){L=y(I[H],B,D.parents.concat());if(L){v.push(L);x.push(L);if(E[L].children_d.length){x=x.concat(E[L].children_d)}}}D.children=v;D.children_d=x;for(H=0,G=D.parents.length;H<G;H++){E[D.parents[H]].children_d=E[D.parents[H]].children_d.concat(x)}K={cnt:A,mod:E,sel:F,par:B,dpc:x,add:C}}if(typeof window==="undefined"||typeof window.document==="undefined"){postMessage(K)}else{return K}},t=function(x,C){if(this.element===null){return}this._cnt=x.cnt;this._model.data=x.mod;if(C){var z,y,w=x.add,B=x.sel,A=this._data.core.selected.slice(),v=this._model.data;if(B.length!==A.length||g.vakata.array_unique(B.concat(A)).length!==B.length){for(z=0,y=B.length;z<y;z++){if(g.inArray(B[z],w)===-1&&g.inArray(B[z],A)===-1){v[B[z]].state.selected=false}}for(z=0,y=A.length;z<y;z++){if(g.inArray(A[z],B)===-1){v[A[z]].state.selected=true}}}}if(x.add.length){this._data.core.selected=this._data.core.selected.concat(x.add)}this.trigger("model",{nodes:x.dpc,parent:x.par});if(x.par!=="#"){this._node_changed(x.par);this.redraw()}else{this.redraw(true)}if(x.add.length){this.trigger("changed",{action:"model",selected:this._data.core.selected})}n.call(this,true)};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker){try{if(this._wrk===null){this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+m.toString()],{type:"text/javascript"}))}if(!this._data.core.working||q){this._data.core.working=true;u=new window.Worker(this._wrk);u.onmessage=g.proxy(function(v){t.call(this,v.data,true);try{u.terminate();u=null}catch(w){}if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}},this);if(!s.par){if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}}else{u.postMessage(s)}}else{this._data.core.worker_queue.push([o,p,n,true])}}catch(r){t.call(this,m(s),false);if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}}}else{t.call(this,m(s),false)}},_parse_model_from_html:function(w,o,n){if(!n){n=[]}else{n=[].concat(n)}if(o){n.unshift(o)}var x,v,q=this._model.data,t={id:false,text:false,icon:true,parent:o,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false},u,s,r;for(u in this._model.default_state){if(this._model.default_state.hasOwnProperty(u)){t.state[u]=this._model.default_state[u]}}s=g.vakata.attributes(w,true);g.each(s,function(p,m){m=g.trim(m);if(!m.length){return true}t.li_attr[p]=m;if(p==="id"){t.id=m.toString()}});s=w.children("a").first();if(s.length){s=g.vakata.attributes(s,true);g.each(s,function(p,m){m=g.trim(m);if(m.length){t.a_attr[p]=m}})}s=w.children("a").first().length?w.children("a").first().clone():w.clone();s.children("ins, i, ul").remove();s=s.html();s=g("<div />").html(s);t.text=this.settings.core.force_text?s.text():s.html();s=w.data();t.data=s?g.extend(true,{},s):null;t.state.opened=w.hasClass("jstree-open");t.state.selected=w.children("a").hasClass("jstree-clicked");t.state.disabled=w.children("a").hasClass("jstree-disabled");if(t.data&&t.data.jstree){for(u in t.data.jstree){if(t.data.jstree.hasOwnProperty(u)){t.state[u]=t.data.jstree[u]}}}s=w.children("a").children(".jstree-themeicon");if(s.length){t.icon=s.hasClass("jstree-themeicon-hidden")?false:s.attr("rel")}if(t.state.icon!==d){t.icon=t.state.icon}if(t.icon===d||t.icon===null||t.icon===""){t.icon=true}s=w.children("ul").children("li");do{r="j"+this._id+"_"+(++this._cnt)}while(q[r]);t.id=t.li_attr.id?t.li_attr.id.toString():r;if(s.length){s.each(g.proxy(function(p,m){x=this._parse_model_from_html(g(m),t.id,n);v=this._model.data[x];t.children.push(x);if(v.children_d.length){t.children_d=t.children_d.concat(v.children_d)}},this));t.children_d=t.children_d.concat(t.children)}else{if(w.hasClass("jstree-closed")){t.state.loaded=false}}if(t.li_attr["class"]){t.li_attr["class"]=t.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")}if(t.a_attr["class"]){t.a_attr["class"]=t.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")}q[t.id]=t;if(t.state.selected){this._data.core.selected.push(t.id)}return t.id},_parse_model_from_flat_json:function(w,o,n){if(!n){n=[]}else{n=n.concat()}if(o){n.unshift(o)}var r=w.id.toString(),q=this._model.data,y=this._model.default_state,u,s,x,v,t={id:r,text:w.text||"",icon:w.icon!==d?w.icon:true,parent:o,parents:n,children:w.children||[],children_d:w.children_d||[],data:w.data,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(u in y){if(y.hasOwnProperty(u)){t.state[u]=y[u]}}if(w&&w.data&&w.data.jstree&&w.data.jstree.icon){t.icon=w.data.jstree.icon}if(t.icon===d||t.icon===null||t.icon===""){t.icon=true}if(w&&w.data){t.data=w.data;if(w.data.jstree){for(u in w.data.jstree){if(w.data.jstree.hasOwnProperty(u)){t.state[u]=w.data.jstree[u]}}}}if(w&&typeof w.state==="object"){for(u in w.state){if(w.state.hasOwnProperty(u)){t.state[u]=w.state[u]}}}if(w&&typeof w.li_attr==="object"){for(u in w.li_attr){if(w.li_attr.hasOwnProperty(u)){t.li_attr[u]=w.li_attr[u]}}}if(!t.li_attr.id){t.li_attr.id=r}if(w&&typeof w.a_attr==="object"){for(u in w.a_attr){if(w.a_attr.hasOwnProperty(u)){t.a_attr[u]=w.a_attr[u]}}}if(w&&w.children&&w.children===true){t.state.loaded=false;t.children=[];t.children_d=[]}q[t.id]=t;for(u=0,s=t.children.length;u<s;u++){x=this._parse_model_from_flat_json(q[t.children[u]],t.id,n);v=q[x];t.children_d.push(x);if(v.children_d.length){t.children_d=t.children_d.concat(v.children_d)}}delete w.data;delete w.children;q[t.id].original=w;if(t.state.selected){this._data.core.selected.push(t.id)}return t.id},_parse_model_from_json:function(w,o,n){if(!n){n=[]}else{n=n.concat()}if(o){n.unshift(o)}var r=false,u,s,x,v,q=this._model.data,y=this._model.default_state,t;do{r="j"+this._id+"_"+(++this._cnt)}while(q[r]);t={id:false,text:typeof w==="string"?w:"",icon:typeof w==="object"&&w.icon!==d?w.icon:true,parent:o,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(u in y){if(y.hasOwnProperty(u)){t.state[u]=y[u]}}if(w&&w.id){t.id=w.id.toString()}if(w&&w.text){t.text=w.text}if(w&&w.data&&w.data.jstree&&w.data.jstree.icon){t.icon=w.data.jstree.icon}if(t.icon===d||t.icon===null||t.icon===""){t.icon=true}if(w&&w.data){t.data=w.data;if(w.data.jstree){for(u in w.data.jstree){if(w.data.jstree.hasOwnProperty(u)){t.state[u]=w.data.jstree[u]}}}}if(w&&typeof w.state==="object"){for(u in w.state){if(w.state.hasOwnProperty(u)){t.state[u]=w.state[u]}}}if(w&&typeof w.li_attr==="object"){for(u in w.li_attr){if(w.li_attr.hasOwnProperty(u)){t.li_attr[u]=w.li_attr[u]}}}if(t.li_attr.id&&!t.id){t.id=t.li_attr.id.toString()}if(!t.id){t.id=r}if(!t.li_attr.id){t.li_attr.id=t.id}if(w&&typeof w.a_attr==="object"){for(u in w.a_attr){if(w.a_attr.hasOwnProperty(u)){t.a_attr[u]=w.a_attr[u]}}}if(w&&w.children&&w.children.length){for(u=0,s=w.children.length;u<s;u++){x=this._parse_model_from_json(w.children[u],t.id,n);v=q[x];t.children.push(x);if(v.children_d.length){t.children_d=t.children_d.concat(v.children_d)}}t.children_d=t.children_d.concat(t.children)}if(w&&w.children&&w.children===true){t.state.loaded=false;t.children=[];t.children_d=[]}delete w.data;delete w.children;t.original=w;q[t.id]=t;if(t.state.selected){this._data.core.selected.push(t.id)}return t.id},_redraw:function(){var m=this._model.force_full_redraw?this._model.data["#"].children.concat([]):this._model.changed.concat([]),r=k.createElement("UL"),q,p,o,n=this._data.core.focused;for(p=0,o=m.length;p<o;p++){q=this.redraw_node(m[p],true,this._model.force_full_redraw);if(q&&this._model.force_full_redraw){r.appendChild(q)}}if(this._model.force_full_redraw){r.className=this.get_container_ul()[0].className;r.setAttribute("role","group");this.element.empty().append(r)}if(n!==null){q=this.get_node(n,true);if(q&&q.length&&q.children(".jstree-anchor")[0]!==k.activeElement){q.children(".jstree-anchor").focus()}else{this._data.core.focused=null}}this._model.force_full_redraw=false;this._model.changed=[];this.trigger("redraw",{nodes:m})},redraw:function(m){if(m){this._model.force_full_redraw=true}this._redraw()},draw_children:function(p){var q=this.get_node(p),o=false,n=false,m=false,r=k;if(!q){return false}if(q.id==="#"){return this.redraw(true)}p=this.get_node(p,true);if(!p||!p.length){return false}p.children(".jstree-children").remove();p=p[0];if(q.children.length&&q.state.loaded){m=r.createElement("UL");m.setAttribute("role","group");m.className="jstree-children";for(o=0,n=q.children.length;o<n;o++){m.appendChild(this.redraw_node(q.children[o],true,true))}p.appendChild(m)}},redraw_node:function(w,B,o,E){var q=this.get_node(w),v=false,p=false,n=false,C=false,A=false,z=false,G="",F=k,x=this._model.data,D=false,u=false,H=null,r=0,y=0;if(!q){return false}if(q.id==="#"){return this.redraw(true)}B=B||q.children.length===0;w=!k.querySelector?k.getElementById(q.id):this.element[0].querySelector("#"+("0123456789".indexOf(q.id[0])!==-1?"\\3"+q.id[0]+" "+q.id.substr(1).replace(g.jstree.idregex,"\\$&"):q.id.replace(g.jstree.idregex,"\\$&")));if(!w){B=true;if(!o){v=q.parent!=="#"?g("#"+q.parent.replace(g.jstree.idregex,"\\$&"),this.element)[0]:null;if(v!==null&&(!v||!x[q.parent].state.opened)){return false}p=g.inArray(q.id,v===null?x["#"].children:x[q.parent].children)}}else{w=g(w);if(!o){v=w.parent().parent()[0];if(v===this.element[0]){v=null}p=w.index()}if(!B&&q.children.length&&!w.children(".jstree-children").length){B=true}if(!B){n=w.children(".jstree-children")[0]}D=w.children(".jstree-anchor")[0]===k.activeElement;w.remove()}w=l.cloneNode(true);G="jstree-node ";for(C in q.li_attr){if(q.li_attr.hasOwnProperty(C)){if(C==="id"){continue}if(C!=="class"){w.setAttribute(C,q.li_attr[C])}else{G+=q.li_attr[C]}}}if(!q.a_attr.id){q.a_attr.id=q.id+"_anchor"}w.setAttribute("aria-selected",!!q.state.selected);w.setAttribute("aria-level",q.parents.length);w.setAttribute("aria-labelledby",q.a_attr.id);if(q.state.disabled){w.setAttribute("aria-disabled",true)}if(q.state.loaded&&!q.children.length){G+=" jstree-leaf"}else{G+=q.state.opened&&q.state.loaded?" jstree-open":" jstree-closed";w.setAttribute("aria-expanded",(q.state.opened&&q.state.loaded))}if(q.parent!==null&&x[q.parent].children[x[q.parent].children.length-1]===q.id){G+=" jstree-last"}w.id=q.id;w.className=G;G=(q.state.selected?" jstree-clicked":"")+(q.state.disabled?" jstree-disabled":"");for(A in q.a_attr){if(q.a_attr.hasOwnProperty(A)){if(A==="href"&&q.a_attr[A]==="#"){continue}if(A!=="class"){w.childNodes[1].setAttribute(A,q.a_attr[A])}else{G+=" "+q.a_attr[A]}}}if(G.length){w.childNodes[1].className="jstree-anchor "+G}if((q.icon&&q.icon!==true)||q.icon===false){if(q.icon===false){w.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden"}else{if(q.icon.indexOf("/")===-1&&q.icon.indexOf(".")===-1){w.childNodes[1].childNodes[0].className+=" "+q.icon+" jstree-themeicon-custom"}else{w.childNodes[1].childNodes[0].style.backgroundImage="url("+q.icon+")";w.childNodes[1].childNodes[0].style.backgroundPosition="center center";w.childNodes[1].childNodes[0].style.backgroundSize="auto";w.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom"}}}if(this.settings.core.force_text){w.childNodes[1].appendChild(F.createTextNode(q.text))}else{w.childNodes[1].innerHTML+=q.text}if(B&&q.children.length&&(q.state.opened||E)&&q.state.loaded){z=F.createElement("UL");z.setAttribute("role","group");z.className="jstree-children";for(C=0,A=q.children.length;C<A;C++){z.appendChild(this.redraw_node(q.children[C],B,true))}w.appendChild(z)}if(n){w.appendChild(n)}if(!o){if(!v){v=this.element[0]}for(C=0,A=v.childNodes.length;C<A;C++){if(v.childNodes[C]&&v.childNodes[C].className&&v.childNodes[C].className.indexOf("jstree-children")!==-1){H=v.childNodes[C];break}}if(!H){H=F.createElement("UL");H.setAttribute("role","group");H.className="jstree-children";v.appendChild(H)}v=H;if(p<v.childNodes.length){v.insertBefore(w,v.childNodes[p])}else{v.appendChild(w)}if(D){r=this.element[0].scrollTop;y=this.element[0].scrollLeft;w.childNodes[1].focus();this.element[0].scrollTop=r;this.element[0].scrollLeft=y}}if(q.state.opened&&!q.state.loaded){q.state.opened=false;setTimeout(g.proxy(function(){this.open_node(q.id,false,0)},this),0)}return w},open_node:function(q,s,p){var o,n,r,m;if(g.isArray(q)){q=q.slice();for(o=0,n=q.length;o<n;o++){this.open_node(q[o],s,p)}return true}q=this.get_node(q);if(!q||q.id==="#"){return false}p=p===d?this.settings.core.animation:p;if(!this.is_closed(q)){if(s){s.call(this,q,false)}return false}if(!this.is_loaded(q)){if(this.is_loading(q)){return setTimeout(g.proxy(function(){this.open_node(q,s,p)},this),500)}this.load_node(q,function(u,t){return t?this.open_node(u,s,p):(s?s.call(this,u,false):false)})}else{r=this.get_node(q,true);m=this;if(r.length){if(p&&r.children(".jstree-children").length){r.children(".jstree-children").stop(true,true)}if(q.children.length&&!this._firstChild(r.children(".jstree-children")[0])){this.draw_children(q)}if(!p){this.trigger("before_open",{node:q});r[0].className=r[0].className.replace("jstree-closed","jstree-open");r[0].setAttribute("aria-expanded",true)}else{this.trigger("before_open",{node:q});r.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",true).children(".jstree-children").stop(true,true).slideDown(p,function(){this.style.display="";m.trigger("after_open",{node:q})})}}q.state.opened=true;if(s){s.call(this,q,true)}if(!r.length){this.trigger("before_open",{node:q})}this.trigger("open_node",{node:q});if(!p||!r.length){this.trigger("after_open",{node:q})}}},_open_to:function(q){q=this.get_node(q);if(!q||q.id==="#"){return false}var n,m,o=q.parents;for(n=0,m=o.length;n<m;n+=1){if(n!=="#"){this.open_node(o[n],false,0)}}return g("#"+q.id.replace(g.jstree.idregex,"\\$&"),this.element)},close_node:function(q,p){var o,n,m,r;if(g.isArray(q)){q=q.slice();for(o=0,n=q.length;o<n;o++){this.close_node(q[o],p)}return true}q=this.get_node(q);if(!q||q.id==="#"){return false}if(this.is_closed(q)){return false}p=p===d?this.settings.core.animation:p;m=this;r=this.get_node(q,true);if(r.length){if(!p){r[0].className=r[0].className.replace("jstree-open","jstree-closed");r.attr("aria-expanded",false).children(".jstree-children").remove()}else{r.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",false).children(".jstree-children").stop(true,true).slideUp(p,function(){this.style.display="";r.children(".jstree-children").remove();m.trigger("after_close",{node:q})})}}q.state.opened=false;this.trigger("close_node",{node:q});if(!p||!r.length){this.trigger("after_close",{node:q})}},toggle_node:function(o){var n,m;if(g.isArray(o)){o=o.slice();for(n=0,m=o.length;n<m;n++){this.toggle_node(o[n])}return true}if(this.is_closed(o)){return this.open_node(o)}if(this.is_open(o)){return this.close_node(o)}},open_all:function(q,p,m){if(!q){q="#"}q=this.get_node(q);if(!q){return false}var r=q.id==="#"?this.get_container_ul():this.get_node(q,true),o,n,s;if(!r.length){for(o=0,n=q.children_d.length;o<n;o++){if(this.is_closed(this._model.data[q.children_d[o]])){this._model.data[q.children_d[o]].state.opened=true}}return this.trigger("open_all",{node:q})}m=m||r;s=this;r=this.is_closed(q)?r.find(".jstree-closed").addBack():r.find(".jstree-closed");r.each(function(){s.open_node(this,function(u,t){if(t&&this.is_parent(u)){this.open_all(u,p,m)}},p||0)});if(m.find(".jstree-closed").length===0){this.trigger("open_all",{node:this.get_node(m)})}},close_all:function(p,o){if(!p){p="#"}p=this.get_node(p);if(!p){return false}var q=p.id==="#"?this.get_container_ul():this.get_node(p,true),r=this,n,m;if(!q.length){for(n=0,m=p.children_d.length;n<m;n++){this._model.data[p.children_d[n]].state.opened=false}return this.trigger("close_all",{node:p})}q=this.is_open(p)?q.find(".jstree-open").addBack():q.find(".jstree-open");g(q.get().reverse()).each(function(){r.close_node(this,o||0)});this.trigger("close_all",{node:p})},is_disabled:function(m){m=this.get_node(m);return m&&m.state&&m.state.disabled},enable_node:function(o){var n,m;if(g.isArray(o)){o=o.slice();for(n=0,m=o.length;n<m;n++){this.enable_node(o[n])}return true}o=this.get_node(o);if(!o||o.id==="#"){return false}o.state.disabled=false;this.get_node(o,true).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",false);this.trigger("enable_node",{node:o})},disable_node:function(o){var n,m;if(g.isArray(o)){o=o.slice();for(n=0,m=o.length;n<m;n++){this.disable_node(o[n])}return true}o=this.get_node(o);if(!o||o.id==="#"){return false}o.state.disabled=true;this.get_node(o,true).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",true);this.trigger("disable_node",{node:o})},activate_node:function(t,s){if(this.is_disabled(t)){return false}this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==d?this.get_node(this._data.core.last_clicked.id):null;if(this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected){this._data.core.last_clicked=null}if(!this._data.core.last_clicked&&this._data.core.selected.length){this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])}if(!this.settings.core.multiple||(!s.metaKey&&!s.ctrlKey&&!s.shiftKey)||(s.shiftKey&&(!this._data.core.last_clicked||!this.get_parent(t)||this.get_parent(t)!==this._data.core.last_clicked.parent))){if(!this.settings.core.multiple&&(s.metaKey||s.ctrlKey||s.shiftKey)&&this.is_selected(t)){this.deselect_node(t,false,s)}else{this.deselect_all(true);this.select_node(t,false,false,s);this._data.core.last_clicked=this.get_node(t)}}else{if(s.shiftKey){var u=this.get_node(t).id,m=this._data.core.last_clicked.id,r=this.get_node(this._data.core.last_clicked.parent).children,v=false,q,n;for(q=0,n=r.length;q<n;q+=1){if(r[q]===u){v=!v}if(r[q]===m){v=!v}if(!this.is_disabled(r[q])&&(v||r[q]===u||r[q]===m)){this.select_node(r[q],true,false,s)}else{this.deselect_node(r[q],true,s)}}this.trigger("changed",{action:"select_node",node:this.get_node(t),selected:this._data.core.selected,event:s})}else{if(!this.is_selected(t)){this.select_node(t,false,false,s)}else{this.deselect_node(t,false,s)}}}this.trigger("activate_node",{node:this.get_node(t)})},hover_node:function(n){n=this.get_node(n,true);if(!n||!n.length||n.children(".jstree-hovered").length){return false}var p=this.element.find(".jstree-hovered"),m=this.element;if(p&&p.length){this.dehover_node(p)}n.children(".jstree-anchor").addClass("jstree-hovered");this.trigger("hover_node",{node:this.get_node(n)});setTimeout(function(){m.attr("aria-activedescendant",n[0].id)},0)},dehover_node:function(m){m=this.get_node(m,true);if(!m||!m.length||!m.children(".jstree-hovered").length){return false}m.children(".jstree-anchor").removeClass("jstree-hovered");this.trigger("dehover_node",{node:this.get_node(m)})},select_node:function(r,t,m,q){var s,p,n,o;if(g.isArray(r)){r=r.slice();for(p=0,n=r.length;p<n;p++){this.select_node(r[p],t,m,q)}return true}r=this.get_node(r);if(!r||r.id==="#"){return false}s=this.get_node(r,true);if(!r.state.selected){r.state.selected=true;this._data.core.selected.push(r.id);if(!m){s=this._open_to(r)}if(s&&s.length){s.attr("aria-selected",true).children(".jstree-anchor").addClass("jstree-clicked")}this.trigger("select_node",{node:r,selected:this._data.core.selected,event:q});if(!t){this.trigger("changed",{action:"select_node",node:r,selected:this._data.core.selected,event:q})}}},deselect_node:function(p,r,o){var n,m,q;if(g.isArray(p)){p=p.slice();for(n=0,m=p.length;n<m;n++){this.deselect_node(p[n],r,o)}return true}p=this.get_node(p);if(!p||p.id==="#"){return false}q=this.get_node(p,true);if(p.state.selected){p.state.selected=false;this._data.core.selected=g.vakata.array_remove_item(this._data.core.selected,p.id);if(q.length){q.attr("aria-selected",false).children(".jstree-anchor").removeClass("jstree-clicked")}this.trigger("deselect_node",{node:p,selected:this._data.core.selected,event:o});if(!r){this.trigger("changed",{action:"deselect_node",node:p,selected:this._data.core.selected,event:o})}}},select_all:function(p){var o=this._data.core.selected.concat([]),n,m;this._data.core.selected=this._model.data["#"].children_d.concat();for(n=0,m=this._data.core.selected.length;n<m;n++){if(this._model.data[this._data.core.selected[n]]){this._model.data[this._data.core.selected[n]].state.selected=true}}this.redraw(true);this.trigger("select_all",{selected:this._data.core.selected});if(!p){this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:o})}},deselect_all:function(p){var o=this._data.core.selected.concat([]),n,m;for(n=0,m=this._data.core.selected.length;n<m;n++){if(this._model.data[this._data.core.selected[n]]){this._model.data[this._data.core.selected[n]].state.selected=false}}this._data.core.selected=[];this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",false);this.trigger("deselect_all",{selected:this._data.core.selected,node:o});if(!p){this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:o})}},is_selected:function(m){m=this.get_node(m);if(!m||m.id==="#"){return false}return m.state.selected},get_selected:function(m){return m?g.map(this._data.core.selected,g.proxy(function(n){return this.get_node(n)},this)):this._data.core.selected.slice()},get_top_selected:function(r){var q=this.get_selected(true),s={},p,o,n,m;for(p=0,o=q.length;p<o;p++){s[q[p].id]=q[p]}for(p=0,o=q.length;p<o;p++){for(n=0,m=q[p].children_d.length;n<m;n++){if(s[q[p].children_d[n]]){delete s[q[p].children_d[n]]}}}q=[];for(p in s){if(s.hasOwnProperty(p)){q.push(p)}}return r?g.map(q,g.proxy(function(t){return this.get_node(t)},this)):q},get_bottom_selected:function(p){var o=this.get_selected(true),q=[],n,m;for(n=0,m=o.length;n<m;n++){if(!o[n].children.length){q.push(o[n].id)}}return p?g.map(q,g.proxy(function(r){return this.get_node(r)},this)):q},get_state:function(){var n={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},
/*!
					'themes' : {
						'name' : this.get_theme(),
						'icons' : this._data.core.themes.icons,
						'dots' : this._data.core.themes.dots
					},
					*/
selected:[]}},m;for(m in this._model.data){if(this._model.data.hasOwnProperty(m)){if(m!=="#"){if(this._model.data[m].state.opened){n.core.open.push(m)}if(this._model.data[m].state.selected){n.core.selected.push(m)}}}}return n},set_state:function(q,u){if(q){if(q.core){var p,s,o,r,m;if(q.core.open){if(!g.isArray(q.core.open)||!q.core.open.length){delete q.core.open;this.set_state(q,u)}else{this._load_nodes(q.core.open,function(n){this.open_node(n,false,0);delete q.core.open;this.set_state(q,u)},true)}return false}if(q.core.scroll){if(q.core.scroll&&q.core.scroll.left!==d){this.element.scrollLeft(q.core.scroll.left)}if(q.core.scroll&&q.core.scroll.top!==d){this.element.scrollTop(q.core.scroll.top)}delete q.core.scroll;this.set_state(q,u);return false}if(q.core.selected){r=this;this.deselect_all();g.each(q.core.selected,function(t,n){r.select_node(n,false,true)});delete q.core.selected;this.set_state(q,u);return false}for(m in q){if(q.hasOwnProperty(m)&&m!=="core"&&g.inArray(m,this.settings.plugins)===-1){delete q[m]}}if(g.isEmptyObject(q.core)){delete q.core;this.set_state(q,u);return false}}if(g.isEmptyObject(q)){q=null;if(u){u.call(this)}this.trigger("set_state");return false}return true}return false},refresh:function(n,m){this._data.core.state=m===true?{}:this.get_state();if(m&&g.isFunction(m)){this._data.core.state=m.call(this,this._data.core.state)}this._cnt=0;this._model.data={"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:false}}};var o=this.get_container_ul()[0].className;if(!n){this.element.html("<ul class='"+o+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading")}this.load_node("#",function(q,p){if(p){this.get_container_ul()[0].className=o;if(this._firstChild(this.get_container_ul()[0])){this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id)}this.set_state(g.extend(true,{},this._data.core.state),function(){this.trigger("refresh")})}this._data.core.state=null})},refresh_node:function(o){o=this.get_node(o);if(!o||o.id==="#"){return false}var p=[],m=[],n=this._data.core.selected.concat([]);m.push(o.id);if(o.state.opened===true){p.push(o.id)}this.get_node(o,true).find(".jstree-open").each(function(){p.push(this.id)});this._load_nodes(m,g.proxy(function(q){this.open_node(p,false,0);this.select_node(this._data.core.selected);this.trigger("refresh_node",{node:o,nodes:q})},this))},set_id:function(q,r){q=this.get_node(q);if(!q||q.id==="#"){return false}var p,o,n=this._model.data;r=r.toString();n[q.parent].children[g.inArray(q.id,n[q.parent].children)]=r;for(p=0,o=q.parents.length;p<o;p++){n[q.parents[p]].children_d[g.inArray(q.id,n[q.parents[p]].children_d)]=r}for(p=0,o=q.children.length;p<o;p++){n[q.children[p]].parent=r}for(p=0,o=q.children_d.length;p<o;p++){n[q.children_d[p]].parents[g.inArray(q.id,n[q.children_d[p]].parents)]=r}p=g.inArray(q.id,this._data.core.selected);if(p!==-1){this._data.core.selected[p]=r}p=this.get_node(q.id,true);if(p){p.attr("id",r).children(".jstree-anchor").attr("id",r+"_anchor").end().attr("aria-labelledby",r+"_anchor");if(this.element.attr("aria-activedescendant")===q.id){this.element.attr("aria-activedescendant",r)}}delete n[q.id];q.id=r;q.li_attr.id=r;n[r]=q;return true},get_text:function(m){m=this.get_node(m);return(!m||m.id==="#")?false:m.text},set_text:function(o,p){var n,m;if(g.isArray(o)){o=o.slice();for(n=0,m=o.length;n<m;n++){this.set_text(o[n],p)}return true}o=this.get_node(o);if(!o||o.id==="#"){return false}o.text=p;if(this.get_node(o,true).length){this.redraw_node(o.id)}this.trigger("set_text",{obj:o,text:p});return true},get_json:function(q,n,r){q=this.get_node(q||"#");if(!q){return false}if(n&&n.flat&&!r){r=[]}var p={id:q.id,text:q.text,icon:this.get_icon(q),li_attr:g.extend(true,{},q.li_attr),a_attr:g.extend(true,{},q.a_attr),state:{},data:n&&n.no_data?false:g.extend(true,{},q.data)},o,m;if(n&&n.flat){p.parent=q.parent}else{p.children=[]}if(!n||!n.no_state){for(o in q.state){if(q.state.hasOwnProperty(o)){p.state[o]=q.state[o]}}}if(n&&n.no_id){delete p.id;if(p.li_attr&&p.li_attr.id){delete p.li_attr.id}if(p.a_attr&&p.a_attr.id){delete p.a_attr.id}}if(n&&n.flat&&q.id!=="#"){r.push(p)}if(!n||!n.no_children){for(o=0,m=q.children.length;o<m;o++){if(n&&n.flat){this.get_json(q.children[o],n,r)}else{p.children.push(this.get_json(q.children[o],n))}}}return n&&n.flat?r:(q.id==="#"?p.children:p)},create_node:function(r,m,t,u,s){if(r===null){r="#"}r=this.get_node(r);if(!r){return false}t=t===d?"last":t;if(!t.toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(r)){return this.load_node(r,function(){this.create_node(r,m,t,u,true)})}if(!m){m={text:this.get_string("New node")}}if(typeof m==="string"){m={text:m}}if(m.text===d){m.text=this.get_string("New node")}var o,q,p,n;if(r.id==="#"){if(t==="before"){t="first"}if(t==="after"){t="last"}}switch(t){case"before":o=this.get_node(r.parent);t=g.inArray(r.id,o.children);r=o;break;case"after":o=this.get_node(r.parent);t=g.inArray(r.id,o.children)+1;r=o;break;case"inside":case"first":t=0;break;case"last":t=r.children.length;break;default:if(!t){t=0}break}if(t>r.children.length){t=r.children.length}if(!m.id){m.id=true}if(!this.check("create_node",m,r,t)){this.settings.core.error.call(this,this._data.core.last_error);return false}if(m.id===true){delete m.id}m=this._parse_model_from_json(m,r.id,r.parents.concat());if(!m){return false}o=this.get_node(m);q=[];q.push(m);q=q.concat(o.children_d);this.trigger("model",{nodes:q,parent:r.id});r.children_d=r.children_d.concat(q);for(p=0,n=r.parents.length;p<n;p++){this._model.data[r.parents[p]].children_d=this._model.data[r.parents[p]].children_d.concat(q)}m=o;o=[];for(p=0,n=r.children.length;p<n;p++){o[p>=t?p+1:p]=r.children[p]}o[t]=m.id;r.children=o;this.redraw_node(r,true);if(u){u.call(this,this.get_node(m))}this.trigger("create_node",{node:this.get_node(m),parent:r.id,position:t});return m.id},rename_node:function(p,q){var o,n,m;if(g.isArray(p)){p=p.slice();for(o=0,n=p.length;o<n;o++){this.rename_node(p[o],q)}return true}p=this.get_node(p);if(!p||p.id==="#"){return false}m=p.text;if(!this.check("rename_node",p,this.get_parent(p),q)){this.settings.core.error.call(this,this._data.core.last_error);return false}this.set_text(p,q);this.trigger("rename_node",{node:p,text:q,old:m});return true},delete_node:function(p){var t,s,u,w,q,r,o,n,m,v;if(g.isArray(p)){p=p.slice();for(t=0,s=p.length;t<s;t++){this.delete_node(p[t])}return true}p=this.get_node(p);if(!p||p.id==="#"){return false}u=this.get_node(p.parent);w=g.inArray(p.id,u.children);v=false;if(!this.check("delete_node",p,u,w)){this.settings.core.error.call(this,this._data.core.last_error);return false}if(w!==-1){u.children=g.vakata.array_remove(u.children,w)}q=p.children_d.concat([]);q.push(p.id);for(n=0,m=q.length;n<m;n++){for(r=0,o=p.parents.length;r<o;r++){w=g.inArray(q[n],this._model.data[p.parents[r]].children_d);if(w!==-1){this._model.data[p.parents[r]].children_d=g.vakata.array_remove(this._model.data[p.parents[r]].children_d,w)}}if(this._model.data[q[n]].state.selected){v=true;w=g.inArray(q[n],this._data.core.selected);if(w!==-1){this._data.core.selected=g.vakata.array_remove(this._data.core.selected,w)}}}this.trigger("delete_node",{node:p,parent:u.id});if(v){this.trigger("changed",{action:"delete_node",node:p,selected:this._data.core.selected,parent:u.id})}for(n=0,m=q.length;n<m;n++){delete this._model.data[q[n]]}this.redraw_node(u,true);return true},check:function(m,q,p,s,o){q=q&&q.id?q:this.get_node(q);p=p&&p.id?p:this.get_node(p);var n=m.match(/^move_node|copy_node|create_node$/i)?p:q,r=this.settings.core.check_callback;if(m==="move_node"||m==="copy_node"){if((!o||!o.is_multi)&&(q.id===p.id||g.inArray(q.id,p.children)===s||g.inArray(p.id,q.children_d)!==-1)){this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:m,pos:s,obj:q&&q.id?q.id:false,par:p&&p.id?p.id:false})};return false}}if(n&&n.data){n=n.data}if(n&&n.functions&&(n.functions[m]===false||n.functions[m]===true)){if(n.functions[m]===false){this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+m,data:JSON.stringify({chk:m,pos:s,obj:q&&q.id?q.id:false,par:p&&p.id?p.id:false})}}return n.functions[m]}if(r===false||(g.isFunction(r)&&r.call(this,m,q,p,s,o)===false)||(r&&r[m]===false)){this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+m,data:JSON.stringify({chk:m,pos:s,obj:q&&q.id?q.id:false,par:p&&p.id?p.id:false})};return false}return true},last_error:function(){return this._data.core.last_error},move_node:function(v,x,q,n,w,D,G){var t,s,u,m,F,H,o,r,E,C,B,A,z,y;x=this.get_node(x);q=q===d?0:q;if(!x){return false}if(!q.toString().match(/^(before|after)$/)&&!w&&!this.is_loaded(x)){return this.load_node(x,function(){this.move_node(v,x,q,n,true,false,G)})}if(g.isArray(v)){if(v.length===1){v=v[0]}else{for(t=0,s=v.length;t<s;t++){if((E=this.move_node(v[t],x,q,n,w,false,G))){x=E;q="after"}}this.redraw();return true}}v=v&&v.id?v:this.get_node(v);if(!v||v.id==="#"){return false}u=(v.parent||"#").toString();F=(!q.toString().match(/^(before|after)$/)||x.id==="#")?x:this.get_node(x.parent);H=G?G:(this._model.data[v.id]?this:g.jstree.reference(v.id));o=!H||!H._id||(this._id!==H._id);m=H&&H._id&&u&&H._model.data[u]&&H._model.data[u].children?g.inArray(v.id,H._model.data[u].children):-1;if(H&&H._id){v=H._model.data[v.id]}if(o){if((E=this.copy_node(v,x,q,n,w,false,G))){if(H){H.delete_node(v)}return E}return false}if(x.id==="#"){if(q==="before"){q="first"}if(q==="after"){q="last"}}switch(q){case"before":q=g.inArray(x.id,F.children);break;case"after":q=g.inArray(x.id,F.children)+1;break;case"inside":case"first":q=0;break;case"last":q=F.children.length;break;default:if(!q){q=0}break}if(q>F.children.length){q=F.children.length}if(!this.check("move_node",v,F,q,{core:true,origin:G,is_multi:(H&&H._id&&H._id!==this._id),is_foreign:(!H||!H._id)})){this.settings.core.error.call(this,this._data.core.last_error);return false}if(v.parent===F.id){r=F.children.concat();E=g.inArray(v.id,r);if(E!==-1){r=g.vakata.array_remove(r,E);if(q>E){q--}}E=[];for(C=0,B=r.length;C<B;C++){E[C>=q?C+1:C]=r[C]}E[q]=v.id;F.children=E;this._node_changed(F.id);this.redraw(F.id==="#")}else{E=v.children_d.concat();E.push(v.id);for(C=0,B=v.parents.length;C<B;C++){r=[];y=H._model.data[v.parents[C]].children_d;for(A=0,z=y.length;A<z;A++){if(g.inArray(y[A],E)===-1){r.push(y[A])}}H._model.data[v.parents[C]].children_d=r}H._model.data[u].children=g.vakata.array_remove_item(H._model.data[u].children,v.id);for(C=0,B=F.parents.length;C<B;C++){this._model.data[F.parents[C]].children_d=this._model.data[F.parents[C]].children_d.concat(E)}r=[];for(C=0,B=F.children.length;C<B;C++){r[C>=q?C+1:C]=F.children[C]}r[q]=v.id;F.children=r;F.children_d.push(v.id);F.children_d=F.children_d.concat(v.children_d);v.parent=F.id;E=F.parents.concat();E.unshift(F.id);y=v.parents.length;v.parents=E;E=E.concat();for(C=0,B=v.children_d.length;C<B;C++){this._model.data[v.children_d[C]].parents=this._model.data[v.children_d[C]].parents.slice(0,y*-1);Array.prototype.push.apply(this._model.data[v.children_d[C]].parents,E)}if(u==="#"||F.id==="#"){this._model.force_full_redraw=true}if(!this._model.force_full_redraw){this._node_changed(u);this._node_changed(F.id)}if(!D){this.redraw()}}if(n){n.call(this,v,F,q)}this.trigger("move_node",{node:v,parent:F.id,position:q,old_parent:u,old_position:m,is_multi:(H&&H._id&&H._id!==this._id),is_foreign:(!H||!H._id),old_instance:H,new_instance:this});return v.id},copy_node:function(t,v,o,n,u,z,C){var r,q,p,A,y,x,w,s,B,D,m;v=this.get_node(v);o=o===d?0:o;if(!v){return false}if(!o.toString().match(/^(before|after)$/)&&!u&&!this.is_loaded(v)){return this.load_node(v,function(){this.copy_node(t,v,o,n,true,false,C)})}if(g.isArray(t)){if(t.length===1){t=t[0]}else{for(r=0,q=t.length;r<q;r++){if((A=this.copy_node(t[r],v,o,n,u,true,C))){v=A;o="after"}}this.redraw();return true}}t=t&&t.id?t:this.get_node(t);if(!t||t.id==="#"){return false}s=(t.parent||"#").toString();B=(!o.toString().match(/^(before|after)$/)||v.id==="#")?v:this.get_node(v.parent);D=C?C:(this._model.data[t.id]?this:g.jstree.reference(t.id));m=!D||!D._id||(this._id!==D._id);if(D&&D._id){t=D._model.data[t.id]}if(v.id==="#"){if(o==="before"){o="first"}if(o==="after"){o="last"}}switch(o){case"before":o=g.inArray(v.id,B.children);break;case"after":o=g.inArray(v.id,B.children)+1;break;case"inside":case"first":o=0;break;case"last":o=B.children.length;break;default:if(!o){o=0}break}if(o>B.children.length){o=B.children.length}if(!this.check("copy_node",t,B,o,{core:true,origin:C,is_multi:(D&&D._id&&D._id!==this._id),is_foreign:(!D||!D._id)})){this.settings.core.error.call(this,this._data.core.last_error);return false}w=D?D.get_json(t,{no_id:true,no_data:true,no_state:true}):t;if(!w){return false}if(w.id===true){delete w.id}w=this._parse_model_from_json(w,B.id,B.parents.concat());if(!w){return false}A=this.get_node(w);if(t&&t.state&&t.state.loaded===false){A.state.loaded=false}p=[];p.push(w);p=p.concat(A.children_d);this.trigger("model",{nodes:p,parent:B.id});for(y=0,x=B.parents.length;y<x;y++){this._model.data[B.parents[y]].children_d=this._model.data[B.parents[y]].children_d.concat(p)}p=[];for(y=0,x=B.children.length;y<x;y++){p[y>=o?y+1:y]=B.children[y]}p[o]=A.id;B.children=p;B.children_d.push(A.id);B.children_d=B.children_d.concat(A.children_d);if(B.id==="#"){this._model.force_full_redraw=true}if(!this._model.force_full_redraw){this._node_changed(B.id)}if(!z){this.redraw(B.id==="#")}if(n){n.call(this,A,B,o)}this.trigger("copy_node",{node:A,original:t,parent:B.id,position:o,old_parent:s,old_position:D&&D._id&&s&&D._model.data[s]&&D._model.data[s].children?g.inArray(t.id,D._model.data[s].children):-1,is_multi:(D&&D._id&&D._id!==this._id),is_foreign:(!D||!D._id),old_instance:D,new_instance:this});return A.id},cut:function(q){if(!q){q=this._data.core.selected.concat()}if(!g.isArray(q)){q=[q]}if(!q.length){return false}var m=[],r,p,n;for(p=0,n=q.length;p<n;p++){r=this.get_node(q[p]);if(r&&r.id&&r.id!=="#"){m.push(r)}}if(!m.length){return false}c=m;h=this;i="move_node";this.trigger("cut",{node:q})},copy:function(q){if(!q){q=this._data.core.selected.concat()}if(!g.isArray(q)){q=[q]}if(!q.length){return false}var m=[],r,p,n;for(p=0,n=q.length;p<n;p++){r=this.get_node(q[p]);if(r&&r.id&&r.id!=="#"){m.push(r)}}if(!m.length){return false}c=m;h=this;i="copy_node";this.trigger("copy",{node:q})},get_buffer:function(){return{mode:i,node:c,inst:h}},can_paste:function(){return i!==false&&c!==false},paste:function(m,n){m=this.get_node(m);if(!m||!i||!i.match(/^(copy_node|move_node)$/)||!c){return false}if(this[i](c,m,n,false,false,false,h)){this.trigger("paste",{parent:m.id,node:c,mode:i})}c=false;i=false;h=false},clear_buffer:function(){c=false;i=false;h=false;this.trigger("clear_buffer")},edit:function(n,u,y){var r,x,v,A,z,p,o,q,m;n=this.get_node(n);if(!n){return false}if(this.settings.core.check_callback===false){this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"};this.settings.core.error.call(this,this._data.core.last_error);return false}m=n;u=typeof u==="string"?u:n.text;this.set_text(n,"");n=this._open_to(n);m.text=u;r=this._data.core.rtl;x=this.element.width();v=n.children(".jstree-anchor");A=g("<span>");
/*!
			oi = obj.children("i:visible"),
			ai = a.children("i:visible"),
			w1 = oi.width() * oi.length,
			w2 = ai.width() * ai.length,
			*/
z=u;p=g("<div />",{css:{position:"absolute",top:"-200px",left:(r?"0px":"-1000px"),visibility:"hidden"}}).appendTo("body");o=g("<input />",{value:z,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:(this._data.core.li_height)+"px",lineHeight:(this._data.core.li_height)+"px",width:"150px"},blur:g.proxy(function(){var w=A.children(".jstree-rename-input"),t=w.val(),B=this.settings.core.force_text,s;if(t===""){t=z}p.remove();A.replaceWith(v);A.remove();z=B?z:g("<div></div>").append(g.parseHTML(z)).html();this.set_text(n,z);s=!!this.rename_node(n,B?g("<div></div>").text(t).text():g("<div></div>").append(g.parseHTML(t)).html());if(!s){this.set_text(n,z)}if(y){y.call(this,m,s)}},this),keydown:function(t){var s=t.which;if(s===27){this.value=z}if(s===27||s===13||s===37||s===38||s===39||s===40||s===32){t.stopImmediatePropagation()}if(s===27||s===13){t.preventDefault();this.blur()}},click:function(s){s.stopImmediatePropagation()},mousedown:function(s){s.stopImmediatePropagation()},keyup:function(s){o.width(Math.min(p.text("pW"+this.value).width(),x))},keypress:function(s){if(s.which===13){return false}}});q={fontFamily:v.css("fontFamily")||"",fontSize:v.css("fontSize")||"",fontWeight:v.css("fontWeight")||"",fontStyle:v.css("fontStyle")||"",fontStretch:v.css("fontStretch")||"",fontVariant:v.css("fontVariant")||"",letterSpacing:v.css("letterSpacing")||"",wordSpacing:v.css("wordSpacing")||""};A.attr("class",v.attr("class")).append(v.contents().clone()).append(o);v.replaceWith(A);p.css(q);o.css(q).width(Math.min(p.text("pW"+o[0].value).width(),x))[0].select()},set_theme:function(o,m){if(!o){return false}if(m===true){var n=this.settings.core.themes.dir;if(!n){n=g.jstree.path+"/themes"}m=n+"/"+o+"/style.css"}if(m&&g.inArray(m,j)===-1){g("head").append('<link rel="stylesheet" href="'+m+'" type="text/css" />');j.push(m)}if(this._data.core.themes.name){this.element.removeClass("jstree-"+this._data.core.themes.name)}this._data.core.themes.name=o;this.element.addClass("jstree-"+o);this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+o+"-responsive");this.trigger("set_theme",{theme:o})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(m){if(this._data.core.themes.variant){this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)}this._data.core.themes.variant=m;if(m){this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)}},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=true;this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=false;this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){if(this._data.core.themes.stripes){this.hide_stripes()}else{this.show_stripes()}},show_dots:function(){this._data.core.themes.dots=true;this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=false;this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){if(this._data.core.themes.dots){this.hide_dots()}else{this.show_dots()}},show_icons:function(){this._data.core.themes.icons=true;this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=false;this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){if(this._data.core.themes.icons){this.hide_icons()}else{this.show_icons()}},set_icon:function(q,o){var p,n,r,m;if(g.isArray(q)){q=q.slice();for(p=0,n=q.length;p<n;p++){this.set_icon(q[p],o)}return true}q=this.get_node(q);if(!q||q.id==="#"){return false}m=q.icon;q.icon=o===true||o===null||o===d||o===""?true:o;r=this.get_node(q,true).children(".jstree-anchor").children(".jstree-themeicon");if(o===false){this.hide_icon(q)}else{if(o===true||o===null||o===d||o===""){r.removeClass("jstree-themeicon-custom "+m).css("background","").removeAttr("rel");if(m===false){this.show_icon(q)}}else{if(o.indexOf("/")===-1&&o.indexOf(".")===-1){r.removeClass(m).css("background","");r.addClass(o+" jstree-themeicon-custom").attr("rel",o);if(m===false){this.show_icon(q)}}else{r.removeClass(m).css("background","");r.addClass("jstree-themeicon-custom").css("background","url('"+o+"') center center no-repeat").attr("rel",o);if(m===false){this.show_icon(q)}}}}return true},get_icon:function(m){m=this.get_node(m);return(!m||m.id==="#")?false:m.icon},hide_icon:function(o){var n,m;if(g.isArray(o)){o=o.slice();for(n=0,m=o.length;n<m;n++){this.hide_icon(o[n])}return true}o=this.get_node(o);if(!o||o==="#"){return false}o.icon=false;this.get_node(o,true).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden");return true},show_icon:function(o){var n,m,p;if(g.isArray(o)){o=o.slice();for(n=0,m=o.length;n<m;n++){this.show_icon(o[n])}return true}o=this.get_node(o);if(!o||o==="#"){return false}p=this.get_node(o,true);o.icon=p.length?p.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):true;if(!o.icon){o.icon=true}p.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden");return true}};g.vakata={};g.vakata.attributes=function(n,o){n=g(n)[0];var m=o?{}:[];if(n&&n.attributes){g.each(n.attributes,function(q,p){if(g.inArray(p.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])!==-1){return}if(p.value!==null&&g.trim(p.value)!==""){if(o){m[p.name]=p.value}else{m.push(p.name)}}})}return m};g.vakata.array_unique=function(s){var n=[],q,p,m,r={};for(q=0,m=s.length;q<m;q++){if(r[s[q]]===d){n.push(s[q]);r[s[q]]=true}}return n};g.vakata.array_remove=function(p,o,n){var m=p.slice((n||o)+1||p.length);p.length=o<0?p.length+o:o;p.push.apply(p,m);return p};g.vakata.array_remove_item=function(o,n){var m=g.inArray(n,o);return m!==-1?g.vakata.array_remove(o,m):o}}));