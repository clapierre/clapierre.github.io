EquivalentXml=(function(){var o=(window.NamedNodeMap||window.MozNamedAttrMap||{});var a=function(v){return v.namespaceURI+":"+v.localName};var f=function(w,v,x){return s(w.childNodes,v.childNodes,x)};var t=function(w,v,x){return a(w)==a(v)&&j(w,v,x)};var p=function(w,v,x){return a(w)==a(v)&&w.value==v.value};var i=function(w,v,x){return w.nodeValue==v.nodeValue};var e=function(w,v,x){if(x.normalize_whitespace){return k(w.textContent).replace(/\s+/g," ")==k(v.textContent).replace(/\s+/g," ")}else{return w.nodeValue==v.nodeValue}};var u=function(v){return(v.prefix=="xmlns"||v.name=="xmlns")&&v.namespaceURI=="http://www.w3.org/2000/xmlns/"};var r=function(v){return _.sortBy(v,function(w){return[w.prefix,w.name]})};var j=function(y,w,A){var z=b(y.childNodes,A);var x=b(w.childNodes,A);var v=q(z,x,A);if(y.attributes instanceof o){var C=r(_.reject(y.attributes,u));var B=r(_.reject(w.attributes,u));v=v&&q(C,B,A)}return v};var n=function(w,x){var v=-1;_.find(x,function(A,z){var y=w===A;if(y){v=z}return y});return v};var b=function(w,v){return _.reject(w,function(x){return x instanceof Comment||(v.normalize_whitespace&&x instanceof Text&&_.isEmpty(k(x.textContent)))})};var d=function(x){if(typeof x!="string"){return undefined}var v,w;try{if(window.DOMParser){w=new DOMParser();v=w.parseFromString(x,"text/xml")}else{v=new ActiveXObject("Microsoft.XMLDOM");v.async="false";v.loadXML(x)}}catch(y){v=undefined}if(v.documentElement.childNodes[0]&&v.documentElement.childNodes[0].nodeName=="parsererror"||v.querySelector("html > body > parsererror")){v=undefined}return v};var q=function(y,w,x){if(y.length!=w.length){return false}var z=[];var v=_.all(y,function(C,A){var B=_.find(w,function(F){var E=n(F,w);var D=false;if(!_.include(z,E)){D=s(C,F,x);if(D){z.push(E)}}return D});return !!B&&(!x.element_order||x.element_order&&A==n(B,w))});return v&&z.length==w.length};var c=function(x,w,y){var v;if(_.any([x,w],h)){v=l(x)==l(w)}else{switch(x.constructor){case Document:v=f(x,w,y);break;case Element:v=t(x,w,y);break;case Attr:v=p(x,w,y);break;case Text:v=e(x,w,y);break;case CDATASection:v=i(x,w,y);break;default:v=j(x,w,y)}}return v};var m=function(v){return typeof v=="object"&&v!==null&&typeof v.nodeType=="number"};var h=function(v){return !m(v)};var g=function(v){return v instanceof NodeList||v instanceof o};var k=function(v){return v.replace(/(^\s+)|(\s+$)/g,"")};var l=function(v){if(v===null){return""}else{if(v instanceof Document){return new XMLSerializer().serializeToString(v)}else{return v.toString()}}};var s=function(w,v,x){if(_.any([w,v],g)){return q(w,v,x)}else{return c(w,v,x)}};return{isEquivalent:function(x,w,v){var y=_.clone(this.defaults);_.extend(y,v);return s(x,w,y)},xml:d,defaults:{element_order:false,normalize_whitespace:true},jasmine:{beEquivalentTo:function(w,v){var x=this.actual;this.message=function(){return"Expected "+l(x)+" to be equivalent to "+l(w)};return EquivalentXml.isEquivalent(x,w,v)}},}})();