if(!Array.prototype.map){Array.prototype.map=function(b){var a=this.length>>>0;if(typeof b!=="function"){throw new TypeError()}var e=new Array(a);var d=arguments[1];for(var c=0;c<a;c++){if(c in this){e[c]=b.call(d,this[c],c,this)}}return e}}function BigInteger(b,a){if(!(this instanceof BigInteger)){if(b instanceof BigInteger){return b}else{if(typeof b==="undefined"){return BigInteger.ZERO}}return BigInteger.parse(b)}b=b||[];while(b.length&&!b[b.length-1]){--b.length}this._d=b;this._s=b.length?(a||1):0}BigInteger.base=10000000;BigInteger.base_log10=7;BigInteger.ZERO=new BigInteger([],0);BigInteger.ONE=new BigInteger([1],1);BigInteger.M_ONE=new BigInteger(BigInteger.ONE._d,-1);BigInteger._0=BigInteger.ZERO;BigInteger._1=BigInteger.ONE;BigInteger.small=[BigInteger.ZERO,BigInteger.ONE,new BigInteger([2],1),new BigInteger([3],1),new BigInteger([4],1),new BigInteger([5],1),new BigInteger([6],1),new BigInteger([7],1),new BigInteger([8],1),new BigInteger([9],1),new BigInteger([10],1),new BigInteger([11],1),new BigInteger([12],1),new BigInteger([13],1),new BigInteger([14],1),new BigInteger([15],1),new BigInteger([16],1),new BigInteger([17],1),new BigInteger([18],1),new BigInteger([19],1),new BigInteger([20],1),new BigInteger([21],1),new BigInteger([22],1),new BigInteger([23],1),new BigInteger([24],1),new BigInteger([25],1),new BigInteger([26],1),new BigInteger([27],1),new BigInteger([28],1),new BigInteger([29],1),new BigInteger([30],1),new BigInteger([31],1),new BigInteger([32],1),new BigInteger([33],1),new BigInteger([34],1),new BigInteger([35],1),new BigInteger([36],1)];BigInteger.digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");BigInteger.prototype.toString=function(a){a=+a||10;if(a<2||a>36){throw new Error("illegal radix "+a+".")}if(this._s===0){return"0"}if(a===10){var h=this._s<0?"-":"";h+=this._d[this._d.length-1].toString();for(var f=this._d.length-2;f>=0;f--){var k=this._d[f].toString();while(k.length<BigInteger.base_log10){k="0"+k}h+=k}return h}else{var e=BigInteger.digits;a=BigInteger.small[a];var d=this._s;var c=this.abs();var b=[];var j;while(c._s!==0){var g=c.divRem(a);c=g[0];j=g[1];b.push(e[j.valueOf()])}return(d<0?"-":"")+b.reverse().join("")}};BigInteger.radixRegex=[/^$/,/^$/,/^[01]*$/,/^[012]*$/,/^[0-3]*$/,/^[0-4]*$/,/^[0-5]*$/,/^[0-6]*$/,/^[0-7]*$/,/^[0-8]*$/,/^[0-9]*$/,/^[0-9aA]*$/,/^[0-9abAB]*$/,/^[0-9abcABC]*$/,/^[0-9a-dA-D]*$/,/^[0-9a-eA-E]*$/,/^[0-9a-fA-F]*$/,/^[0-9a-gA-G]*$/,/^[0-9a-hA-H]*$/,/^[0-9a-iA-I]*$/,/^[0-9a-jA-J]*$/,/^[0-9a-kA-K]*$/,/^[0-9a-lA-L]*$/,/^[0-9a-mA-M]*$/,/^[0-9a-nA-N]*$/,/^[0-9a-oA-O]*$/,/^[0-9a-pA-P]*$/,/^[0-9a-qA-Q]*$/,/^[0-9a-rA-R]*$/,/^[0-9a-sA-S]*$/,/^[0-9a-tA-T]*$/,/^[0-9a-uA-U]*$/,/^[0-9a-vA-V]*$/,/^[0-9a-wA-W]*$/,/^[0-9a-xA-X]*$/,/^[0-9a-yA-Y]*$/,/^[0-9a-zA-Z]*$/];BigInteger.parse=function(l,a){function j(d){d=d.replace(/\s*[*xX]\s*10\s*(\^|\*\*)\s*/,"e");return d.replace(/^([+\-])?(\d+)\.?(\d*)[eE]([+\-]?\d+)$/,function(w,y,o,t,u){u=+u;var p=u<0;var q=o.length+u;w=(p?o:t).length;u=((u=Math.abs(u))>=w?u-w+p:0);var v=(new Array(u+1)).join("0");var m=o+t;return(y||"")+(p?m=v+m:m+=v).substr(0,q+=p?v.length:0)+(q<m.length?"."+m.substr(q):"")})}l=l.toString();if(typeof a==="undefined"||+a===10){l=j(l)}var g=/^([+\-]?)(0[xXcCbB])?([0-9A-Za-z]*)(?:\.\d*)?$/.exec(l);if(g){var c=g[1]||"+";var e=g[2]||"";var b=g[3]||"";if(typeof a==="undefined"){if(e==="0x"||e==="0X"){a=16}else{if(e==="0c"||e==="0C"){a=8}else{if(e==="0b"||e==="0B"){a=2}else{a=10}}}}else{if(a<2||a>36){throw new Error("Illegal radix "+a+".")}}a=+a;if(!(BigInteger.radixRegex[a].test(b))){throw new Error("Bad digit for radix "+a)}b=b.replace(/^0+/,"").split("");if(b.length===0){return BigInteger.ZERO}c=(c==="-")?-1:1;if(a==10){var k=[];while(b.length>=BigInteger.base_log10){k.push(parseInt(b.splice(-BigInteger.base_log10).join(""),10))}k.push(parseInt(b.join(""),10));return new BigInteger(k,c)}if(a===BigInteger.base){return new BigInteger(b.map(Number).reverse(),c)}var k=BigInteger.ZERO;a=BigInteger.small[a];var f=BigInteger.small;for(var h=0;h<b.length;h++){k=k.multiply(a).add(f[parseInt(b[h],36)])}return new BigInteger(k._d,c)}else{throw new Error("Invalid BigInteger format: "+l)}};BigInteger.prototype.add=function(c){if(this._s===0){return BigInteger(c)}c=BigInteger(c);if(c._s===0){return this}if(this._s!==c._s){c=c.negate();return this.subtract(c)}var k=this._d;var j=c._d;var f=k.length;var d=j.length;var g=new Array(Math.max(f,d)+1);var m=Math.min(f,d);var l=0;var h;for(var e=0;e<m;e++){h=k[e]+j[e]+l;g[e]=h%BigInteger.base;l=(h/BigInteger.base)|0}if(d>f){k=j;f=d}for(e=m;l&&e<f;e++){h=k[e]+l;g[e]=h%BigInteger.base;l=(h/BigInteger.base)|0}if(l){g[e]=l}for(;e<f;e++){g[e]=k[e]}return new BigInteger(g,this._s)};BigInteger.prototype.negate=function(){return new BigInteger(this._d,-this._s)};BigInteger.prototype.abs=function(){return(this._s<0)?this.negate():this};BigInteger.prototype.subtract=function(c){if(this._s===0){return BigInteger(c).negate()}c=BigInteger(c);if(c._s===0){return this}if(this._s!==c._s){c=c.negate();return this.add(c)}var f=this;var q;if(this._s<0){q=f;f=new BigInteger(c._d,1);c=new BigInteger(q._d,1)}var e=f.compareAbs(c);if(e===0){return BigInteger.ZERO}else{if(e<0){q=c;c=f;f=q}}var o=f._d;var l=c._d;var h=o.length;var d=l.length;var p=new Array(h);var j=0;var g;var k;for(g=0;g<d;g++){k=o[g]-j-l[g];if(k<0){k+=BigInteger.base;j=1}else{j=0}p[g]=k}for(g=d;g<h;g++){k=o[g]-j;if(k<0){k+=BigInteger.base}else{p[g++]=k;break}p[g]=k}for(;g<h;g++){p[g]=o[g]}return new BigInteger(p,e)};(function(){function b(j,d){var c=j._d;var f=c.slice();var g=true;var e=0;while(true){var h=(c[e]||0)+1;f[e]=h%BigInteger.base;if(h<=BigInteger.base-1){break}++e}return new BigInteger(f,d)}function a(j,d){var c=j._d;var f=c.slice();var g=true;var e=0;while(true){var h=(c[e]||0)-1;if(h<0){f[e]=h+BigInteger.base}else{f[e]=h;break}++e}return new BigInteger(f,d)}BigInteger.prototype.next=function(){switch(this._s){case 0:return BigInteger.ONE;case -1:return a(this,-1);default:return b(this,1)}};BigInteger.prototype.prev=function(){switch(this._s){case 0:return BigInteger.M_ONE;case -1:return b(this,-1);default:return a(this,1)}}})();BigInteger.prototype.compareAbs=function(h){if(this===h){return 0}if(!(h instanceof BigInteger)){if(!isFinite(h)){return(isNaN(h)?h:-1)}h=BigInteger(h)}if(this._s===0){return(h._s!==0)?-1:0}if(h._s===0){return 1}var f=this._d.length;var e=h._d.length;if(f<e){return -1}else{if(f>e){return 1}}var d=this._d;var c=h._d;for(var g=f-1;g>=0;g--){if(d[g]!==c[g]){return d[g]<c[g]?-1:1}}return 0};BigInteger.prototype.compare=function(b){if(this===b){return 0}b=BigInteger(b);if(this._s===0){return -b._s}if(this._s===b._s){var a=this.compareAbs(b);return a*this._s}else{return this._s}};BigInteger.prototype.isUnit=function(){return this===BigInteger.ONE||this===BigInteger.M_ONE||(this._d.length===1&&this._d[0]===1)};BigInteger.prototype.multiply=function(d){if(this._s===0){return BigInteger.ZERO}d=BigInteger(d);if(d._s===0){return BigInteger.ZERO}if(this.isUnit()){if(this._s<0){return d.negate()}return d}if(d.isUnit()){if(d._s<0){return this.negate()}return this}if(this===d){return this.square()}var c=(this._d.length>=d._d.length);var q=(c?this:d)._d;var p=(c?d:this)._d;var l=q.length;var e=p.length;var g=l+e;var m=new Array(g);var k;for(k=0;k<g;k++){m[k]=0}for(k=0;k<e;k++){var t=0;var f=p[k];var s=l+k;var o;for(var h=k;h<s;h++){o=m[h]+f*q[h-k]+t;t=(o/BigInteger.base)|0;m[h]=(o%BigInteger.base)|0}if(t){o=m[h]+t;t=(o/BigInteger.base)|0;m[h]=o%BigInteger.base}}return new BigInteger(m,this._s*d._s)};BigInteger.prototype.multiplySingleDigit=function(b){if(b===0||this._s===0){return BigInteger.ZERO}if(b===1){return this}var h;if(this._d.length===1){h=this._d[0]*b;if(h>=BigInteger.base){return new BigInteger([(h%BigInteger.base)|0,(h/BigInteger.base)|0],1)}return new BigInteger([h],1)}if(b===2){return this.add(this)}if(this.isUnit()){return new BigInteger([b],1)}var k=this._d;var f=k.length;var c=f+1;var g=new Array(c);for(var e=0;e<c;e++){g[e]=0}var l=0;for(var d=0;d<f;d++){h=b*k[d]+l;l=(h/BigInteger.base)|0;g[d]=(h%BigInteger.base)|0}if(l){h=l;l=(h/BigInteger.base)|0;g[d]=h%BigInteger.base}return new BigInteger(g,1)};BigInteger.prototype.square=function(){if(this._s===0){return BigInteger.ZERO}if(this.isUnit()){return BigInteger.ONE}var a=this._d;var b=a.length;var c=new Array(b+b+1);var h,l,d;var f;for(f=0;f<b;f++){d=f*2;h=a[f]*a[f];l=(h/BigInteger.base)|0;c[d]=h%BigInteger.base;c[d+1]=l}for(f=0;f<b;f++){l=0;d=f*2+1;for(var e=f+1;e<b;e++,d++){h=a[e]*a[f]*2+c[d]+l;l=(h/BigInteger.base)|0;c[d]=h%BigInteger.base}d=b+f;var g=l+c[d];l=(g/BigInteger.base)|0;c[d]=g%BigInteger.base;c[d+1]+=l}return new BigInteger(c,1)};BigInteger.prototype.quotient=function(a){return this.divRem(a)[0]};BigInteger.prototype.divide=BigInteger.prototype.quotient;BigInteger.prototype.remainder=function(a){return this.divRem(a)[1]};BigInteger.prototype.divRem=function(f){f=BigInteger(f);if(f._s===0){throw new Error("Divide by zero")}if(this._s===0){return[BigInteger.ZERO,BigInteger.ZERO]}if(f._d.length===1){return this.divRemSmall(f._s*f._d[0])}switch(this.compareAbs(f)){case 0:return[this._s===f._s?BigInteger.ONE:BigInteger.M_ONE,BigInteger.ZERO];case -1:return[BigInteger.ZERO,this]}var g=this._s*f._s;var o=f.abs();var d=this._d.slice();var e=f._d.length;var m=d.length;var i=[];var j;var c=new BigInteger([],1);c._s=1;while(d.length){c._d.unshift(d.pop());c=new BigInteger(c._d,1);if(c.compareAbs(f)<0){i.push(0);continue}if(c._s===0){j=0}else{var h=c._d.length,q=o._d.length;var l=c._d[h-1]*BigInteger.base+c._d[h-2];var k=o._d[q-1]*BigInteger.base+o._d[q-2];if(c._d.length>o._d.length){l=(l+1)*BigInteger.base}j=Math.ceil(l/k)}do{var b=o.multiplySingleDigit(j);if(b.compareAbs(c)<=0){break}j--}while(j);i.push(j);if(!j){continue}var p=c.subtract(b);c._d=p._d.slice()}return[new BigInteger(i.reverse(),g),new BigInteger(c._d,this._s)]};BigInteger.prototype.divRemSmall=function(f){var a;f=+f;if(f===0){throw new Error("Divide by zero")}var m=f<0?-1:1;var g=this._s*m;f=Math.abs(f);if(f<1||f>=BigInteger.base){throw new Error("Argument out of range")}if(this._s===0){return[BigInteger.ZERO,BigInteger.ZERO]}if(f===1||f===-1){return[(g===1)?this.abs():new BigInteger(this._d,g),BigInteger.ZERO]}if(this._d.length===1){var b=new BigInteger([(this._d[0]/f)|0],1);a=new BigInteger([(this._d[0]%f)|0],1);if(g<0){b=b.negate()}if(this._s<0){a=a.negate()}return[b,a]}var d=this._d.slice();var h=new Array(d.length);var e=0;var l=0;var j=0;var k;while(d.length){e=e*BigInteger.base+d[d.length-1];if(e<f){h[j++]=0;d.pop();l=BigInteger.base*l+e;continue}if(e===0){k=0}else{k=(e/f)|0}var c=f*k;l=e-c;h[j++]=k;if(!k){d.pop();continue}d.pop();e=l}a=new BigInteger([l],1);if(this._s<0){a=a.negate()}return[new BigInteger(h.reverse(),g),a]};BigInteger.prototype.isEven=function(){var a=this._d;return this._s===0||a.length===0||(a[0]%2)===0};BigInteger.prototype.isOdd=function(){return !this.isEven()};BigInteger.prototype.sign=function(){return this._s};BigInteger.prototype.isPositive=function(){return this._s>0};BigInteger.prototype.isNegative=function(){return this._s<0};BigInteger.prototype.isZero=function(){return this._s===0};BigInteger.prototype.exp10=function(b){b=+b;if(b===0){return this}if(Math.abs(b)>Number(BigInteger.MAX_EXP)){throw new Error("exponent too large in BigInteger.exp10")}if(b>0){var a=new BigInteger(this._d.slice(),this._s);for(;b>=BigInteger.base_log10;b-=BigInteger.base_log10){a._d.unshift(0)}if(b==0){return a}a._s=1;a=a.multiplySingleDigit(Math.pow(10,b));return(this._s<0?a.negate():a)}else{if(-b>=this._d.length*BigInteger.base_log10){return BigInteger.ZERO}else{var a=new BigInteger(this._d.slice(),this._s);for(b=-b;b>=BigInteger.base_log10;b-=BigInteger.base_log10){a._d.shift()}return(b==0)?a:a.divRemSmall(Math.pow(10,b))[0]}}};BigInteger.prototype.pow=function(d){if(this.isUnit()){if(this._s>0){return this}else{return BigInteger(d).isOdd()?this:this.negate()}}d=BigInteger(d);if(d._s===0){return BigInteger.ONE}else{if(d._s<0){if(this._s===0){throw new Error("Divide by zero")}else{return BigInteger.ZERO}}}if(this._s===0){return BigInteger.ZERO}if(d.isUnit()){return this}if(d.compareAbs(BigInteger.MAX_EXP)>0){throw new Error("exponent too large in BigInteger.pow")}var b=this;var a=BigInteger.ONE;var c=BigInteger.small[2];while(d.isPositive()){if(d.isOdd()){a=a.multiply(b);if(d.isUnit()){return a}}b=b.square();d=d.quotient(c)}return a};BigInteger.prototype.modPow=function(d,b){var a=BigInteger.ONE;var c=this;while(d.isPositive()){if(d.isOdd()){a=a.multiply(c).remainder(b)}d=d.quotient(BigInteger.small[2]);if(d.isPositive()){c=c.square().remainder(b)}}return a};BigInteger.prototype.log=function(){switch(this._s){case 0:return -Infinity;case -1:return NaN;default:}var a=this._d.length;if(a*BigInteger.base_log10<30){return Math.log(this.valueOf())}var b=Math.ceil(30/BigInteger.base_log10);var c=this._d.slice(a-b);return Math.log((new BigInteger(c,1)).valueOf())+(a-b)*Math.log(BigInteger.base)};BigInteger.prototype.valueOf=function(){return parseInt(this.toString(),10)};BigInteger.prototype.toJSValue=function(){return parseInt(this.toString(),10)};BigInteger.MAX_EXP=BigInteger(2147483647);(function(){function b(d){return function(e){return d.call(BigInteger(e))}}function a(d){return function(f,e){return d.call(BigInteger(f),BigInteger(e))}}function c(d){return function(f,e,g){return d.call(BigInteger(f),BigInteger(e),BigInteger(g))}}(function(){var f,g;var d="toJSValue,isEven,isOdd,sign,isZero,isNegative,abs,isUnit,square,negate,isPositive,toString,next,prev,log".split(",");var h="compare,remainder,divRem,subtract,add,quotient,divide,multiply,pow,compareAbs".split(",");var e=["modPow"];for(f=0;f<d.length;f++){g=d[f];BigInteger[g]=b(BigInteger.prototype[g])}for(f=0;f<h.length;f++){g=h[f];BigInteger[g]=a(BigInteger.prototype[g])}for(f=0;f<e.length;f++){g=e[f];BigInteger[g]=c(BigInteger.prototype[g])}BigInteger.exp10=function(i,j){return BigInteger(i).exp10(j)}})()})();if(typeof exports!=="undefined"){exports.BigInteger=BigInteger};