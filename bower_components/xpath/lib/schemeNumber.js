var BigInteger;if(!this.BigInteger&&typeof require!=="undefined"){BigInteger=require("biginteger").BigInteger}else{BigInteger=this.BigInteger}if(!BigInteger){if(typeof load!=="undefined"){load("biginteger.js")}else{if(this.readFile){eval(this.readFile("biginteger.js"))}else{throw new Error("BigInteger is not defined.")}}}var SchemeNumber=(function(){function aL(C){if(!C){throw new Error("assertion failed")}}var av=Math.abs;var bx=Math.floor;var aa=Math.ceil;var F=Math.round;var a3=Math.pow;var bC=Math.sqrt;var aq=Math.atan2;var bi=Math.log;var aS=Math.exp;var bs=Math.atan;var aj=Math.cos;var aZ=Math.sin;var bm=Math.tan;var bD=Math.LN2;var a0=Math.LN10;var w=isFinite;var c=isNaN;var bK=parseInt;var bg=parseFloat;function aY(){return false}function G(){return true}function ai(C){return C}function M(){return this}function g(){throw new Error("BUG: unimplemented")}function P(){throw new Error("BUG: Abstract method not overridden")}function bl(){}bl.prototype=new Number();function bt(){}bt.prototype=new bl();function bk(){}bk.prototype=new bt();function L(){}L.prototype=new bk();function O(){}O.prototype=new L();function Q(){}Q.prototype=new O();var ad=/^(.*[^a-zA-Z]|)([-+].*)i$/;var A=/^(.*)([-+].*)i$/;var bN=/^[-+](nan|inf)\.0$/;var r=/[eEsSfFdDlL]/;var bu=/^([0-9]+\.?|[0-9]*\.[0-9]+)([eEsSfFdDlL][-+]?[0-9]+)?$/;var bO={2:/^[01]+$/,8:/^[0-7]+$/,10:/^[0-9]+$/,16:/^[0-9a-fA-F]+$/};function ak(){return aM}function aX(){return af}function k(){bw("&assertion","division by exact zero")}var bM;if(false){bM=Number}else{bM=function(C){this._=C}}var al,ay;var e={};var ba=[[],["log","floor","ceil","sqrt","abs","atan","cos","sin","tan","exp"],["pow","atan2"]];if(bM===Number){al=ai;ay=function(C){return C instanceof Number||typeof C==="number"};ba[1].concat(ba[2]).forEach(function(C){e[C]=Math[C]})}else{bM.prototype=new bk();(function(){var C=new bM(0);al=function(I){return(I===0?C:new bM(I))}})();ay=function(C){return C instanceof bl};ba[1].forEach(function(C){var I=Math[C];e[C]=function(N){return al(I(N))}});ba[2].forEach(function(C){var I=Math[C];e[C]=function(R,N){return al(I(R,N))}});["toFixed","toExponential","toPrecision"].forEach(function(C){var I=Number.prototype[C];bM.prototype[C]=function(N){return I.call(this._,N)}});bM.prototype.valueOf=function(){return this._}}function j(I){if(I instanceof bl){return I}var C=I;if(typeof C!=="string"){if(typeof C==="number"){return al(C)}if(C instanceof Number){return al(+C)}if(C==null){return(C===null?bQ:br)}C=C.valueOf();if(typeof C==="number"){return al(C)}C=String(C)}C=bd(C);if(C===false){bw("&assertion","not a number",I)}return C}var bf=j;bf.VERSION=[1,1,4];var bA=e.pow;var bL=e.log;var bh=e.floor;var aQ=e.ceil;var D=e.sqrt;var ae=e.atan2;var aN=e.abs;var t=e.atan;var aH=e.cos;var bv=e.sin;var bU=e.tan;var be=e.exp;var ab={C:["Rectangular","R"],R:["Flonum","ER"],ER:["EQ"],EQ:["EQFraction","EI"],EI:["EINative","EIBig"]};var a8={C:bt,R:bk,ER:L,EQ:O,EI:Q,Rectangular:bB,Flonum:bM,EQFraction:W,EINative:a9,EIBig:bW};var aW={};for(var U in a8){aW[U]={}}var K=new Object();function bd(b5,b2,R){function bY(){throw K}function b4(b6){if(R!==undefined){bY()}R=b6}function I(b6){if(b2){bY()}b2=b6}function b3(b7,b6){if(!bO[b2].test(b7)){bY()}if(R===false){return al(b6*bK(b7,b2))}return h(b6,b7,b2)}function b0(cg){if(bN.test(cg)){if(R){bY()}switch(cg){case"+inf.0":return at;case"-inf.0":return bS;default:return br}}var b7=1;switch(cg[0]){case"-":b7=-1;case"+":cg=cg.substring(1)}var ca=cg.indexOf("/");if(ca!=-1){return b3(cg.substring(0,ca),b7).SN_divide(b3(cg.substring(ca+1),1))}if(b2!==10){bY()}var b9=cg.indexOf("|");if(b9!==-1){var b8=cg.substring(b9+1);if(!bO[10].test(b8)){bY()}cg=cg.substring(0,b9);var cc=bK(b8);if(cc===0){cg="0.0"}else{if(cc<53){return b1(cg,cc,R)}}}cg=cg.replace(r,"e");var b6=cg.indexOf(".");var cd=cg.indexOf("e");if(b6===-1&&cd===-1){return b3(cg,b7)}if(!bu.test(cg)){bY()}if(!R){return al(b7*bg(cg))}var cb=cg.substring(0,b6===-1?cd:b6);var ce=0;var cf;if(cd===-1){cf=cg.substring(b6+1)}else{if(b6===-1){cf=""}else{cf=cg.substring(b6+1,cd)}ce=bK(cg.substring(cd+1))}return bz(b7,cb+cf,ce-cf.length)}function C(ca){var b7=ca.indexOf("@");if(b7!==-1){var b9=a2(b0(ca.substring(0,b7)),b0(ca.substring(b7+1)));if(R&&b9.SN_isInexact()){b9=b9.SN_toExact()}return b9}if(ca[ca.length-1]!=="i"){return b0(ca)}if(ca==="i"){if(R===false){return bc(bQ,al(1))}return bp}if(ca==="-i"){if(R===false){return bc(bQ,al(-1))}return bJ}var b8=(b2===10?ad:A).exec(ca);var b6,cb;if(b8){b6=b8[1];cb=b8[2];b6=(b6?b0(b6):(R===false?bQ:aM));cb=(cb==="+"?af:(cb==="-"?B:b0(cb)))}else{b6=(R===false?bQ:aM);cb=b0(ca.substring(0,ca.length-1))}return bG(b6,cb)}function b1(cf,cb){var ce=bd(cf,b2,true);if(ce===false||!ce.SN_isReal()){bY()}if(!ce.SN_isZero()){var cd=ce.SN_abs();var b7=cb-bx(cd.SN_log()/bD)-1;var b9=bV.SN_expt(ax(av(b7)));if(b7<0){b9=b9.SN_reciprocal()}var b6=cd.SN_multiply(b9);var cc=bV.SN_expt(ax(cb));while(b6.SN_ge(cc)){b6=b6.SN_divide(bV);b9=b9.SN_divide(bV)}for(var ca=b6.SN_add(b6);ca.SN_lt(cc);ca=b6.SN_add(b6)){b6=ca;b9=b9.SN_add(b9)}var b8=b6.SN_round().SN_divide(b9);if(ce.SN_isNegative()){b8=b8.SN_negate()}ce=b8}if(!R){ce=ce.SN_toInexact()}return ce}if(!b2||b2==10){if(/^-?[0-9]{1,15}$/.test(b5)){if(R===false){return al(bK(b5))}return ax(bK(b5))}b2=10}var N=0;try{while(b5[N]==="#"){switch(b5[N+1]){case"i":case"I":b4(false);break;case"e":case"E":b4(true);break;case"b":case"B":I(2);break;case"o":case"O":I(8);break;case"d":case"D":I(10);break;case"x":case"X":I(16);break;default:return false}N+=2}return C(b5.substring(N))}catch(bZ){if(bZ===K){return false}if(b5==undefined){bw("&assertion","missing argument")}throw bZ}}function bG(C,I){if(C.SN_isExact()&&I.SN_isExact()){return ah(C,I)}return bc(C.SN_toInexact(),I.SN_toInexact())}function a2(I,C){return bc(I.SN_multiply(C.SN_cos()),I.SN_multiply(C.SN_sin()))}function am(C){if(!C.SN_isReal()){bw("&assertion","not a real number",C)}return C}function bq(C){C=j(C);C.SN_isReal()||am(C);return C}function d(C){C=j(C);if(!C.SN_isInteger()){bw("&assertion","not an integer",C)}return C}function o(C){C=j(C);C.SN_isInteger()||d(C);return C}function bI(C){if(!C.SN_isRational()){bw("&assertion","not a rational number",C)}return C}function aR(C){if(C.SN_isNegative()){bw("&assertion","negative number",C)}return C}function bH(C){if(C.SN_isInexact()){bw("&assertion","inexact number",C)}return C}bf.raise=bj;function bj(N,I,C){var R="SchemeNumber: "+N+": "+I;if(arguments.length>2){if(ay(C)){C=C.SN_numberToString()}R+=": "+C}throw new Error(R)}function bw(){var C=arguments.length;var I=new Array(C);while(C--){I[C]=arguments[C]}j.raise.apply(j,I);bj.apply(this,I)}j.maxIntegerDigits=1000000;bf.fn={"eqv?":aB,"number?":p,"complex?":aw,"real?":bX,"rational?":aP,"integer?":y,"real-valued?":v,"rational-valued?":bn,"integer-valued?":bT,"exact?":ac("SN_isExact"),"inexact?":ac("SN_isInexact"),inexact:ac("SN_toInexact"),exact:ac("SN_toExact"),"=":V,"<":ag("SN_lt"),">":ag("SN_gt"),"<=":ag("SN_le"),">=":ag("SN_ge"),"zero?":ac("SN_isZero"),"positive?":ac("SN_isPositive"),"negative?":ac("SN_isNegative"),"odd?":ac("SN_isOdd"),"even?":ac("SN_isEven"),"finite?":ac("SN_isFinite"),"infinite?":ac("SN_isInfinite"),"nan?":ac("SN_isNaN"),max:bo("SN_gt"),min:bo("SN_lt"),"+":function(){var I=aM;var C=arguments.length;var N=0;while(N<C){I=I.SN_add(j(arguments[N++]))}return I},"*":function(){var I=af;var C=arguments.length;var N=0;while(N<C){I=I.SN_multiply(j(arguments[N++]))}return I},"-":function(I){var C=arguments.length;switch(C){case 0:bP(arguments);case 1:return j(I).SN_negate()}var N=j(I);var R=1;while(R<C){N=N.SN_subtract(j(arguments[R++]))}return N},"/":function(I){var C=arguments.length;switch(C){case 0:bP(arguments);case 1:return j(I).SN_reciprocal();case 2:return j(I).SN_divide(j(arguments[1]))}var R=af;var N=1;while(N<C){R=R.SN_multiply(j(arguments[N++]))}return j(I).SN_divide(R)},abs:ac("SN_abs"),"div-and-mod":aA(false,2),div:aA(false,0),mod:aA(false,1),"div0-and-mod0":aA(true,2),div0:aA(true,0),mod0:aA(true,1),gcd:function(){var N=aM;var I=arguments.length;var bY=true;for(var R=0;R<I;R++){var C=o(arguments[R]);bY=bY&&C.SN_isExact();N=X(N,C.SN_abs().SN_toExact())}N=N.SN_abs();return(bY?N:N.SN_toInexact())},lcm:function(){var N=af;var I=arguments.length;var bY=true;for(var R=0;R<I;R++){var C=o(arguments[R]);bY=bY&&C.SN_isExact();C=C.SN_abs().SN_toExact();N=N.SN_multiply(C).SN_divide(X(N,C.SN_abs()))}return(bY?N:N.SN_toInexact())},numerator:ac("SN_numerator"),denominator:ac("SN_denominator"),floor:ac("SN_floor"),ceiling:ac("SN_ceiling"),truncate:ac("SN_truncate"),round:ac("SN_round"),rationalize:u,exp:ac("SN_exp"),log:function(N,I){var C=j(N).SN_log();switch(arguments.length){case 2:C=C.SN_divide(j(I).SN_log());case 1:return C;default:az("1-2",arguments)}},sin:ac("SN_sin"),cos:ac("SN_cos"),tan:ac("SN_tan"),asin:ac("SN_asin"),acos:ac("SN_acos"),atan:function(I,C){switch(arguments.length){case 1:return j(I).SN_atan();case 2:return bq(I).SN_atan2(bq(C));default:az("1-2",arguments)}},sqrt:ac("SN_sqrt"),"exact-integer-sqrt":ac("SN_exactIntegerSqrt"),expt:a6("SN_expt"),"make-rectangular":function(C,I){arguments.length===2||aF(arguments);return bG(bq(C),bq(I))},"make-polar":function(I,C){arguments.length===2||aF(arguments);return a2(bq(I),bq(C))},"real-part":ac("SN_realPart"),"imag-part":ac("SN_imagPart"),magnitude:ac("SN_magnitude"),angle:ac("SN_angle"),"number->string":function(R,I,C){var N=I;switch(arguments.length){case 3:C=o(C);bH(C);case 2:N=bH(o(N)).valueOf();if(!bO[N]){bw("&assertion","invalid radix",I)}case 1:break;default:az("1-3",arguments)}return j(R).SN_numberToString(N,C)},"string->number":function(I,C){switch(arguments.length){case 1:case 2:return bd(String(I),C);default:az("1-2",arguments)}}};function az(I,C){var N="Function";for(name in fn){if(fn[name]===C.callee){N+=" '"+name+"'";break}}bw("&assertion",N+" expected "+I+" argument"+(I=="1"?"":"s")+", got "+C.length)}function aG(C){C.length===1||az(1,C)}function aF(C){C.length===2||az(2,C)}function bP(C){C.length>0||az("1 or more",C)}function aT(C){C.length>1||az("2 or more",C)}function aB(I,C){arguments.length===2||aF(arguments);if(I===C){return true}I=j(I);C=j(C);return(I.SN_eq(C)&&I.SN_isExact()===C.SN_isExact())}function p(C){arguments.length===1||aG(arguments);return ay(C)}function aw(C){arguments.length===1||aG(arguments);return ay(C)&&C.SN_isComplex()}function bX(C){arguments.length===1||aG(arguments);return ay(C)&&C.SN_isReal()}function aP(C){arguments.length===1||aG(arguments);return ay(C)&&C.SN_isRational()}function y(C){arguments.length===1||aG(arguments);return ay(C)&&C.SN_isInteger()}function v(C){arguments.length===1||aG(arguments);return ay(C)&&C.SN_imagPart().SN_isZero()}function bn(C){arguments.length===1||aG(arguments);return v(C)&&C.SN_realPart().SN_isRational()}function bT(C){arguments.length===1||aG(arguments);return v(C)&&C.SN_realPart().SN_isInteger()}function V(N,I){var C=arguments.length;C>1||aT(arguments);N=j(N);for(var R=1;R<C;R++){if(!N.SN_eq(j(arguments[R]))){return false}}return true}function ac(I){function C(N){arguments.length===1||aG(arguments);return j(N)[I]()}return C}function a6(I){function C(R,N){arguments.length===2||aF(arguments);return j(R)[I](j(N))}return C}function ag(I){function C(bY,R){var N=arguments.length;N>1||aT(arguments);R=bq(R);if(!bq(bY)[I](R)){return false}for(var bZ=2;bZ<N;bZ++){var b0=bq(arguments[bZ]);if(!R[I](b0)){return false}R=b0}return true}return C}function bo(I){function C(bY){var R=arguments.length;R>0||bP(arguments);var bZ=bq(bY);var b1=bZ.SN_isExact();for(var b0=1;b0<R;b0++){var N=bq(arguments[b0]);if(N.SN_isNaN()){return N}if(b1){b1=N.SN_isExact();if(!b1){bZ=bZ.SN_toInexact()}}if(N[I](bZ)!==false){bZ=N}}return b1?bZ:bZ.SN_toInexact()}return C}function ap(C){bw("&assertion","div/mod second argument is zero",C)}function aA(I,N){function C(bZ,b1){arguments.length===2||aF(arguments);bZ=bq(bZ);b1=bq(b1);if(!bZ.SN_isFinite()){bw("&assertion","div/mod first argument is not finite",bZ)}if(b1.SN_isZero()){ap(b1)}if(!I){switch(N){case 0:return bZ.SN_div(b1);case 1:return bZ.SN_mod(b1);case 2:default:return bZ.SN_divAndMod(b1)}}var b0=bZ.SN_divAndMod(b1);var bY=b0[1];var R=b1.SN_abs();if(bY.SN_add(bY).SN_ge(R)){switch(N){case 0:return b0[0].SN_add(b1.SN_isNegative()?B:af);case 1:return bY.SN_subtract(R);case 2:default:return[b0[0].SN_add(b1.SN_isNegative()?B:af),bY.SN_subtract(R)]}}switch(N){case 0:return b0[0];case 1:return bY;case 2:default:return b0}}return C}function u(b2,b3){aF(arguments);b2=j(b2);b3=j(b3);if(!b2.SN_isFinite()||!b3.SN_isFinite()){am(b2);am(b3);if(b3.SN_isInfinite()){return(b2.SN_isFinite()?bQ:br)}if(b3.SN_isNaN()){return b3}return b2}if(b3.SN_isZero()){return b2}b3=b3.SN_abs();var N=b2.SN_subtract(b3);var I=b2.SN_add(b3);var b1=N.SN_floor();var b0=I.SN_floor();if(b1.SN_ne(b0)){var R=b1.SN_isNegative();if(b0.SN_isNegative()!=R){return(b1.SN_isExact()?aM:bQ)}return(R?b0:N.SN_ceiling())}var C=[];while(true){N=N.SN_subtract(b1);if(N.SN_isZero()){break}I=I.SN_subtract(b1);if(I.SN_isZero()){break}N=N.SN_reciprocal();I=I.SN_reciprocal();b1=N.SN_floor();switch(b1.SN_compare(I.SN_floor())){case -1:C.push(N.SN_ceiling());break;case 1:C.push(I.SN_ceiling());break;case 0:default:C.push(b1);continue}break}var bZ=aM;var bY=C.length;while(bY--){bZ=bZ.SN_add(C[bY]).SN_reciprocal()}return bZ.SN_add(b0)}aW.Flonum.SN_isExact=aY;aW.Flonum.SN_isInexact=G;aW.Flonum.SN_isComplex=G;aW.Flonum.SN_isReal=G;aW.Flonum.SN_debug=function(){return"Flonum("+this.SN_numberToString()+")"};function b(C){return C.toString(2)}function s(C){var N=b(av(C));var I=N.indexOf(".");if(I===-1){return 0}return N.length-I-1}function Z(C){return a3(2,s(C))}aW.Flonum.SN_numberToString=function(N,C){if(N&&N!=10&&w(this)){return"#i"+this.SN_toExact().SN_numberToString(N)}if(!w(this)){if(c(this)){return("+nan.0")}return(this>0?"+inf.0":"-inf.0")}var I=(+this).toString();if(I.indexOf(".")===-1){var bY=I.indexOf("e");if(bY===-1){I+="."}else{I=I.substring(0,bY)+"."+I.substring(bY)}}if(C!=undefined){if(C<53){var R=b(+this).replace(/[-+.]/g,"").replace(/^0+/,"").replace(/0+$/,"").length;if(C<R){C=R}}I+="|"+C}return I};aW.Flonum.SN_realPart=M;aW.Flonum.SN_imagPart=function(){return aM};aW.Flonum.SN_denominator=function(){return bA(2,s(+bI(this)))};aW.Flonum.SN_numerator=function(){return al(this*Z(+bI(this)))};aW.Flonum.SN_isInteger=function(){return w(this)&&this==bx(this)};aW.Flonum.SN_isFinite=function(){return w(this)};aW.Flonum.SN_isRational=aW.Flonum.SN_isFinite;aW.Flonum.SN_isZero=function(){return this==0};aW.Flonum.SN_isPositive=function(){return this>0};aW.Flonum.SN_isNegative=function(){return this<0};aW.Flonum.SN_sign=function(){return(this==0?0:(this>0?1:-1))};aW.Flonum.SN_isUnit=function(){return this==1||this==-1};aW.Flonum.SN_isInfinite=function(){return !w(this)&&!c(this)};aW.Flonum.SN_isNaN=function(){return c(this)};aW.Flonum.SN_isEven=function(){return(this&1)===0};aW.Flonum.SN_isOdd=function(){return(this&1)===1};aW.Flonum.SN_eq=function(C){return C.SN__eq_Flonum(this)};aW.Flonum.SN_ne=function(C){return C.SN__ne_Flonum(this)};aW.Flonum.SN_gt=function(C){return am(C).SN__gt_Flonum(this)};aW.Flonum.SN_lt=function(C){return am(C).SN__lt_Flonum(this)};aW.Flonum.SN_ge=function(C){return am(C).SN__ge_Flonum(this)};aW.Flonum.SN_le=function(C){return am(C).SN__le_Flonum(this)};aW.Flonum.SN_compare=function(C){return am(C).SN__compare_Flonum(this)};aW.Flonum.SN__eq_R=function(C){return +C==this};aW.Flonum.SN__ne_R=function(C){return +C!=this};aW.Flonum.SN__gt_R=function(C){return C>this};aW.Flonum.SN__lt_R=function(C){return C<this};aW.Flonum.SN__ge_R=function(C){return C>=this};aW.Flonum.SN__le_R=function(C){return C<=this};aW.Flonum.SN__compare_R=function(C){if(+C==this){return 0}if(C<this){return -1}if(C>this){return 1}return NaN};function aD(C){if(C<9007199254740992&&C>-9007199254740992){return ax(C)}return new bW(m(C))}function a7(C){if(!w(C)){bw("&implementation-violation","inexact argument has no reasonably close exact equivalent",C)}var N=Z(C);var R;if(N===1){return aD(C)}if(w(N)){R=C*N;N=aD(N)}else{var I=s(C);R=C*9007199254740992;R*=a3(2,I-53);N=bV.SN_expt(ax(I))}return aC(aD(R),N)}aW.Flonum.SN_toExact=function(){return a7(+this)};aW.Flonum.SN_toInexact=M;aW.Flonum.SN_add=function(C){return C.SN__add_Flonum(this)};aW.Flonum.SN_subtract=function(C){return C.SN__subtract_Flonum(this)};aW.Flonum.SN_multiply=function(C){return C.SN__multiply_Flonum(this)};aW.Flonum.SN_divide=function(C){return C.SN__divide_Flonum(this)};aW.Flonum.SN__add_R=function(C){return al(C+this)};aW.Flonum.SN__subtract_R=function(C){return al(C-this)};aW.Flonum.SN__multiply_R=function(C){return al(C*this)};aW.Flonum.SN__divide_R=function(C){return al(C/this)};aW.Flonum.SN_negate=function(){return al(-this)};aW.Flonum.SN_abs=function(){return(this<0?al(-this):this)};aW.Flonum.SN_reciprocal=function(){return al(1/this)};function aV(C,I){if(I>0){return bx(C/I)}if(I<0){return aa(C/I)}if(I==0){ap(al(I))}return NaN}aW.Flonum.SN_divAndMod=function(C){C=+C;var I=aV(this,C);return[al(I),al(this-(C*I))]};aW.Flonum.SN_div=function(C){return al(aV(this,C))};aW.Flonum.SN_mod=function(C){return al(this-C*aV(this,C))};aW.Flonum.SN_square=function(){return al(this*this)};aW.Flonum.SN_round=function(){var C=bx(this);var I=this-C;if(I<0.5){return al(C)}if(I>0.5){return al(C+1)}return al(2*F(this/2))};aW.Flonum.SN_truncate=function(){return this<0?aQ(this):bh(this)};aW.Flonum.SN_ceiling=function(){return aQ(this)};function i(C){return function(){return C(this)}}aW.Flonum.SN_abs=i(aN);aW.Flonum.SN_atan=i(t);aW.Flonum.SN_cos=i(aH);aW.Flonum.SN_exp=i(be);aW.Flonum.SN_floor=i(bh);aW.Flonum.SN_sin=i(bv);aW.Flonum.SN_tan=i(bU);function bb(I,C){return function(){var N=I(this);if(c(N)){return C(this)}return al(N)}}aW.Flonum.SN_acos=bb(Math.acos,a);aW.Flonum.SN_asin=bb(Math.asin,ao);aW.Flonum.SN_log=function(){if(this<0){return a5(this)}return bL(this)};aW.Flonum.SN_sqrt=function(){if(this>=0){return al(bC(this))}if(c(this)){return this}return bc(bQ,D(-this))};aW.Flonum.SN_atan2=function(C){return ae(this,C)};aW.Flonum.SN_expt=function(C){return C.SN__expt_Flonum(this)};var bQ=al(0);var at=al(Number.POSITIVE_INFINITY);var bS=al(Number.NEGATIVE_INFINITY);var br=al(Number.NaN);var an=al(Math.PI);aW.C.SN_isReal=aY;aW.C.SN_isRational=aY;aW.C.SN_isInteger=aY;aW.C.SN_isZero=aY;aW.C.SN_isUnit=aY;aW.C.SN_isComplex=G;aW.C.SN_numberToString=P;aW.C.toString=function(C){return this.SN_numberToString(C)};aW.C.valueOf=function(){if(this.SN_imagPart().SN_isZero()){return this.SN_realPart().valueOf()}return NaN};aW.C.toFixed=P;aW.C.toExponential=P;aW.C.toPrecision=P;aW.C.toLocaleString=function(){return this.toString()};aW.C.SN_debug=function(){return"C"};aW.C.SN_sqrt=function(){return a2(this.SN_magnitude().SN_sqrt(),this.SN_angle().SN_divide(bV))};function a5(C){return bG(C.SN_magnitude().SN_log(),C.SN_angle())}function ao(C){return bJ.SN_multiply(bp.SN_multiply(C).SN_add(af.SN_subtract(C.SN_square()).SN_sqrt()).SN_log())}function a(C){return an.SN_divide(bV).SN_subtract(ao(C))}function aJ(C){var I=bp.SN_multiply(C);return af.SN_add(I).SN_log().SN_subtract(af.SN_subtract(I).SN_log()).SN_divide(bV).SN_divide(bp)}aW.C.SN_log=function(){return a5(this)};aW.C.SN_asin=function(){return ao(this)};aW.C.SN_acos=function(){return a(this)};aW.C.SN_atan=function(){return aJ(this)};aW.C.SN_sin=function(){var C=bp.SN_multiply(this);return C.SN_exp().SN_subtract(C.SN_negate().SN_exp()).SN_divide(bV).SN_divide(bp)};aW.C.SN_cos=function(){var C=bp.SN_multiply(this);return C.SN_exp().SN_add(C.SN_negate().SN_exp()).SN_divide(bV)};aW.C.SN_tan=function(){return this.SN_sin().SN_divide(this.SN_cos())};aW.R.SN_isReal=G;aW.R.SN_debug=function(){return"R"};aW.R.SN_realPart=M;aW.R.SN_magnitude=function(){return this.SN_abs()};aW.R.SN_angle=function(){return this.SN_isNegative()?an:aM};aW.R.SN__eq_Flonum=aW.Flonum.SN__eq_R;aW.R.SN__ne_Flonum=aW.Flonum.SN__ne_R;aW.R.SN__eq_Rectangular=function(C){return C._y.SN_isZero()&&C._x.SN_eq(this)};aW.R.SN__ne_Rectangular=function(C){return !C._y.SN_isZero()||C._x.SN_ne(this)};aW.R.SN__gt_Flonum=aW.Flonum.SN__gt_R;aW.R.SN__lt_Flonum=aW.Flonum.SN__lt_R;aW.R.SN__ge_Flonum=aW.Flonum.SN__ge_R;aW.R.SN__le_Flonum=aW.Flonum.SN__le_R;aW.R.SN__compare_Flonum=aW.Flonum.SN__compare_R;aW.R.SN_compare=P;aW.R.SN_gt=function(C){return this.SN_compare(C)>0};aW.R.SN_lt=function(C){return this.SN_compare(C)<0};aW.R.SN_ge=function(C){return this.SN_compare(C)>=0};aW.R.SN_le=function(C){return this.SN_compare(C)<=0};aW.R.SN_add=function(C){return C.SN__add_R(this)};aW.R.SN__add_Flonum=aW.Flonum.SN__add_R;aW.R.SN_subtract=function(C){return C.SN__subtract_R(this)};aW.R.SN__subtract_Flonum=aW.Flonum.SN__subtract_R;aW.R.SN_multiply=function(C){return C.SN__multiply_R(this)};aW.R.SN__multiply_Flonum=aW.Flonum.SN__multiply_R;aW.R.SN_divide=function(C){return C.SN__divide_R(this)};aW.R.SN__divide_Flonum=aW.Flonum.SN__divide_R;function l(C,I){if(C.SN_isZero()){if(I.SN_isZero()){return al(1)}if(I.SN_realPart().SN_isPositive()){return bQ}bw("&implementation-restriction","invalid power for zero expt",I)}return C.SN_log().SN_multiply(I).SN_exp()}aW.R.SN__expt_R=function(C){if(C.SN_isNegative()){return l(C,this)}return bA(C,this)};aW.R.SN__expt_EI=aW.R.SN__expt_R;aW.R.SN__expt_EQ=function(I){if(I.SN_isNegative()){return l(I,this)}var C=I.SN_numerator().SN_expt(this);var N=I.SN_denominator().SN_expt(this);if(C.SN_isExact()&&C.SN_isInteger()&&N.SN_isExact()&&N.SN_isInteger()){return new W(C,N)}return C.SN_divide(N)};function S(C,N){var I=aI(C,N);return[I,C.SN_subtract(I.SN_multiply(N))]}function aI(C,I){return(I.SN_isNegative()?C.SN_divide(I).SN_ceiling():C.SN_divide(I).SN_floor())}function bE(C,I){return C.SN_subtract(aI(C,I).SN_multiply(I))}aW.R.SN_divAndMod=function(C){return S(this,C)};aW.R.SN_div=function(C){return aI(this,C)};aW.R.SN_mod=function(C){return bE(this,C)};aW.R.SN__divAndMod_R=function(C){return S(C,this)};aW.R.SN__div_R=function(C){return aI(C,this)};aW.R.SN__mod_R=function(C){return bE(C,this)};["sqrt","exp","log","sin","cos","tan","asin","acos","atan","atan2"].forEach(function(C){aW.R["SN_"+C]=aW.Flonum["SN_"+C]});function ah(C,I){if(I.SN_isZero()){return C}if(C.SN_isZero()&&I.SN_isUnit()){return(I.SN_isPositive()?bp:bJ)}return new bB(C,I)}function bc(C,I){return new bB(C,I)}function H(C,I){if(C.SN_isExact()){return ah(C,I)}return new bB(C,I)}function bB(C,I){this._x=C;this._y=I}bB.prototype=new bt();function by(I,C){if(C[0]==="-"||C[0]==="+"){return I+C+"i"}return I+"+"+C+"i"}aW.Rectangular.SN_numberToString=function(I,C){return by(this._x.SN_numberToString(I,C),this._y.SN_numberToString(I,C))};aW.Rectangular.toString=function(C){C=C||10;return by(this._x.toString(C),this._y.toString(C))};aW.Rectangular.SN_debug=function(){return"Rectangular("+this._x.SN_debug()+", "+this._y.SN_debug()+")"};aW.Rectangular.toFixed=function(C){return by(this._x.toFixed(C),this._y.toFixed(C))};aW.Rectangular.toExponential=function(C){return by(this._x.toExponential(C),this._y.toExponential(C))};aW.Rectangular.toPrecision=function(C){return by(this._x.toPrecision(C),this._y.toPrecision(C))};aW.Rectangular.SN_realPart=function(){return this._x};aW.Rectangular.SN_imagPart=function(){return this._y};aW.Rectangular.SN_isExact=function(){return this._x.SN_isExact()};aW.Rectangular.SN_isInexact=function(){return this._x.SN_isInexact()};aW.Rectangular.SN_toInexact=function(){if(this._x.SN_isInexact()){return this}return bc(this._x.SN_toInexact(),this._y.SN_toInexact())};aW.Rectangular.SN_toExact=function(){if(this._x.SN_isExact()){return this}return ah(this._x.SN_toExact(),this._y.SN_toExact())};aW.Rectangular.SN_isZero=function(){return this._x.SN_isZero()&&this._y.SN_isZero()};function T(C){return C._x.SN_square().SN_add(C._y.SN_square())}aW.Rectangular.SN_isUnit=function(){return T(this).SN_eq(af)};aW.Rectangular.SN_magnitude=function(){if(this._x.SN_isZero()){return this._y.SN_abs()}return T(this).SN_sqrt()};aW.Rectangular.SN_angle=function(){return this._y.SN_atan2(this._x)};aW.C.SN__eq_Rectangular=P;aW.Rectangular.SN_eq=function(C){return C.SN__eq_Rectangular(this)};aW.Rectangular.SN__eq_Rectangular=function(C){return C._x.SN_eq(this._x)&&C._y.SN_eq(this._y)};aW.Rectangular.SN__eq_R=function(C){return this._y.SN_isZero()&&C.SN_eq(this._x)};aW.C.SN__ne_Rectangular=P;aW.Rectangular.SN_ne=function(C){return C.SN__ne_Rectangular(this)};aW.Rectangular.SN__ne_Rectangular=function(C){return C._x.SN_ne(this._x)||C._y.SN_ne(this._y)};aW.Rectangular.SN__ne_R=function(C){return !this._y.SN_isZero()||C.SN_ne(this._x)};aW.Flonum.SN__add_Rectangular=function(C){return bc(al(C._x+this),C._y.SN_toInexact())};aW.Flonum.SN__subtract_Rectangular=function(C){return bc(al(C._x-this),C._y.SN_toInexact())};aW.Flonum.SN__multiply_Rectangular=function(C){return bc(al(C._x*this),al(C._y*this))};aW.Flonum.SN__divide_Rectangular=function(C){return bc(al(C._x/this),al(C._y/this))};aW.Flonum.SN__expt_Rectangular=function(C){return a2(bA(T(C),this/2),al(aq(C._y,C._x)*this))};aW.R.SN__add_Rectangular=function(C){return bG(C._x.SN_add(this),C._y)};aW.R.SN__subtract_Rectangular=function(C){return bG(C._x.SN_subtract(this),C._y)};aW.R.SN__multiply_Rectangular=function(C){return H(C._x.SN_multiply(this),C._y.SN_multiply(this))};aW.R.SN__divide_Rectangular=function(C){return H(C._x.SN_divide(this),C._y.SN_divide(this))};aW.C.SN__add_Rectangular=P;aW.Rectangular.SN_add=function(C){return C.SN__add_Rectangular(this)};aW.Rectangular.SN__add_R=function(C){return bG(C.SN_add(this._x),this._y)};aW.Rectangular.SN__add_Rectangular=function(I){var C=I._x.SN_add(this._x);var N=I._y.SN_add(this._y);return(C.SN_isExact()?ah:bc)(C,N)};aW.Rectangular.SN_negate=function(){return H(this._x.SN_negate(),this._y.SN_negate())};aW.C.SN__subtract_Rectangular=P;aW.Rectangular.SN_subtract=function(C){return C.SN__subtract_Rectangular(this)};aW.Rectangular.SN__subtract_R=function(C){return bG(C.SN_subtract(this._x),this._y.SN_negate())};aW.Rectangular.SN__subtract_Rectangular=function(I){var C=I._x.SN_subtract(this._x);var N=I._y.SN_subtract(this._y);return(C.SN_isExact()?ah:bc)(C,N)};aW.C.SN__multiply_Rectangular=P;aW.Rectangular.SN_multiply=function(C){return C.SN__multiply_Rectangular(this)};aW.Rectangular.SN__multiply_R=function(C){return H(C.SN_multiply(this._x),C.SN_multiply(this._y))};function aK(I,C,R,N){return H(I.SN_multiply(R).SN_subtract(C.SN_multiply(N)),I.SN_multiply(N).SN_add(C.SN_multiply(R)))}aW.Rectangular.SN__multiply_Rectangular=function(C){return aK(C._x,C._y,this._x,this._y)};aW.Rectangular.SN_square=function(){return H(this._x.SN_square().SN_subtract(this._y.SN_square()),this._x.SN_multiply(this._y).SN_multiply(bV))};aW.Rectangular.SN_reciprocal=function(){var C=T(this);return H(this._x.SN_divide(C),this._y.SN_divide(C).SN_negate())};aW.C.SN__divide_Rectangular=P;aW.Rectangular.SN_divide=function(C){return C.SN__divide_Rectangular(this)};function Y(C,R,N){var I=T(N);return aK(C,R,N._x.SN_divide(I),N._y.SN_divide(I).SN_negate())}aW.Rectangular.SN__divide_R=function(C){return Y(C,C.SN_isExact()?aM:bQ,this)};aW.Rectangular.SN__divide_Rectangular=function(C){return Y(C._x,C._y,this)};aW.Rectangular.SN_expt=function(C){return C.SN__expt_Rectangular(this)};aW.Rectangular.SN__expt_C=function(C){return l(C,this)};aW.C.SN__expt_Rectangular=aW.Rectangular.SN__expt_C;aW.Rectangular.SN_exp=function(){return a2(this._x.SN_exp(),this._y)};aW.ER.SN_isExact=G;aW.ER.SN_isInexact=aY;aW.ER.SN_toExact=M;aW.ER.SN_toInexact=function(){return al(+this)};aW.ER.SN_isNaN=aY;aW.ER.SN_isFinite=G;aW.ER.SN_isInfinite=aY;aW.ER.SN_imagPart=ak;function a4(I){var C="000000000000000".substring(0,I&15);if(I>15){C+=new Array((I>>4)+1).join("0000000000000000")}return C}aW.ER.toFixed=function(b1){var R=(b1===undefined?0:bK(b1));if(R>j.maxIntegerDigits){throw new RangeError("fractionDigits exceeds SchemeNumber.maxIntegerDigits: "+b1)}var bZ=this;var b2="";if(bZ.SN_isNegative()){bZ=bZ.SN_negate();b2="-"}var C=af.SN__exp10(-R);var N=bZ.SN_divAndMod(C);var I=N[0];if(N[1].SN_add(N[1]).SN_ge(C)){I=af.SN_add(I)}if(I.SN_isZero()){return b2+"0"+(b1>0?"."+a4(b1):"")}I=I.SN_numberToString();if(R===0){return b2+I}var bY=R-I.length;if(R>0){if(bY>=0){I=a4(bY+1)+I}var b0=I.length-R;return b2+I.substring(0,b0)+"."+I.substring(b0)}return b2+I+a4(-R)};aW.ER.toExponential=function(R){var bY=(R===undefined?20:bK(R));if(bY<0){throw new RangeError("SchemeNumber toExponential: negative argument: "+bY)}if(bY>j.maxIntegerDigits){throw new RangeError("fractionDigits exceeds SchemeNumber.maxIntegerDigits: "+R)}var C=this;var N="";if(C.SN_isNegative()){C=C.SN_negate();N="-"}else{if(C.SN_isZero()){return"0"+(R>0?"."+a4(bY):"")+"e+0"}}var b0=bx(C.SN_log()/a0);var bZ=af.SN__exp10(b0-bY);var I=C.SN_divAndMod(bZ);var b1=I[0];if(I[1].SN_add(I[1]).SN_ge(bZ)){b1=af.SN_add(b1)}b1=b1.SN_numberToString();if(b1.length!=bY+1){b0+=b1.length-(bY+1);bZ=af.SN__exp10(b0-bY);I=C.SN_divAndMod(bZ);b1=I[0];if(I[1].SN_add(I[1]).SN_ge(bZ)){b1=af.SN_add(b1)}b1=b1.SN_numberToString();if(b1.length!=bY+1){throw new Error("Can not format as exponential: "+this.SN_numberToString())}}if(R===undefined){b1=b1.replace(/(\d)0+$/,"$1")}if(b1.length>1){b1=b1[0]+"."+b1.substring(1)}return N+b1+"e"+(b0<0?"":"+")+b0};aW.ER.toPrecision=function(I){var bZ,C;if(I===undefined){C=this.SN_toInexact();if(C.SN_isFinite()){return(+C).toString()}bZ=21}else{bZ=bK(I);if(bZ<1){throw new RangeError("SchemeNumber toPrecision: expected a positive precision, got: "+I)}if(bZ>j.maxIntegerDigits){throw new RangeError("precision exceeds SchemeNumber.maxIntegerDigits: "+I)}}C=this;var R="";if(C.SN_isNegative()){C=C.SN_negate();R="-"}else{if(C.SN_isZero()){return"0"+(bZ>1?"."+a4(bZ-1):"")}}var N=C.toExponential(bZ-1);var b0=N.indexOf("e");var bY=bK(N.substring(b0+1));if(bY>=-6&&bY<bZ){if(bY===0){N=N.substring(0,b0)}else{N=N.substring(0,1)+(N.indexOf(".")===-1?"":N.substring(2,b0));if(bY<0){N="0."+a4(-1-bY)+N}else{if(bY<bZ-1){N=N.substring(0,bY+1)+"."+N.substring(bY+1)}}}}else{if(I===undefined){N=N.substring(0,b0).replace(/\.?0+/,"")+N.substring(b0)}}return R+N};function bz(I,C,N){return h(I,C).SN__exp10(N)}aW.EQ.SN_isRational=G;aW.EQ.SN_eq=function(C){return C.SN__eq_EQ(this)};aW.EQ.SN__eq_EQ=P;aW.EQ.SN_ne=function(C){return C.SN__ne_EQ(this)};aW.EQ.SN__ne_EQ=P;aW.EQ.SN_compare=function(C){return C.SN__compare_EQ(this)};aW.EQ.SN__compare_EQ=P;aW.EQ.SN_add=function(C){return C.SN__add_EQ(this)};aW.EQ.SN__add_EQ=P;aW.EQ.SN_subtract=function(C){return C.SN__subtract_EQ(this)};aW.EQ.SN__subtract_EQ=P;aW.EQ.SN_multiply=function(C){return C.SN__multiply_EQ(this)};aW.EQ.SN__multiply_EQ=P;aW.EQ.SN_divide=function(C){return C.SN__divide_EQ(this)};aW.EQ.SN__divide_EQ=P;aW.EQ.SN_expt=function(C){return C.SN__expt_EQ(this)};function f(N,I){if(I.SN_isZero()){k()}var C=X(N.SN_abs(),I.SN_abs());N=N.SN_div(C);I=I.SN_div(C);if(I.SN_isNegative()){return aC(N.SN_negate(),I.SN_negate())}return aC(N,I)}function aC(I,C){return(C===af?I:new W(I,C))}function W(I,C){this._n=I;this._d=C}W.prototype=new O();aW.EQFraction.SN_numberToString=function(I,C){return(this._n.SN_numberToString(I)+"/"+this._d.SN_numberToString(I))};aW.EQFraction.valueOf=function(){var N=this._n;var I=this._d;var C=N/I;if(!c(C)){return C}if(N.SN_isNegative()){return -aS(N.SN_negate().SN_log()-I.SN_log())}return aS(N.SN_log()-I.SN_log())};aW.EQFraction.SN_debug=function(){return"EQFraction("+this._n.SN_debug()+" / "+this._d.SN_debug()+")"};aW.EQFraction.SN_numerator=function(){return this._n};aW.EQFraction.SN_denominator=function(){return this._d};aW.EQFraction.SN_isPositive=function(){return this._n.SN_isPositive()};aW.EQFraction.SN_isNegative=function(){return this._n.SN_isNegative()};aW.EQFraction.SN__eq_EQ=function(C){return(C.SN_numerator().SN_eq(this._n)&&C.SN_denominator().SN_eq(this._d))};aW.EQFraction.SN__ne_EQ=function(C){return(C.SN_numerator().SN_ne(this._n)||C.SN_denominator().SN_ne(this._d))};aW.EQFraction.SN__compare_EQ=function(R){var N=R.SN_numerator();var I=R.SN_sign()-this._n.SN_sign();if(I!==0){return(I>0?1:-1)}var C=R.SN_denominator();if(C===this._d){return N.SN_compare(this._n)}return N.SN_multiply(this._d).SN_compare(C.SN_multiply(this._n))};aW.EQFraction.SN_negate=function(){return new W(this._n.SN_negate(),this._d)};aW.EQFraction.SN_square=function(){return new W(this._n.SN_square(),this._d.SN_square())};aW.EQFraction.SN_reciprocal=function(){switch(this._n.SN_sign()){case -1:return aC(this._d.SN_negate(),this._n.SN_negate());case 1:return aC(this._d,this._n);case 0:default:k()}};aW.EQFraction.SN_floor=function(){return this._n.SN_div(this._d)};aW.EQFraction.SN_ceiling=function(){return this._n.SN_div(this._d).SN_add(af)};aW.EQFraction.SN_round=function(){if(this._d.SN_eq(bV)){var I=this._n.SN_div(bV);return I.SN_isEven()?I:I.SN_add(af)}var C=this._n.SN_divAndMod(this._d);var N=C[1];if(N.SN_add(N).SN_lt(this._d)){return C[0]}return C[0].SN_add(af)};aW.EQFraction.SN_truncate=function(){if(this._n.SN_isPositive()){return this._n.SN_div(this._d)}return this._d.SN_isUnit()?this._n:this._n.SN_div(this._d).SN_add(af)};aW.EQFraction.SN_sign=function(){return this._n.SN_sign()};aW.EQFraction.SN_abs=function(){if(this._n.SN_sign()>=0){return this}return this.SN_negate()};aW.EQFraction.SN__add_EQ=function(bY){var I=bY.SN_numerator();var R=bY.SN_denominator();var C=this._n;var N=this._d;return f(I.SN_multiply(N).SN_add(C.SN_multiply(R)),R.SN_multiply(N))};aW.EQFraction.SN__subtract_EQ=function(bY){var I=bY.SN_numerator();var R=bY.SN_denominator();var C=this._n;var N=this._d;return f(I.SN_multiply(N).SN_subtract(C.SN_multiply(R)),R.SN_multiply(N))};aW.EQFraction.SN__multiply_EQ=function(C){return f(C.SN_numerator().SN_multiply(this._n),C.SN_denominator().SN_multiply(this._d))};aW.EQFraction.SN__divide_EQ=function(C){return f(C.SN_numerator().SN_multiply(this._d),C.SN_denominator().SN_multiply(this._n))};aW.EQFraction.SN__add_EI=function(C){return aC(C.SN_multiply(this._d).SN_add(this._n),this._d)};aW.EQFraction.SN__subtract_EI=function(C){return aC(C.SN_multiply(this._d).SN_subtract(this._n),this._d)};aW.EQFraction.SN__multiply_EI=function(C){return f(C.SN_multiply(this._n),this._d)};aW.EQFraction.SN__divide_EI=function(C){return f(C.SN_multiply(this._d),this._n)};aW.EQFraction.SN_sqrt=function(){return this._n.SN_sqrt().SN_divide(this._d.SN_sqrt())};aW.EQFraction.SN_log=function(){return this._n.SN_log().SN_subtract(this._d.SN_log())};function h(C,I,N){var R=bK(I,N);if(R<9007199254740992){return ax(C*R)}return aE(I,C,N)}aW.EI.SN_isInteger=G;aW.EI.SN_debug=function(){return"EI"};aW.EI.SN_numerator=M;aW.EI.SN_denominator=function(){return af};aW.EI.SN_floor=M;aW.EI.SN_ceiling=M;aW.EI.SN_round=M;aW.EI.SN_truncate=M;aW.EI.SN__toBigInteger=P;aW.EI.SN_eq=function(C){return C.SN__eq_EI(this)};aW.EI.SN__eq_EI=function(C){return C.SN__toBigInteger().compare(this.SN__toBigInteger())===0};aW.EI.SN__eq_EQ=function(C){return C.SN_numerator().SN_eq(this)&&C.SN_denominator().SN_eq(af)};aW.EI.SN_ne=function(C){return C.SN__ne_EI(this)};aW.EI.SN__ne_EI=function(C){return C.SN__toBigInteger().compare(this.SN__toBigInteger())!==0};aW.EI.SN__ne_EQ=function(C){return C.SN_numerator().SN_ne(this)||C.SN_denominator().SN_ne(af)};aW.EI.SN_compare=function(C){return C.SN__compare_EI(this)};aW.EI.SN__compare_EQ=function(C){return C.SN_numerator().SN_compare(C.SN_denominator().SN_multiply(this))};aW.EI.SN__compare_EI=function(C){return C.SN__toBigInteger().compare(this.SN__toBigInteger())};aW.EI.SN_add=function(C){return C.SN__add_EI(this)};aW.EI.SN_subtract=function(C){return C.SN__subtract_EI(this)};aW.EI.SN_multiply=function(C){return C.SN__multiply_EI(this)};aW.EI.SN_reciprocal=function(){if(this.SN_isNegative()){return aC(B,this.SN_negate())}return aC(af,this)};aW.EI.SN_divAndMod=function(C){return C.SN__divAndMod_EI(this)};aW.EI.SN_div=function(C){return C.SN__div_EI(this)};aW.EI.SN_mod=function(C){return C.SN__mod_EI(this)};aW.EI.SN__add_EI=function(C){return E(C.SN__toBigInteger().add(this.SN__toBigInteger()))};aW.EI.SN__subtract_EI=function(C){return E(C.SN__toBigInteger().subtract(this.SN__toBigInteger()))};aW.EI.SN__multiply_EI=function(C){return E(C.SN__toBigInteger().multiply(this.SN__toBigInteger()))};aW.EI.SN__divAndMod_EI=function(bY){var N=this.SN__toBigInteger();var C=bY.SN__toBigInteger().divRem(N);var R=C[0];var I=C[1];if(I.isNegative()){I=I.add(N);R=R.prev()}return[E(R),E(I)]};aW.EI.SN__div_EI=function(C){return this.SN__divAndMod_EI(C)[0]};aW.EI.SN__mod_EI=function(C){return this.SN__divAndMod_EI(C)[1]};aW.EI.SN__add_EQ=function(C){var I=C.SN_denominator();return aC(C.SN_numerator().SN_add(I.SN_multiply(this)),I)};aW.EI.SN__subtract_EQ=function(C){var I=C.SN_denominator();return aC(C.SN_numerator().SN_subtract(I.SN_multiply(this)),I)};aW.EI.SN__multiply_EQ=function(C){return f(C.SN_numerator().SN_multiply(this),C.SN_denominator())};aW.EI.SN__divide_EQ=function(C){return f(C.SN_numerator(),C.SN_denominator().SN_multiply(this))};aW.EI.SN_expt=function(C){return C.SN__expt_EI(this)};aW.EI.SN__expt_EI=function(bZ){var N=this.SN_sign();var R=this.SN_abs().valueOf();var C=a3(bZ,R);var I;if(C>-9007199254740992&&C<9007199254740992){I=ax(C)}else{var bY=bZ.SN_log()*R;if(bY>j.maxIntegerDigits*a0){bw("&implementation-restriction","exact integer would exceed limit of "+(+j.maxIntegerDigits)+" digits; adjust SchemeNumber.maxIntegerDigits",bY/a0)}I=new bW(bZ.SN__toBigInteger().pow(R))}return(N>0?I:I.SN_reciprocal())};function ar(R,bY){var N=bY.SN_abs();var I=R;var C=af;while(N.SN_isPositive()){if(N.SN_isOdd()){C=C.SN_multiply(I)}I=I.SN_square();N=N.SN_div(bV)}return(bY.SN_isNegative()?C.SN_reciprocal():C)}aW.EI.SN__expt_ER=function(C){return ar(C,this)};aW.EI.SN__expt_C=function(C){if(C.SN_isExact()){return ar(C,this)}return l(C,this)};function a9(C){this._=C}a9.prototype=new Q();var aM=j.ZERO=new a9(0);var af=j.ONE=new a9(1);var B=j.M_ONE=new a9(-1);var bV=j.TWO=new a9(2);var J=[aM,af,bV];var bp=j.I=new bB(aM,af);var bJ=j.M_I=new bB(aM,B);function ax(C){return J[C]||(C==-1?B:new a9(C))}aM.SN_isZero=G;aM.SN_isPositive=aY;aM.SN_isNegative=aY;aM.SN_compare=function(C){return -C.SN_sign()};aM.SN_add=j;aM.SN_negate=M;aM.SN_abs=M;aM.SN_multiply=M;aM.SN_square=M;aM.SN_reciprocal=k;aM.SN_subtract=function(C){return C.SN_negate()};aM.SN_divide=function(C){if(C.SN_isZero()&&C.SN_isExact()){k()}return this};aM.SN_expt=function(C){switch(C.SN_realPart().SN_sign()){case 1:return this;case 0:return af;case -1:default:k()}};aM.SN_sqrt=M;aM.SN_exp=aX;aM.SN_sin=M;aM.SN_cos=aX;aM.SN_tan=M;aM.SN_asin=M;aM.SN_atan=M;af.SN_isUnit=G;af.SN_abs=M;af.SN_multiply=j;af.SN_reciprocal=M;af.SN_square=M;af.SN_expt=aM.SN_multiply;af.SN_sqrt=M;af.SN_log=ak;af.SN_acos=ak;B.SN_isUnit=G;B.SN_abs=aX;B.SN_multiply=aM.SN_subtract;B.SN_reciprocal=M;B.SN_square=aX;B.SN_sqrt=function(){return bp};B.SN_expt=function(I){if(!I.SN_isInteger()){return l(this,I)}var C=(I.SN_isEven()?af:B);if(I.SN_isExact()){return C}return C.SN_toInexact()};function z(C){return C.SN_negate()}function bF(C){return C.SN_reciprocal()}for(U in a8){aM["SN__add_"+U]=ai;aM["SN__subtract_"+U]=ai;aM["SN__multiply_"+U]=M;aM["SN__divide_"+U]=k;aM["SN__expt_"+U]=aX;af["SN__multiply_"+U]=ai;af["SN__divide_"+U]=ai;af["SN__expt_"+U]=ai;B["SN__multiply_"+U]=z;B["SN__divide_"+U]=z;B["SN__expt_"+U]=bF}aW.EINative.valueOf=function(){return this._};aW.EINative.SN_numberToString=function(I,C){return this._.toString(I||10)};aW.EINative.SN_debug=function(){return"EINative("+this._+")"};aW.EINative.SN__toBigInteger=function(){return BigInteger(this._)};aW.EINative.SN_isPositive=function(){return this._>0};aW.EINative.SN_isNegative=function(){return this._<0};aW.EINative.SN_sign=function(){return(this._>0?1:(this._==0?0:-1))};aW.EINative.SN_isEven=function(){return(this._&1)===0};aW.EINative.SN_isOdd=function(){return(this._&1)===1};aW.EINative.SN_eq=function(C){return C.SN__eq_EINative(this)};aW.EINative.SN__eq_EINative=function(C){return C._===this._};aW.EINative.SN_ne=function(C){return C.SN__ne_EINative(this)};aW.EINative.SN__ne_EINative=function(C){return C._!==this._};aW.EINative.SN_compare=function(C){return C.SN__compare_EINative(this)};aW.EINative.SN__compare_EINative=function(C){return(C._===this._?0:(C._>this._?1:-1))};function aU(I,C){var N=I+C;if(N>-9007199254740992&&N<9007199254740992){return ax(N)}return new bW(BigInteger.add(I,C))}aW.EINative.SN_add=function(C){return C.SN__add_EINative(this)};aW.EINative.SN__add_EINative=function(C){return aU(C._,this._)};aW.EINative.SN_negate=function(){return ax(-this._)};aW.EINative.SN_abs=function(){return(this._<0?ax(-this._):this)};aW.EINative.SN_subtract=function(C){return C.SN__subtract_EINative(this)};aW.EINative.SN__subtract_EINative=function(C){return aU(C._,-this._)};aW.EINative.SN_multiply=function(C){return C.SN__multiply_EINative(this)};aW.EINative.SN__multiply_EINative=function(I){var C=I._*this._;if(C>-9007199254740992&&C<9007199254740992){return ax(C)}return new bW(BigInteger(I._).multiply(this._))};aW.EINative.SN_square=function(){var C=this._*this._;if(C<9007199254740992){return ax(C)}return new bW(BigInteger(this._).square())};aW.EINative.SN_reciprocal=function(){var C=this._;aL(C!==0);if(C<0){return aC(B,ax(-C))}return aC(af,this)};function au(R,C,bY){if(C===0){k()}var bZ=(C>0?bx(R/C):aa(R/C));if(bY===0){return ax(bZ)}var N=C*bZ;var I;if(N>-9007199254740992){I=R-N}else{if(bZ>0){I=(R-C)-(C*(bZ-1))}else{I=(R+C)-(C*(bZ+1))}}I=ax(I);if(bY===1){return I}return[ax(bZ),I]}aW.EINative.SN_div=function(C){return C.SN__div_EINative(this)};aW.EINative.SN__div_EINative=function(C){return au(C._,this._,0)};aW.EINative.SN_mod=function(C){return C.SN__mod_EINative(this)};aW.EINative.SN__mod_EINative=function(C){return au(C._,this._,1)};aW.EINative.SN_divAndMod=function(C){return C.SN__divAndMod_EINative(this)};aW.EINative.SN__divAndMod_EINative=function(C){return au(C._,this._,2)};aW.EINative.SN__exp10=function(bY){if(this._===0||bY===0){return this}if(bY<0){var I=String(this._);var N=I.length-1;if(I[N]==="0"){while(I[N]==="0"&&bY<0){bY+=1;N-=1}I=ax(Number(I.substring(0,N+1)));if(bY===0){return I}}else{I=this}var R;if(bY<-15){R=new bW(BigInteger.ONE.exp10(-bY))}else{R=ax(Number("1000000000000000".substring(0,1-bY)))}return f(I,R)}if(bY<16){var C=bK("1000000000000000".substring(0,bY+1))*this._;if(C>-9007199254740992&&C<9007199254740992){return ax(C)}}return new bW(BigInteger(this._).exp10(bY))};aW.EINative.SN_exactIntegerSqrt=function(){var C=bx(bC(aR(this)._));return[ax(C),ax(this._-C*C)]};var bR=BigInteger(9007199254740992);function E(C){if(C.compareAbs(bR)>=0){return new bW(C)}return ax(C.toJSValue())}function bW(C){this._=C}bW.prototype=new Q();function aE(N,C,I){n=BigInteger.parse(N,I);if(C<0){n=n.negate()}return new bW(n)}aW.EIBig.SN_numberToString=function(C){return this._.toString(C)};aW.EIBig.valueOf=function(){return this._.valueOf()};["isZero","isEven","isOdd","sign","isUnit","isPositive","isNegative"].forEach(function(C){aW.EIBig["SN_"+C]=function(){return this._[C]()}});aW.EIBig.SN_log=function(){var C=al(this._.abs().log());return this._.isPositive()?C:bc(C,an)};aW.EIBig.SN_debug=function(){return"EIBig("+this._.toString()+")"};aW.EIBig.SN__toBigInteger=function(){return this._};aW.EIBig.SN_add=function(C){return C.SN__add_EIBig(this)};aW.EIBig.SN_negate=function(){return new bW(this._.negate())};aW.EIBig.SN_abs=function(){return new bW(this._.abs())};aW.EIBig.SN_subtract=function(C){return C.SN__subtract_EIBig(this)};aW.EIBig.SN_multiply=function(C){return C.SN__multiply_EIBig(this)};aW.EIBig.SN_square=function(){return new bW(this._.square())};aW.EIBig.SN__exp10=function(C){if(C===0){return this}if(C>0){return new bW(this._.exp10(C))}return f(this,af.SN__exp10(-C))};aW.EIBig.SN_sqrt=function(){var C=al(aS(this._.abs().log()/2));return(this._.isNegative()?bc(bQ,C):C)};aW.EIBig.SN_exactIntegerSqrt=function(){function N(b1,bY){while(true){var bZ=b1.divRem(bY);var R=bZ[0];var b0=bY.subtract(R);if(b0.isZero()){return[R,bZ[1]]}if(b0.isUnit()){if(b0.isPositive()){return[R,R.add(bZ[1])]}return[bY,bY.add(bZ[1])]}bY=R.add(b0.quotient(2))}}var I=aR(this)._.log()/2/a0;var C=BigInteger(a3(10,I-bx(I)).toString()+"e"+bx(I));return N(this._,C).map(E)};function a1(I,C){var N;while(I!==0){N=I;I=C%I;C=N}return ax(C)}function X(I,C){if(I instanceof a9&&C instanceof a9){return a1(I.valueOf(),C.valueOf())}I=I.SN__toBigInteger();if(I.isZero()){return C}C=C.SN__toBigInteger();var N;while(true){N=I;I=C.remainder(I);if(I.isZero()){return new bW(N)}C=N;if(C.compareAbs(bR)<0){return a1(I.valueOf(),C.valueOf())}}}function m(C){return BigInteger.parse(C.toString(16),16)}function aO(bZ){var R=aW[bZ];var N={};function b2(b4,b5,b6){function b3(b7){if(R[b5+b7]){return}N[b5+b7]=b6;b2(ab[b7],b5,b6)}if(b4){b4.forEach(b3)}}for(var I in R){if(!/^SN_/.test(I)){continue}var b1=I.lastIndexOf("_");if(b1===-1){continue}var C=R[I];if(!C){continue}var bY=I.substring(b1+1);b2(ab[bY],I.substring(0,b1+1),C)}for(var b0 in N){R[b0]=N[b0]}}for(var U in a8){aO(U)}if(bM===Number){for(var q in aW.R){if(/^SN_/.test(q)&&!aW.Flonum[q]){aW.Flonum[q]=aW.R[q]}}for(var q in aW.C){if(/^SN_/.test(q)&&!aW.Flonum[q]){aW.Flonum[q]=aW.C[q]}}for(var q in aW.Flonum){if(!aW.C[q]){aW.C[q]=g}}}for(var U in a8){for(var q in aW[U]){a8[U].prototype[q]=aW[U][q]}}function x(I){var R="";for(var C in a8){if(!/[a-z]/.test(C)){continue}var N=a8[C].prototype;for(q in N){if(N[q]===P){R+="Pure virtual: "+C+"."+q+"\n"}}}if(R){I(R)}}x(this.alert||this.print||function(C){throw C});return j})();if(typeof exports!=="undefined"){exports.SchemeNumber=SchemeNumber;for(var name in SchemeNumber.fn){exports[name]=SchemeNumber.fn[name]}};