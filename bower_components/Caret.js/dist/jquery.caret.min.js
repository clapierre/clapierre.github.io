/*! jquery.caret 2015-02-01 */
!function(d,c){"function"==typeof define&&define.amd?define(["jquery"],function(a){return d.returnExportsGlobal=c(a)}):"object"==typeof exports?module.exports=c(require("jquery")):c(jQuery)}(this,function(x){var w,v,u,t,s,r,q,p,o,n,m;n="caret",w=function(){function a(b){this.$inputor=b,this.domInputor=this.$inputor[0]}return a.prototype.setPos=function(){return this.domInputor},a.prototype.getIEPosition=function(){return this.getPosition()},a.prototype.getPosition=function(){var d,c;return c=this.getOffset(),d=this.$inputor.offset(),c.left-=d.left,c.top-=d.top,c},a.prototype.getOldIEPos=function(){var d,c;return c=q.selection.createRange(),d=q.body.createTextRange(),d.moveToElementText(this.domInputor),d.setEndPoint("EndToEnd",c),d.text.length},a.prototype.getPos=function(){var e,d,f;return(f=this.range())?(e=f.cloneRange(),e.selectNodeContents(this.domInputor),e.setEnd(f.endContainer,f.endOffset),d=e.toString().length,e.detach(),d):q.selection?this.getOldIEPos():void 0},a.prototype.getOldIEOffset=function(){var d,c;return d=q.selection.createRange().duplicate(),d.moveStart("character",-1),c=d.getBoundingClientRect(),{height:c.bottom-c.top,left:c.left,top:c.top}},a.prototype.getOffset=function(){var g,k,j,i,h;return o.getSelection&&(j=this.range())?(j.endOffset-1>0&&j.endContainer===!this.domInputor&&(g=j.cloneRange(),g.setStart(j.endContainer,j.endOffset-1),g.setEnd(j.endContainer,j.endOffset),i=g.getBoundingClientRect(),k={height:i.height,left:i.left+i.width,top:i.top},g.detach()),k&&0!==(null!=k?k.height:void 0)||(g=j.cloneRange(),h=x(q.createTextNode("|")),g.insertNode(h[0]),g.selectNode(h[0]),i=g.getBoundingClientRect(),k={height:i.height,left:i.left,top:i.top},h.remove(),g.detach())):q.selection&&(k=this.getOldIEOffset()),k&&(k.top+=x(o).scrollTop(),k.left+=x(o).scrollLeft()),k},a.prototype.range=function(){var b;if(o.getSelection){return b=o.getSelection(),b.rangeCount>0?b.getRangeAt(0):null}},a}(),v=function(){function a(b){this.$inputor=b,this.domInputor=this.$inputor[0]}return a.prototype.getIEPos=function(){var i,h,z,y,l,k,j;return h=this.domInputor,k=q.selection.createRange(),l=0,k&&k.parentElement()===h&&(y=h.value.replace(/\r\n/g,"\n"),z=y.length,j=h.createTextRange(),j.moveToBookmark(k.getBookmark()),i=h.createTextRange(),i.collapse(!1),l=j.compareEndPoints("StartToEnd",i)>-1?z:-j.moveStart("character",-z)),l},a.prototype.getPos=function(){return q.selection?this.getIEPos():this.domInputor.selectionStart},a.prototype.setPos=function(e){var d,f;return d=this.domInputor,q.selection?(f=d.createTextRange(),f.move("character",e),f.select()):d.setSelectionRange&&d.setSelectionRange(e,e),d},a.prototype.getIEOffset=function(g){var f,j,i,h;return j=this.domInputor.createTextRange(),g||(g=this.getPos()),j.move("character",g),i=j.boundingLeft,h=j.boundingTop,f=j.boundingHeight,{left:i,top:h,height:f}},a.prototype.getOffset=function(f){var i,h,g;return i=this.$inputor,q.selection?(h=this.getIEOffset(f),h.top+=x(o).scrollTop()+i.scrollTop(),h.left+=x(o).scrollLeft()+i.scrollLeft(),h):(h=i.offset(),g=this.getPosition(f),h={left:h.left+g.left-i.scrollLeft(),top:h.top+g.top-i.scrollTop(),height:g.height})},a.prototype.getPosition=function(j){var d,B,A,z,y,l,k;return d=this.$inputor,z=function(b){return b=b.replace(/<|>|`|"|&/g,"?").replace(/\r\n|\r|\n/g,"<br/>"),/firefox/i.test(navigator.userAgent)&&(b=b.replace(/\s/g,"&nbsp;")),b},void 0===j&&(j=this.getPos()),k=d.val().slice(0,j),A=d.val().slice(j),y="<span style='position: relative; display: inline;'>"+z(k)+"</span>",y+="<span id='caret' style='position: relative; display: inline;'>|</span>",y+="<span style='position: relative; display: inline;'>"+z(A)+"</span>",l=new u(d),B=l.create(y).rect()},a.prototype.getIEPosition=function(h){var g,l,k,j,i;return k=this.getIEOffset(h),l=this.$inputor.offset(),j=k.left-l.left,i=k.top-l.top,g=k.height,{left:j,top:i,height:g}},a}(),u=function(){function a(b){this.$inputor=b}return a.prototype.css_attr=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","boxSizing","fontFamily","fontSize","fontWeight","height","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","outlineWidth","overflow","overflowX","overflowY","paddingBottom","paddingLeft","paddingRight","paddingTop","textAlign","textOverflow","textTransform","whiteSpace","wordBreak","wordWrap"],a.prototype.mirrorCss=function(){var d,e=this;return d={position:"absolute",left:-9999,top:0,zIndex:-20000},"TEXTAREA"===this.$inputor.prop("tagName")&&this.css_attr.push("width"),x.each(this.css_attr,function(b,c){return d[c]=e.$inputor.css(c)}),d},a.prototype.create=function(c){return this.$mirror=x("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(c),this.$inputor.after(this.$mirror),this},a.prototype.rect=function(){var e,d,f;return e=this.$mirror.find("#caret"),d=e.position(),f={left:d.left,top:d.top,height:e.height()},this.$mirror.remove(),f},a}(),t={contentEditable:function(b){return !(!b[0].contentEditable||"true"!==b[0].contentEditable)}},r={pos:function(b){return b||0===b?this.setPos(b):this.getPos()},position:function(b){return q.selection?this.getIEPosition(b):this.getPosition(b)},offset:function(d){var c;return c=this.getOffset(d)}},q=null,o=null,p=null,m=function(d){var c;return(c=null!=d?d.iframe:void 0)?(p=c,o=c.contentWindow,q=c.contentDocument||o.document):(p=void 0,o=window,q=document)},s=function(e){var d;q=e[0].ownerDocument,o=q.defaultView||q.parentWindow;try{return p=o.frameElement}catch(f){d=f}},x.fn.caret=function(e,c,b){var a;return r[e]?(x.isPlainObject(c)?(m(c),c=void 0):m(b),a=t.contentEditable(this)?new w(this):new v(this),r[e].apply(a,[c])):x.error("Method "+e+" does not exist on jQuery.caret")},x.fn.caret.EditableCaret=w,x.fn.caret.InputCaret=v,x.fn.caret.Utils=t,x.fn.caret.apis=r});