(function(a){a(function(c){var b=c("./when");d.n=e;return d;function d(h,g){return function(){var f,i;f=this;i=arguments;return b(h(),function(j){return b(g.apply(f,i)).ensure(j)})}}function e(h){var f,i;f=0;i=[];return function g(){return b.promise(function(k){if(f<h){k(j)}else{i.push(k)}f+=1;function j(){f=Math.max(f-1,0);if(i.length){i.shift()(j)}}})}}})}(typeof define==="function"&&define.amd?define:function(a){module.exports=a(require)}));