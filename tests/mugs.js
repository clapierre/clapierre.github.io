define(["tests/utils","chai","jquery",],function(b,c,d){var a=c.assert;describe("Mugs et al",function(){before(function(e){b.init({javaRosa:{langs:["en"]},core:{onReady:e}})});it("should coalesce change events inside _withMessages",function(){b.loadXML("");var e=b.addQuestion("Text"),i=1,f=0,h;e.on("messages-changed",function(){f+=1});function g(){e.addMessage(null,{key:"test-message",level:e.ERROR,message:"testing "+i++,})}a.equal(f,0);h=e._withMessages(function(){g();g();a.equal(f,0)});a(h,"not changed!");a.equal(f,1);g();g();a.equal(f,3)})})});