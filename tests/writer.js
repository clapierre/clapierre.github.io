require(["chai","jquery","tests/utils","text!static/writer/repeat-without-count.xml","text!static/writer/repeat-noAddRemove-false.xml","text!static/writer/repeat-with-count.xml","text!static/writer/repeat-with-count-noAddRemove-false.xml"],function(c,d,b,f,e,g,a){describe("The XML writer",function(){beforeEach(function(h){b.init({core:{onReady:function(){h()}}})});it("should not set jr:noAddRemove on repeat group without count",function(){b.addQuestion("Repeat","group");b.assertXmlEqual(b.call("createXML"),f,{normalize_xmlns:true})});it("should not set jr:noAddRemove on repeat group without count even when jr:noAddRemove is true",function(){var h=b.addQuestion("Repeat","group");h.p.no_add_remove=true;b.assertXmlEqual(b.call("createXML"),f,{normalize_xmlns:true})});it("should remove jr:noAddRemove attribute when its value was false()",function(){b.call("loadXML",e);b.assertXmlEqual(b.call("createXML"),f,{normalize_xmlns:true})});it("should preserve jr:noAddRemove='true()' when jr:count has a value",function(){b.call("loadXML",g);b.assertXmlEqual(b.call("createXML"),g,{normalize_xmlns:true})});it("should change jr:noAddRemove to 'true()' when jr:count has a value",function(){b.call("loadXML",a);b.assertXmlEqual(b.call("createXML"),g,{normalize_xmlns:true})});it("should still save more than once",function(){b.call("loadXML","");b.addQuestion("FieldList","fieldlist");b.addQuestion("Text","text1");b.addQuestion("Text","text2");b.addQuestion("Text","text3");b.addQuestion("Text","text4");b.call("createXML");b.deleteQuestion("/data/fieldlist/text1");b.call("createXML")})})});